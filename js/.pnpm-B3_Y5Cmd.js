var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t={exports:{}},n={};
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var r=React,s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!a.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:u,props:o,_owner:l.current}}n.Fragment=o,n.jsx=c,n.jsxs=c,t.exports=n;var u=t.exports;function d(e){return{}}const h={},f={},g={},p={},m={},_={},y={},b={},w={},x={},v={},S={},C={},k={},E={},T={},N={},R={},A={},O={},F={},D={},P={},L={},I={},M={},B={},z={},$={},U={},K={},W={},j={},H={},J={},V={},Y={},Z={},X={},q={},G={},Q={},ee={},te={},ne={};var re=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};const se="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,oe=se&&"documentMode"in document?document.documentMode:null,ie=se&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),le=se&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),ae=!(!se||!("InputEvent"in window)||oe)&&"getTargetRanges"in new window.InputEvent("input"),ce=se&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),ue=se&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,de=se&&/Android/.test(navigator.userAgent),he=se&&/^(?=.*Chrome).*/i.test(navigator.userAgent),fe=se&&de&&he,ge=se&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!he,pe=1,me=3,_e=0,ye=1,be=2,we=0,xe=1,ve=2,Se=4,Ce=8,ke=3|Se|Ce|240,Ee=1,Te=2,Ne=3,Re=4,Ae=5,Oe=6,Fe=ce||ue||ge?" ":"​",De="\n\n",Pe=le?" ":Fe,Le="֑-߿יִ-﷽ﹰ-ﻼ",Ie="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",Me=new RegExp("^[^"+Ie+"]*["+Le+"]"),Be=new RegExp("^[^"+Le+"]*["+Ie+"]"),ze={bold:1,code:16,highlight:128,italic:2,strikethrough:Se,subscript:32,superscript:64,underline:Ce},$e={directionless:1,unmergeable:2},Ue={center:Te,end:Oe,justify:Re,left:Ee,right:Ne,start:Ae},Ke={[Te]:"center",[Oe]:"end",[Re]:"justify",[Ee]:"left",[Ne]:"right",[Ae]:"start"},We={normal:0,segmented:2,token:1},je={[we]:"normal",[ve]:"segmented",[xe]:"token"};function He(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}const Je=100;let Ve=!1,Ye=0;function Ze(e){Ye=e.timeStamp}function Xe(e,t,n){return t.__lexicalLineBreak===e||void 0!==e[`__lexicalKey_${n._key}`]}function qe(e,t,n){const r=cn(n._window);let s=null,o=null;null!==r&&r.anchorNode===e&&(s=r.anchorOffset,o=r.focusOffset);const i=e.nodeValue;null!==i&&Mt(t,i,s,o,!1)}function Ge(e,t,n){if(Gr(e)){const t=e.anchor.getNode();if(t.is(n)&&e.format!==t.getFormat())return!1}return t.nodeType===me&&n.isAttached()}function Qe(e,t,n){Ve=!0;const r=performance.now()-Ye>Je;try{Ks(e,(()=>{const s=hs()||e.getEditorState().read((()=>{const e=hs();return null!==e?e.clone():null})),o=new Map,i=e.getRootElement(),l=e._editorState,a=e._blockCursorElement;let c=!1,u="";for(let n=0;n<t.length;n++){const d=t[n],h=d.type,f=d.target;let g=Ct(f,l);if(!(null===g&&f!==i||js(g)))if("characterData"===h)r&&Ur(g)&&Ge(s,f,g)&&qe(f,g,e);else if("childList"===h){c=!0;const t=d.addedNodes;for(let s=0;s<t.length;s++){const n=t[s],r=St(n),o=n.parentNode;if(null!=o&&n!==a&&null===r&&("BR"!==n.nodeName||!Xe(n,o,e))){if(le){const e=n.innerText||n.nodeValue;e&&(u+=e)}o.removeChild(n)}}const n=d.removedNodes,r=n.length;if(r>0){let t=0;for(let s=0;s<r;s++){const r=n[s];("BR"===r.nodeName&&Xe(r,f,e)||a===r)&&(f.appendChild(r),t++)}r!==t&&(f===i&&(g=Nt(l)),o.set(f,g))}}}if(o.size>0)for(const[t,n]of o)if(Js(n)){const r=n.getChildrenKeys();let s=t.firstChild;for(let n=0;n<r.length;n++){const o=r[n],i=e.getElementByKey(o);null!==i&&(null==s?(t.appendChild(i),s=i):s!==i&&t.replaceChild(i,s),s=s.nextSibling)}}else Ur(n)&&n.markDirty();const d=n.takeRecords();if(d.length>0){for(let t=0;t<d.length;t++){const n=d[t],r=n.addedNodes,s=n.target;for(let t=0;t<r.length;t++){const n=r[t],o=n.parentNode;null==o||"BR"!==n.nodeName||Xe(n,s,e)||o.removeChild(n)}}n.takeRecords()}null!==s&&(c&&(s.dirty=!0,Rt(s)),le&&Xt(e)&&s.insertRawText(u))}))}finally{Ve=!1}}function et(e){const t=e._observer;null!==t&&Qe(e,t.takeRecords(),t)}function tt(e){var t;t=e,0===Ye&&nn(t).addEventListener("textInput",Ze,!0),e._observer=new MutationObserver(((t,n)=>{Qe(e,t,n)}))}function nt(e,t){const n=e.__mode,r=e.__format,s=e.__style,o=t.__mode,i=t.__format,l=t.__style;return!(null!==n&&n!==o||null!==r&&r!==i||null!==s&&s!==l)}function rt(e,t){const n=e.mergeWithSibling(t),r=Os()._normalizedNodes;return r.add(e.__key),r.add(t.__key),n}function st(e){let t,n,r=e;if(""!==r.__text||!r.isSimpleText()||r.isUnmergeable()){for(;null!==(t=r.getPreviousSibling())&&Ur(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(""!==t.__text){if(nt(t,r)){r=rt(t,r);break}break}t.remove()}for(;null!==(n=r.getNextSibling())&&Ur(n)&&n.isSimpleText()&&!n.isUnmergeable();){if(""!==n.__text){if(nt(r,n)){r=rt(r,n);break}break}n.remove()}}else r.remove()}function ot(e){return it(e.anchor),it(e.focus),e}function it(e){for(;"element"===e.type;){const t=e.getNode(),n=e.offset;let r,s;if(n===t.getChildrenSize()?(r=t.getChildAtIndex(n-1),s=!0):(r=t.getChildAtIndex(n),s=!1),Ur(r)){e.set(r.__key,s?r.getTextContentSize():0,"text");break}if(!Js(r))break;e.set(r.__key,s?r.getChildrenSize():0,"element")}}let lt=1;const at="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)};function ct(e){const t=document.activeElement;if(null===t)return!1;const n=t.nodeName;return js(Ct(e))&&("INPUT"===n||"TEXTAREA"===n||"true"===t.contentEditable&&null==t.__lexicalEditor)}function ut(e,t,n){const r=e.getRootElement();try{return null!==r&&r.contains(t)&&r.contains(n)&&null!==t&&!ct(t)&&dt(t)===e}catch(s){return!1}}function dt(e){let t=e;for(;null!=t;){const e=t.__lexicalEditor;if(null!=e)return e;t=en(t)}return null}function ht(e){return e.isToken()||e.isSegmented()}function ft(e){return e.nodeType===me}function gt(e){let t=e;for(;null!=t;){if(ft(t))return t;t=t.firstChild}return null}function pt(e,t,n){const r=ze[t];if(null!==n&&(e&r)==(n&r))return e;let s=e^r;return"subscript"===t?s&=~ze.superscript:"superscript"===t&&(s&=~ze.subscript),s}function mt(e){return Ur(e)||vr(e)||js(e)}function _t(e,t){if(null!=t)return void(e.__key=t);Ns(),Rs();const n=Os(),r=As(),s=""+lt++;r._nodeMap.set(s,e),Js(e)?n._dirtyElements.set(s,!0):n._dirtyLeaves.add(s),n._cloneNotNeeded.add(s),n._dirtyType=ye,e.__key=s}function yt(e){const t=e.getParent();if(null!==t){const n=e.getWritable(),r=t.getWritable(),s=e.getPreviousSibling(),o=e.getNextSibling();if(null===s)if(null!==o){const e=o.getWritable();r.__first=o.__key,e.__prev=null}else r.__first=null;else{const e=s.getWritable();if(null!==o){const t=o.getWritable();t.__prev=e.__key,e.__next=t.__key}else e.__next=null;n.__prev=null}if(null===o)if(null!==s){const e=s.getWritable();r.__last=s.__key,e.__next=null}else r.__last=null;else{const e=o.getWritable();if(null!==s){const t=s.getWritable();t.__next=e.__key,e.__prev=t.__key}else e.__prev=null;n.__next=null}r.__size--,n.__parent=null}}function bt(e){Rs();const t=e.getLatest(),n=t.__parent,r=As(),s=Os(),o=r._nodeMap,i=s._dirtyElements;null!==n&&function(e,t,n){let r=e;for(;null!==r;){if(n.has(r))return;const e=t.get(r);if(void 0===e)break;n.set(r,!1),r=e.__parent}}(n,o,i);const l=t.__key;s._dirtyType=ye,Js(e)?i.set(l,!0):s._dirtyLeaves.add(l)}function wt(e){Ns();const t=Os(),n=t._compositionKey;if(e!==n){if(t._compositionKey=e,null!==n){const e=vt(n);null!==e&&e.getWritable()}if(null!==e){const t=vt(e);null!==t&&t.getWritable()}}}function xt(){return Ts()?null:Os()._compositionKey}function vt(e,t){const n=(t||As())._nodeMap.get(e);return void 0===n?null:n}function St(e,t){const n=e[`__lexicalKey_${Os()._key}`];return void 0!==n?vt(n,t):null}function Ct(e,t){let n=e;for(;null!=n;){const e=St(n,t);if(null!==e)return e;n=en(n)}return null}function kt(e){const t=e._decorators,n=Object.assign({},t);return e._pendingDecorators=n,n}function Et(e){return e.read((()=>Tt().getTextContent()))}function Tt(){return Nt(As())}function Nt(e){return e._nodeMap.get("root")}function Rt(e){Ns();const t=As();null!==e&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function At(e){const t=Os(),n=function(e,t){let n=e;for(;null!=n;){const e=n[`__lexicalKey_${t._key}`];if(void 0!==e)return e;n=en(n)}return null}(e,t);return null===n?e===t.getRootElement()?vt("root"):null:vt(n)}function Ot(e,t){return t?e.getTextContentSize():0}function Ft(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Dt(e){const t=[];let n=e;for(;null!==n;)t.push(n),n=n._parentEditor;return t}function Pt(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function Lt(e){return e.nodeType===me?e.nodeValue:null}function It(e,t,n){const r=cn(t._window);if(null===r)return;const s=r.anchorNode;let{anchorOffset:o,focusOffset:i}=r;if(null!==s){let t=Lt(s);const r=Ct(s);if(null!==t&&Ur(r)){if(t===Fe&&n){const e=n.length;t=n,o=e,i=e}null!==t&&Mt(r,t,o,i,e)}}}function Mt(e,t,n,r,s){let o=e;if(o.isAttached()&&(s||!o.isDirty())){const i=o.isComposing();let l=t;(i||s)&&t[t.length-1]===Fe&&(l=t.slice(0,-1));const a=o.getTextContent();if(s||l!==a){if(""===l){if(wt(null),ce||ue||ge)o.remove();else{const e=Os();setTimeout((()=>{e.update((()=>{o.isAttached()&&o.remove()}))}),20)}return}const t=o.getParent(),s=fs(),a=o.getTextContentSize(),c=xt(),u=o.getKey();if(o.isToken()||null!==c&&u===c&&!i||Gr(s)&&(null!==t&&!t.canInsertTextBefore()&&0===s.anchor.offset||s.anchor.key===e.__key&&0===s.anchor.offset&&!o.canInsertTextBefore()&&!i||s.focus.key===e.__key&&s.focus.offset===a&&!o.canInsertTextAfter()&&!i))return void o.markDirty();const d=hs();if(!Gr(d)||null===n||null===r)return void o.setTextContent(l);if(d.setTextNodeRange(o,n,o,r),o.isSegmented()){const e=$r(o.getTextContent());o.replace(e),o=e}o.setTextContent(l)}}}function Bt(e){return 37===e}function zt(e){return 39===e}function $t(e,t){return ie?e:t}function Ut(e){return 13===e}function Kt(e){return 8===e}function Wt(e){return 46===e}function jt(e,t,n){return 65===e&&$t(t,n)}function Ht(){const e=Tt();Rt(ot(e.select(0,e.getChildrenSize())))}function Jt(e,t){void 0===e.__lexicalClassNameCache&&(e.__lexicalClassNameCache={});const n=e.__lexicalClassNameCache,r=n[t];if(void 0!==r)return r;const s=e[t];if("string"==typeof s){const e=He(s);return n[t]=e,e}return s}function Vt(e,t,n,r,s){if(0===n.size)return;const o=r.__type,i=r.__key,l=t.get(o);void 0===l&&re(33,o);const a=l.klass;let c=e.get(a);void 0===c&&(c=new Map,e.set(a,c));const u=c.get(i),d="destroyed"===u&&"created"===s;(void 0===u||d)&&c.set(i,d?"updated":s)}function Yt(e,t,n){const r=e.getParent();let s=n,o=e;return null!==r&&(t&&0===n?(s=o.getIndexWithinParent(),o=r):t||n!==o.getChildrenSize()||(s=o.getIndexWithinParent()+1,o=r)),o.getChildAtIndex(t?s-1:s)}function Zt(e,t){const n=e.offset;if("element"===e.type)return Yt(e.getNode(),t,n);{const r=e.getNode();if(t&&0===n||!t&&n===r.getTextContentSize()){const e=t?r.getPreviousSibling():r.getNextSibling();return null===e?Yt(r.getParentOrThrow(),t,r.getIndexWithinParent()+(t?0:1)):e}}return null}function Xt(e){const t=nn(e).event,n=t&&t.inputType;return"insertFromPaste"===n||"insertFromPasteAsQuotation"===n}function qt(e,t,n){return zs(e,t,n)}function Gt(e){return!Zs(e)&&!e.isLastChild()&&!e.isInline()}function Qt(e,t){const n=e._keyToDOMMap.get(t);return void 0===n&&re(75,t),n}function en(e){const t=e.assignedSlot||e.parentElement;return null!==t&&11===t.nodeType?t.host:t}function tn(e,t){let n=e.getParent();for(;null!==n;){if(n.is(t))return!0;n=n.getParent()}return!1}function nn(e){const t=e._window;return null===t&&re(78),t}function rn(e){return Zs(e)||Js(e)&&e.isShadowRoot()}function sn(e){const t=Os(),n=e.constructor.getType(),r=t._nodes.get(n);void 0===r&&re(97);const s=r.replace;if(null!==s){const t=s(e);return t instanceof e.constructor||re(98),t}return e}function on(e,t){!Zs(e.getParent())||Js(t)||js(t)||re(99)}function ln(e){return(js(e)||Js(e)&&!e.canBeEmpty())&&!e.isInline()}function an(e,t,n){n.style.removeProperty("caret-color"),t._blockCursorElement=null;const r=e.parentElement;null!==r&&r.removeChild(e)}function cn(e){return se?(e||window).getSelection():null}function un(e,t){let n=e.getChildAtIndex(t);null==n&&(n=e),rn(e)&&re(102);const r=e=>{const t=e.getParentOrThrow(),s=rn(t),o=e!==n||s?function(e){const t=e.constructor.clone(e);return _t(t,null),t}(e):e;if(s)return Js(e)&&Js(o)||re(133),e.insertAfter(o),[e,o,o];{const[n,s,i]=r(t),l=e.getNextSiblings();return i.append(o,...l),[n,s,o]}},[s,o]=r(n);return[s,o]}function dn(e){return hn(e)&&"A"===e.tagName}function hn(e){return 1===e.nodeType}function fn(e){if(js(e)&&!e.isInline())return!0;if(!Js(e)||rn(e))return!1;const t=e.getFirstChild(),n=null===t||vr(t)||Ur(t)||t.isInline();return!e.isInline()&&!1!==e.canBeEmpty()&&n}function gn(e,t){let n=e;for(;null!==n&&null!==n.getParent()&&!t(n);)n=n.getParentOrThrow();return t(n)?n:null}function pn(e,t,n,r,s,o){let i=e.getFirstChild();for(;null!==i;){const e=i.__key;i.__parent===t&&(Js(i)&&pn(i,e,n,r,s,o),n.has(e)||o.delete(e),s.push(e)),i=i.getNextSibling()}}let mn,_n,yn,bn,wn,xn,vn,Sn,Cn,kn,En="",Tn="",Nn=null,Rn="",An=!1,On=!1,Fn=null;function Dn(e,t){const n=vn.get(e);if(null!==t){const n=Yn(e);n.parentNode===t&&t.removeChild(n)}if(Sn.has(e)||_n._keyToDOMMap.delete(e),Js(n)){const e=jn(n,vn);Pn(e,0,e.length-1,null)}void 0!==n&&Vt(kn,yn,bn,n,"destroyed")}function Pn(e,t,n,r){let s=t;for(;s<=n;++s){const t=e[s];void 0!==t&&Dn(t,r)}}function Ln(e,t){e.setProperty("text-align",t)}const In="40px";function Mn(e,t){const n=mn.theme.indent;if("string"==typeof n){const r=e.classList.contains(n);t>0&&!r?e.classList.add(n):t<1&&r&&e.classList.remove(n)}const r=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||In;e.style.setProperty("padding-inline-start",0===t?"":`calc(${t} * ${r})`)}function Bn(e,t){const n=e.style;0===t?Ln(n,""):t===Ee?Ln(n,"left"):t===Te?Ln(n,"center"):t===Ne?Ln(n,"right"):t===Re?Ln(n,"justify"):t===Ae?Ln(n,"start"):t===Oe&&Ln(n,"end")}function zn(e,t,n){const r=Sn.get(e);void 0===r&&re(60);const s=r.createDOM(mn,_n);if(function(e,t,n){const r=n._keyToDOMMap;t["__lexicalKey_"+n._key]=e,r.set(e,t)}(e,s,_n),Ur(r)?s.setAttribute("data-lexical-text","true"):js(r)&&s.setAttribute("data-lexical-decorator","true"),Js(r)){const e=r.__indent,t=r.__size;if(0!==e&&Mn(s,e),0!==t){const e=t-1;!function(e,t,n,r){const s=Tn;Tn="",$n(e,n,0,t,r,null),Wn(n,r),Tn=s}(jn(r,Sn),e,r,s)}const n=r.__format;0!==n&&Bn(s,n),r.isInline()||Kn(null,r,s),Gt(r)&&(En+=De,Rn+=De)}else{const t=r.getTextContent();if(js(r)){const t=r.decorate(_n,mn);null!==t&&Jn(e,t),s.contentEditable="false"}else Ur(r)&&(r.isDirectionless()||(Tn+=t));En+=t,Rn+=t}if(null!==t)if(null!=n)t.insertBefore(s,n);else{const e=t.__lexicalLineBreak;null!=e?t.insertBefore(s,e):t.appendChild(s)}return Vt(kn,yn,bn,r,"created"),s}function $n(e,t,n,r,s,o){const i=En;En="";let l=n;for(;l<=r;++l){zn(e[l],s,o);const t=Sn.get(e[l]);null!==t&&null===Nn&&Ur(t)&&(Nn=t.getFormat())}Gt(t)&&(En+=De),s.__lexicalTextContent=En,En=i+En}function Un(e,t){const n=t.get(e);return vr(n)||js(n)&&n.isInline()}function Kn(e,t,n){const r=null!==e&&(0===e.__size||Un(e.__last,vn)),s=0===t.__size||Un(t.__last,Sn);if(r){if(!s){const e=n.__lexicalLineBreak;null!=e&&n.removeChild(e),n.__lexicalLineBreak=null}}else if(s){const e=document.createElement("br");n.__lexicalLineBreak=e,n.appendChild(e)}}function Wn(e,t){const n=t.__lexicalDirTextContent,r=t.__lexicalDir;if(n!==Tn||r!==Fn){const n=""===Tn,o=n?Fn:(s=Tn,Me.test(s)?"rtl":Be.test(s)?"ltr":null);if(o!==r){const s=t.classList,i=mn.theme;let l=null!==r?i[r]:void 0,a=null!==o?i[o]:void 0;if(void 0!==l){if("string"==typeof l){const e=He(l);l=i[r]=e}s.remove(...l)}if(null===o||n&&"ltr"===o)t.removeAttribute("dir");else{if(void 0!==a){if("string"==typeof a){const e=He(a);a=i[o]=e}void 0!==a&&s.add(...a)}t.dir=o}On||(e.getWritable().__dir=o)}Fn=o,t.__lexicalDirTextContent=Tn,t.__lexicalDir=o}var s}function jn(e,t){const n=[];let r=e.__first;for(;null!==r;){const e=t.get(r);void 0===e&&re(101),n.push(r),r=e.__next}return n}function Hn(e,t){const n=vn.get(e);let r=Sn.get(e);void 0!==n&&void 0!==r||re(61);const s=An||xn.has(e)||wn.has(e),o=Qt(_n,e);if(n===r&&!s){if(Js(n)){const e=o.__lexicalTextContent;void 0!==e&&(En+=e,Rn+=e);const t=o.__lexicalDirTextContent;void 0!==t&&(Tn+=t)}else{const e=n.getTextContent();Ur(n)&&!n.isDirectionless()&&(Tn+=e),Rn+=e,En+=e}return o}if(n!==r&&s&&Vt(kn,yn,bn,r,"updated"),r.updateDOM(n,o,mn)){const n=zn(e,null,null);return null===t&&re(62),t.replaceChild(n,o),Dn(e,null),n}if(Js(n)&&Js(r)){const e=r.__indent;e!==n.__indent&&Mn(o,e);const t=r.__format;t!==n.__format&&Bn(o,t),s&&(function(e,t,n){const r=Tn;var s;Tn="",Nn=null,function(e,t,n){const r=En,s=e.__size,o=t.__size;if(En="",1===s&&1===o){const r=e.__first,s=t.__first;if(r===s)Hn(r,n);else{const e=Yn(r),t=zn(s,null,null);n.replaceChild(t,e),Dn(r,null)}const o=Sn.get(s);null===Nn&&Ur(o)&&(Nn=o.getFormat())}else{const r=jn(e,vn),i=jn(t,Sn);if(0===s)0!==o&&$n(i,t,0,o-1,n,null);else if(0===o){if(0!==s){const e=null==n.__lexicalLineBreak;Pn(r,0,s-1,e?null:n),e&&(n.textContent="")}}else!function(e,t,n,r,s,o){const i=r-1,l=s-1;let a,c,u=o.firstChild,d=0,h=0;for(;d<=i&&h<=l;){const e=t[d],r=n[h];if(e===r)u=Vn(Hn(r,o)),d++,h++;else{void 0===a&&(a=new Set(t)),void 0===c&&(c=new Set(n));const s=c.has(e),i=a.has(r);if(s)if(i){const e=Qt(_n,r);e===u?u=Vn(Hn(r,o)):(null!=u?o.insertBefore(e,u):o.appendChild(e),Hn(r,o)),d++,h++}else zn(r,o,u),h++;else u=Vn(Yn(e)),Dn(e,o),d++}const s=Sn.get(r);null!==s&&null===Nn&&Ur(s)&&(Nn=s.getFormat())}const f=d>i,g=h>l;if(f&&!g){const t=n[l+1];$n(n,e,h,l,o,void 0===t?null:_n.getElementByKey(t))}else g&&!f&&Pn(t,d,i,o)}(t,r,i,s,o,n)}Gt(t)&&(En+=De),n.__lexicalTextContent=En,En=r+En}(e,t,n),Wn(t,n),no(s=t)&&null!=Nn&&Nn!==s.__textFormat&&s.setTextFormat(Nn),Tn=r,Nn=null}(n,r,o),Zs(r)||r.isInline()||Kn(n,r,o)),Gt(r)&&(En+=De,Rn+=De)}else{const t=r.getTextContent();if(js(r)){const t=r.decorate(_n,mn);null!==t&&Jn(e,t)}else Ur(r)&&!r.isDirectionless()&&(Tn+=t);En+=t,Rn+=t}if(!On&&Zs(r)&&r.__cachedText!==Rn){const e=r.getWritable();e.__cachedText=Rn,r=e}return o}function Jn(e,t){let n=_n._pendingDecorators;const r=_n._decorators;if(null===n){if(r[e]===t)return;n=kt(_n)}n[e]=t}function Vn(e){let t=e.nextSibling;return null!==t&&t===_n._blockCursorElement&&(t=t.nextSibling),t}function Yn(e){const t=Cn.get(e);return void 0===t&&re(75,e),t}const Zn=Object.freeze({}),Xn=[["keydown",function(e,t){if(qn=e.timeStamp,Gn=e.keyCode,t.isComposing())return;const{keyCode:n,shiftKey:r,ctrlKey:s,metaKey:o,altKey:i}=e;var l,a,c;qt(t,E,e)||(l=s,a=i,c=o,!zt(n)||l||c||a?!function(e,t,n,r,s){return zt(e)&&!r&&!n&&(t||s)}(n,s,r,i,o)?!function(e,t,n,r){return Bt(e)&&!t&&!r&&!n}(n,s,i,o)?!function(e,t,n,r,s){return Bt(e)&&!r&&!n&&(t||s)}(n,s,r,i,o)?!function(e,t,n){return function(e){return 38===e}(e)&&!t&&!n}(n,s,o)?!function(e,t,n){return function(e){return 40===e}(e)&&!t&&!n}(n,s,o)?!function(e,t){return Ut(e)&&t}(n,r)?!function(e){return 32===e}(n)?!function(e,t){return ie&&t&&79===e}(n,s)?!function(e,t){return Ut(e)&&!t}(n,r)?!function(e,t,n,r){return ie?!t&&!n&&(Kt(e)||72===e&&r):!(r||t||n)&&Kt(e)}(n,i,o,s)?!function(e){return 27===e}(n)?!function(e,t,n,r,s){return ie?!(n||r||s)&&(Wt(e)||68===e&&t):!(t||r||s)&&Wt(e)}(n,s,r,i,o)?!function(e,t,n){return Kt(e)&&(ie?t:n)}(n,i,s)?!function(e,t,n){return Wt(e)&&(ie?t:n)}(n,i,s)?!function(e,t){return ie&&t&&Kt(e)}(n,o)?!function(e,t){return ie&&t&&Wt(e)}(n,o)?!function(e,t,n,r){return 66===e&&!t&&$t(n,r)}(n,i,o,s)?!function(e,t,n,r){return 85===e&&!t&&$t(n,r)}(n,i,o,s)?!function(e,t,n,r){return 73===e&&!t&&$t(n,r)}(n,i,o,s)?!function(e,t,n,r){return 9===e&&!t&&!n&&!r}(n,i,s,o)?!function(e,t,n,r){return 90===e&&!t&&$t(n,r)}(n,r,o,s)?!function(e,t,n,r){return ie?90===e&&n&&t:89===e&&r||90===e&&r&&t}(n,r,o,s)?es(t._editorState._selection)?function(e,t,n,r){return!t&&67===e&&(ie?n:r)}(n,r,o,s)?(e.preventDefault(),qt(t,V,e)):function(e,t,n,r){return!t&&88===e&&(ie?n:r)}(n,r,o,s)?(e.preventDefault(),qt(t,Y,e)):jt(n,o,s)&&(e.preventDefault(),qt(t,Z,e)):!le&&jt(n,o,s)&&(e.preventDefault(),qt(t,Z,e)):(e.preventDefault(),qt(t,k,void 0)):(e.preventDefault(),qt(t,C,void 0)):qt(t,B,e):(e.preventDefault(),qt(t,S,"italic")):(e.preventDefault(),qt(t,S,"underline")):(e.preventDefault(),qt(t,S,"bold")):(e.preventDefault(),qt(t,v,!1)):(e.preventDefault(),qt(t,v,!0)):(e.preventDefault(),qt(t,x,!1)):(e.preventDefault(),qt(t,x,!0)):Wt(n)?qt(t,M,e):(e.preventDefault(),qt(t,p,!1)):qt(t,I,e):Kt(n)?qt(t,L,e):(e.preventDefault(),qt(t,p,!0)):(sr=!1,qt(t,D,e)):(e.preventDefault(),sr=!0,qt(t,m,!0)):qt(t,P,e):(sr=!0,qt(t,D,e)):qt(t,F,e):qt(t,O,e):qt(t,A,e):qt(t,R,e):qt(t,N,e):qt(t,T,e),function(e,t,n,r){return e||t||n||r}(s,r,i,o)&&qt(t,ne,e))}],["pointerdown",function(e,t){const n=e.target,r=e.pointerType;n instanceof Node&&"touch"!==r&&Ks(t,(()=>{js(Ct(n))||(rr=!0)}))}],["compositionstart",function(e,t){Ks(t,(()=>{const n=hs();if(Gr(n)&&!t.isComposing()){const r=n.anchor,s=n.anchor.getNode();wt(r.key),(e.timeStamp<qn+30||"element"===r.type||!n.isCollapsed()||s.getFormat()!==n.format||Ur(s)&&s.getStyle()!==n.style)&&qt(t,y,Pe)}}))}],["compositionend",function(e,t){le?or=!0:Ks(t,(()=>{dr(t,e.data)}))}],["input",function(e,t){e.stopPropagation(),Ks(t,(()=>{const n=hs(),r=e.data,s=ur(e);if(null!=r&&Gr(n)&&lr(n,s,r,e.timeStamp,!1)){or&&(dr(t,r),or=!1);const s=n.anchor,o=s.getNode(),i=cn(t._window);if(null===i)return;const l=s.offset;ae&&!n.isCollapsed()&&Ur(o)&&null!==i.anchorNode&&o.getTextContent().slice(0,l)+r+o.getTextContent().slice(l+n.focus.offset)===Lt(i.anchorNode)||qt(t,y,r);const a=r.length;le&&a>1&&"insertCompositionText"===e.inputType&&!t.isComposing()&&(n.anchor.offset-=a),ce||ue||ge||!t.isComposing()||(qn=0,wt(null))}else It(!1,t,null!==r?r:void 0),or&&(dr(t,r||void 0),or=!1);Ns(),et(Os())})),er=null}],["click",function(e,t){Ks(t,(()=>{const n=hs(),r=cn(t._window),s=fs();if(r)if(Gr(n)){const t=n.anchor,o=t.getNode();"element"===t.type&&0===t.offset&&n.isCollapsed()&&!Zs(o)&&1===Tt().getChildrenSize()&&o.getTopLevelElementOrThrow().isEmpty()&&null!==s&&n.is(s)?(r.removeAllRanges(),n.dirty=!0):3!==e.detail||n.isCollapsed()||o!==n.focus.getNode()&&(Js(o)?o.select(0):o.getParentOrThrow().select(0))}else if("touch"===e.pointerType){const n=r.anchorNode;if(null!==n){const o=n.nodeType;o!==pe&&o!==me||Rt(ds(s,r,t,e))}}qt(t,g,e)}))}],["cut",Zn],["copy",Zn],["dragstart",Zn],["dragover",Zn],["dragend",Zn],["paste",Zn],["focus",Zn],["blur",Zn],["drop",Zn]];ae&&Xn.push(["beforeinput",(e,t)=>function(e,t){const n=e.inputType,r=ur(e);"deleteCompositionText"===n||le&&Xt(t)||"insertCompositionText"!==n&&Ks(t,(()=>{const s=hs();if("deleteContentBackward"===n){if(null===s){const e=fs();if(!Gr(e))return;Rt(e.clone())}if(Gr(s)){const n=s.anchor.key===s.focus.key;if(o=e.timeStamp,229===Gn&&o<qn+30&&t.isComposing()&&n){if(wt(null),qn=0,setTimeout((()=>{Ks(t,(()=>{wt(null)}))}),30),Gr(s)){const e=s.anchor.getNode();e.markDirty(),s.format=e.getFormat(),Ur(e)||re(142),s.style=e.getStyle()}}else{wt(null),e.preventDefault();const r=s.anchor.getNode().getTextContent(),o=0===s.anchor.offset&&s.focus.offset===r.length;fe&&n&&!o||qt(t,p,!0)}return}}var o;if(!Gr(s))return;const i=e.data;null!==er&&It(!1,t,er),s.dirty&&null===er||!s.isCollapsed()||Zs(s.anchor.getNode())||null===r||s.applyDOMRange(r),er=null;const l=s.anchor,a=s.focus,c=l.getNode(),u=a.getNode();if("insertText"!==n&&"insertTranspose"!==n)switch(e.preventDefault(),n){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":qt(t,y,e);break;case"insertFromComposition":wt(null),qt(t,y,e);break;case"insertLineBreak":wt(null),qt(t,m,!1);break;case"insertParagraph":wt(null),sr&&!ue?(sr=!1,qt(t,m,!1)):qt(t,_,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":qt(t,b,e);break;case"deleteByComposition":((d=c)!==(h=u)||Js(d)||Js(h)||!d.isToken()||!h.isToken())&&qt(t,w,e);break;case"deleteByDrag":case"deleteByCut":qt(t,w,e);break;case"deleteContent":qt(t,p,!1);break;case"deleteWordBackward":qt(t,x,!0);break;case"deleteWordForward":qt(t,x,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":qt(t,v,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":qt(t,v,!1);break;case"formatStrikeThrough":qt(t,S,"strikethrough");break;case"formatBold":qt(t,S,"bold");break;case"formatItalic":qt(t,S,"italic");break;case"formatUnderline":qt(t,S,"underline");break;case"historyUndo":qt(t,C,void 0);break;case"historyRedo":qt(t,k,void 0)}else{if("\n"===i)e.preventDefault(),qt(t,m,!1);else if(i===De)e.preventDefault(),qt(t,_,void 0);else if(null==i&&e.dataTransfer){const t=e.dataTransfer.getData("text/plain");e.preventDefault(),s.insertRawText(t)}else null!=i&&lr(s,r,i,e.timeStamp,!0)?(e.preventDefault(),qt(t,y,i)):er=i;Qn=e.timeStamp}var d,h}))}(e,t)]);let qn=0,Gn=0,Qn=0,er=null;const tr=new WeakMap;let nr=!1,rr=!1,sr=!1,or=!1,ir=[0,"",0,"root",0];function lr(e,t,n,r,s){const o=e.anchor,i=e.focus,l=o.getNode(),a=Os(),c=cn(a._window),u=null!==c?c.anchorNode:null,d=o.key,h=a.getElementByKey(d),f=n.length;return d!==i.key||!Ur(l)||(!s&&(!ae||Qn<r+50)||l.isDirty()&&f<2||Ft(n))&&o.offset!==i.offset&&!l.isComposing()||ht(l)||l.isDirty()&&f>1||(s||!ae)&&null!==h&&!l.isComposing()&&u!==gt(h)||null!==c&&null!==t&&(!t.collapsed||t.startContainer!==c.anchorNode||t.startOffset!==c.anchorOffset)||l.getFormat()!==e.format||l.getStyle()!==e.style||function(e,t){if(t.isSegmented())return!0;if(!e.isCollapsed())return!1;const n=e.anchor.offset,r=t.getParentOrThrow(),s=t.isToken();return 0===n?!t.canInsertTextBefore()||!r.canInsertTextBefore()&&!t.isComposing()||s||function(e){const t=e.getPreviousSibling();return(Ur(t)||Js(t)&&t.isInline())&&!t.canInsertTextAfter()}(t):n===t.getTextContentSize()&&(!t.canInsertTextAfter()||!r.canInsertTextAfter()&&!t.isComposing()||s)}(e,l)}function ar(e,t){return null!==e&&null!==e.nodeValue&&e.nodeType===me&&0!==t&&t!==e.nodeValue.length}function cr(e,t,n){const{anchorNode:r,anchorOffset:s,focusNode:o,focusOffset:i}=e;nr&&(nr=!1,ar(r,s)&&ar(o,i))||Ks(t,(()=>{if(!n)return void Rt(null);if(!ut(t,r,o))return;const l=hs();if(Gr(l)){const n=l.anchor,r=n.getNode();if(l.isCollapsed()){"Range"===e.type&&e.anchorNode===e.focusNode&&(l.dirty=!0);const s=nn(t).event,o=s?s.timeStamp:performance.now(),[i,a,c,u,d]=ir,h=Tt(),f=!1===t.isComposing()&&""===h.getTextContent();if(o<d+200&&n.offset===c&&n.key===u)l.format=i,l.style=a;else if("text"===n.type)Ur(r)||re(141),l.format=r.getFormat(),l.style=r.getStyle();else if("element"===n.type&&!f){const e=n.getNode();e instanceof Qs&&0===e.getChildrenSize()?l.format=e.getTextFormat():l.format=0,l.style=""}}else{const e=n.key,t=l.focus.key,r=l.getNodes(),o=r.length,a=l.isBackward(),c=a?i:s,u=a?s:i,d=a?t:e,h=a?e:t;let f=ke,g=!1;for(let n=0;n<o;n++){const e=r[n],t=e.getTextContentSize();if(Ur(e)&&0!==t&&!(0===n&&e.__key===d&&c===t||n===o-1&&e.__key===h&&0===u)&&(g=!0,f&=e.getFormat(),0===f))break}l.format=g?f:0}}qt(t,h,void 0)}))}function ur(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return 0===t.length?null:t[0]}function dr(e,t){const n=e._compositionKey;if(wt(null),null!==n&&null!=t){if(""===t){const t=vt(n),r=gt(e.getElementByKey(n));return void(null!==r&&null!==r.nodeValue&&Ur(t)&&Mt(t,r.nodeValue,null,null,!0))}if("\n"===t[t.length-1]){const t=hs();if(Gr(t)){const n=t.focus;return t.anchor.set(n.key,n.offset,n.type),void qt(e,D,null)}}}It(!0,e,t)}function hr(e){let t=e.__lexicalEventHandles;return void 0===t&&(t=[],e.__lexicalEventHandles=t),t}const fr=new Map;function gr(e){const t=e.target,n=cn(null==t?null:9===t.nodeType?t.defaultView:t.ownerDocument.defaultView);if(null===n)return;const r=dt(n.anchorNode);if(null===r)return;rr&&(rr=!1,Ks(r,(()=>{const t=fs(),s=n.anchorNode;if(null===s)return;const o=s.nodeType;o!==pe&&o!==me||Rt(ds(t,n,r,e))})));const s=Dt(r),o=s[s.length-1],i=o._key,l=fr.get(i),a=l||o;a!==r&&cr(n,a,!1),cr(n,r,!0),r!==o?fr.set(i,r):l&&fr.delete(i)}function pr(e){e._lexicalHandled=!0}function mr(e){return!0===e._lexicalHandled}function _r(e,t,n){Ns();const r=e.__key,s=e.getParent();if(null===s)return;const o=function(e){const t=hs();if(!Gr(t)||!Js(e))return t;const{anchor:n,focus:r}=t,s=n.getNode(),o=r.getNode();return tn(s,e)&&n.set(e.__key,0,"element"),tn(o,e)&&r.set(e.__key,0,"element"),t}(e);let i=!1;if(Gr(o)&&t){const t=o.anchor,n=o.focus;t.key===r&&(ms(t,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),n.key===r&&(ms(n,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else es(o)&&t&&e.isSelected()&&e.selectPrevious();if(Gr(o)&&t&&!i){const t=e.getIndexWithinParent();yt(e),gs(o,s,t,-1)}else yt(e);n||rn(s)||s.canBeEmpty()||!s.isEmpty()||_r(s,t),t&&Zs(s)&&s.isEmpty()&&s.selectEnd()}class yr{static getType(){re(64,this.name)}static clone(e){re(65,this.name)}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,_t(this,e)}getType(){return this.__type}isInline(){re(137,this.constructor.name)}isAttached(){let e=this.__key;for(;null!==e;){if("root"===e)return!0;const t=vt(e);if(null===t)break;e=t.__parent}return!1}isSelected(e){const t=e||hs();if(null==t)return!1;const n=t.getNodes().some((e=>e.__key===this.__key));return(Ur(this)||!Gr(t)||"element"!==t.anchor.type||"element"!==t.focus.type||t.anchor.key!==t.focus.key||t.anchor.offset!==t.focus.offset)&&n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(null===e)return-1;let t=e.getFirstChild(),n=0;for(;null!==t;){if(this.is(t))return n;n++,t=t.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return null===e?null:vt(e)}getParentOrThrow(){const e=this.getParent();return null===e&&re(66,this.__key),e}getTopLevelElement(){let e=this;for(;null!==e;){const t=e.getParent();if(rn(t))return Js(e)||re(138),e;e=t}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return null===e&&re(67,this.__key),e}getParents(){const e=[];let t=this.getParent();for(;null!==t;)e.push(t),t=t.getParent();return e}getParentKeys(){const e=[];let t=this.getParent();for(;null!==t;)e.push(t.__key),t=t.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return null===e?null:vt(e)}getPreviousSiblings(){const e=[],t=this.getParent();if(null===t)return e;let n=t.getFirstChild();for(;null!==n&&!n.is(this);)e.push(n),n=n.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return null===e?null:vt(e)}getNextSiblings(){const e=[];let t=this.getNextSibling();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getCommonAncestor(e){const t=this.getParents(),n=e.getParents();Js(this)&&t.unshift(this),Js(e)&&n.unshift(e);const r=t.length,s=n.length;if(0===r||0===s||t[r-1]!==n[s-1])return null;const o=new Set(n);for(let i=0;i<r;i++){const e=t[i];if(o.has(e))return e}return null}is(e){return null!=e&&this.__key===e.__key}isBefore(e){if(this===e)return!1;if(e.isParentOf(this))return!0;if(this.isParentOf(e))return!1;const t=this.getCommonAncestor(e);let n=0,r=0,s=this;for(;;){const e=s.getParentOrThrow();if(e===t){n=s.getIndexWithinParent();break}s=e}for(s=e;;){const e=s.getParentOrThrow();if(e===t){r=s.getIndexWithinParent();break}s=e}return n<r}isParentOf(e){const t=this.__key;if(t===e.__key)return!1;let n=e;for(;null!==n;){if(n.__key===t)return!0;n=n.getParent()}return!1}getNodesBetween(e){const t=this.isBefore(e),n=[],r=new Set;let s=this;for(;null!==s;){const o=s.__key;if(r.has(o)||(r.add(o),n.push(s)),s===e)break;const i=Js(s)?t?s.getFirstChild():s.getLastChild():null;if(null!==i){s=i;continue}const l=t?s.getNextSibling():s.getPreviousSibling();if(null!==l){s=l;continue}const a=s.getParentOrThrow();if(r.has(a.__key)||n.push(a),a===e)break;let c=null,u=a;do{if(null===u&&re(68),c=t?u.getNextSibling():u.getPreviousSibling(),u=u.getParent(),null===u)break;null!==c||r.has(u.__key)||n.push(u)}while(null===c);s=c}return t||n.reverse(),n}isDirty(){const e=Os()._dirtyLeaves;return null!==e&&e.has(this.__key)}getLatest(){const e=vt(this.__key);return null===e&&re(113),e}getWritable(){Ns();const e=As(),t=Os(),n=e._nodeMap,r=this.__key,s=this.getLatest(),o=s.__parent,i=t._cloneNotNeeded,l=hs();if(null!==l&&l.setCachedNodes(null),i.has(r))return bt(s),s;const a=s.constructor.clone(s);return a.__parent=o,a.__next=s.__next,a.__prev=s.__prev,Js(s)&&Js(a)?(no(s)&&no(a)&&(a.__textFormat=s.__textFormat),a.__first=s.__first,a.__last=s.__last,a.__size=s.__size,a.__indent=s.__indent,a.__format=s.__format,a.__dir=s.__dir):Ur(s)&&Ur(a)&&(a.__format=s.__format,a.__style=s.__style,a.__mode=s.__mode,a.__detail=s.__detail),i.add(r),a.__key=r,bt(a),n.set(r,a),a}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,t){re(70)}updateDOM(e,t,n){re(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){re(72)}static importJSON(e){re(18,this.name)}static transform(){return null}remove(e){_r(this,!0,e)}replace(e,t){Ns();let n=hs();null!==n&&(n=n.clone()),on(this,e);const r=this.getLatest(),s=this.__key,o=e.__key,i=e.getWritable(),l=this.getParentOrThrow().getWritable(),a=l.__size;yt(i);const c=r.getPreviousSibling(),u=r.getNextSibling(),d=r.__prev,h=r.__next,f=r.__parent;if(_r(r,!1,!0),null===c?l.__first=o:c.getWritable().__next=o,i.__prev=d,null===u?l.__last=o:u.getWritable().__prev=o,i.__next=h,i.__parent=f,l.__size=a,t&&(Js(this)&&Js(i)||re(139),this.getChildren().forEach((e=>{i.append(e)}))),Gr(n)){Rt(n);const e=n.anchor,t=n.focus;e.key===s&&Yr(e,i),t.key===s&&Yr(t,i)}return xt()===s&&wt(o),i}insertAfter(e,t=!0){Ns(),on(this,e);const n=this.getWritable(),r=e.getWritable(),s=r.getParent(),o=hs();let i=!1,l=!1;if(null!==s){const t=e.getIndexWithinParent();if(yt(r),Gr(o)){const e=s.__key,n=o.anchor,r=o.focus;i="element"===n.type&&n.key===e&&n.offset===t+1,l="element"===r.type&&r.key===e&&r.offset===t+1}}const a=this.getNextSibling(),c=this.getParentOrThrow().getWritable(),u=r.__key,d=n.__next;if(null===a?c.__last=u:a.getWritable().__prev=u,c.__size++,n.__next=u,r.__next=d,r.__prev=n.__key,r.__parent=n.__parent,t&&Gr(o)){const e=this.getIndexWithinParent();gs(o,c,e+1);const t=c.__key;i&&o.anchor.set(t,e+2,"element"),l&&o.focus.set(t,e+2,"element")}return e}insertBefore(e,t=!0){Ns(),on(this,e);const n=this.getWritable(),r=e.getWritable(),s=r.__key;yt(r);const o=this.getPreviousSibling(),i=this.getParentOrThrow().getWritable(),l=n.__prev,a=this.getIndexWithinParent();null===o?i.__first=s:o.getWritable().__next=s,i.__size++,n.__prev=s,r.__prev=l,r.__next=n.__key,r.__parent=n.__parent;const c=hs();return t&&Gr(c)&&gs(c,this.getParentOrThrow(),a),e}isParentRequired(){return!1}createParentElementNode(){return to()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){Ns();const n=this.getPreviousSibling(),r=this.getParentOrThrow();if(null===n)return r.select(0,0);if(Js(n))return n.select();if(!Ur(n)){const e=n.getIndexWithinParent()+1;return r.select(e,e)}return n.select(e,t)}selectNext(e,t){Ns();const n=this.getNextSibling(),r=this.getParentOrThrow();if(null===n)return r.select();if(Js(n))return n.select(0,0);if(!Ur(n)){const e=n.getIndexWithinParent();return r.select(e,e)}return n.select(e,t)}markDirty(){this.getWritable()}}class br extends yr{static getType(){return"linebreak"}static clone(e){return new br(e.__key)}constructor(e){super(e)}getTextContent(){return"\n"}createDOM(){return document.createElement("br")}updateDOM(){return!1}static importDOM(){return{br:e=>function(e){const t=e.parentElement;if(null!==t){const n=t.firstChild;if(n===e||n.nextSibling===e&&Sr(n)){const n=t.lastChild;if(n===e||n.previousSibling===e&&Sr(n))return!0}}return!1}(e)?null:{conversion:wr,priority:0}}}static importJSON(e){return xr()}exportJSON(){return{type:"linebreak",version:1}}}function wr(e){return{node:xr()}}function xr(){return sn(new br)}function vr(e){return e instanceof br}function Sr(e){return e.nodeType===me&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function Cr(e,t){return 16&t?"code":128&t?"mark":32&t?"sub":64&t?"sup":null}function kr(e,t){return 1&t?"strong":2&t?"em":"span"}function Er(e,t,n,r,s){const o=r.classList;let i=Jt(s,"base");void 0!==i&&o.add(...i),i=Jt(s,"underlineStrikethrough");let l=!1;const a=t&Ce&&t&Se;void 0!==i&&(n&Ce&&n&Se?(l=!0,a||o.add(...i)):a&&o.remove(...i));for(const c in ze){const e=ze[c];if(i=Jt(s,c),void 0!==i)if(n&e){if(l&&("underline"===c||"strikethrough"===c)){t&e&&o.remove(...i);continue}t&e&&(!a||"underline"!==c)&&"strikethrough"!==c||o.add(...i)}else t&e&&o.remove(...i)}}function Tr(e,t,n){const r=t.firstChild,s=n.isComposing(),o=e+(s?Fe:"");if(null==r)t.textContent=o;else{const e=r.nodeValue;if(e!==o)if(s||le){const[t,n,s]=function(e,t){const n=e.length,r=t.length;let s=0,o=0;for(;s<n&&s<r&&e[s]===t[s];)s++;for(;o+s<n&&o+s<r&&e[n-o-1]===t[r-o-1];)o++;return[s,n-s-o,t.slice(s,r-o)]}(e,o);0!==n&&r.deleteData(t,n),r.insertData(t,s)}else r.nodeValue=o}}function Nr(e,t,n,r,s,o){Tr(s,e,t);const i=o.theme.text;void 0!==i&&Er(0,0,r,e,i)}function Rr(e,t){const n=document.createElement(t);return n.appendChild(e),n}class Ar extends yr{static getType(){return"text"}static clone(e){return new Ar(e.__text,e.__key)}constructor(e,t){super(t),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return je[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return 1===this.getLatest().__mode}isComposing(){return this.__key===xt()}isSegmented(){return 2===this.getLatest().__mode}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const t=ze[e];return!!(this.getFormat()&t)}isSimpleText(){return"text"===this.__type&&0===this.__mode}getTextContent(){return this.getLatest().__text}getFormatFlags(e,t){return pt(this.getLatest().__format,e,t)}canHaveFormat(){return!0}createDOM(e,t){const n=this.__format,r=Cr(0,n),s=kr(0,n),o=null===r?s:r,i=document.createElement(o);let l=i;this.hasFormat("code")&&i.setAttribute("spellcheck","false"),null!==r&&(l=document.createElement(s),i.appendChild(l)),Nr(l,this,0,n,this.__text,e);const a=this.__style;return""!==a&&(i.style.cssText=a),i}updateDOM(e,t,n){const r=this.__text,s=e.__format,o=this.__format,i=Cr(0,s),l=Cr(0,o),a=kr(0,s),c=kr(0,o);if((null===i?a:i)!==(null===l?c:l))return!0;if(i===l&&a!==c){const e=t.firstChild;null==e&&re(48);const s=document.createElement(c);return Nr(s,this,0,o,r,n),t.replaceChild(s,e),!1}let u=t;null!==l&&null!==i&&(u=t.firstChild,null==u&&re(49)),Tr(r,u,this);const d=n.theme.text;void 0!==d&&s!==o&&Er(0,s,o,u,d);const h=e.__style,f=this.__style;return h!==f&&(t.style.cssText=f),!1}static importDOM(){return{"#text":()=>({conversion:Lr,priority:0}),b:()=>({conversion:Fr,priority:0}),code:()=>({conversion:zr,priority:0}),em:()=>({conversion:zr,priority:0}),i:()=>({conversion:zr,priority:0}),s:()=>({conversion:zr,priority:0}),span:()=>({conversion:Or,priority:0}),strong:()=>({conversion:zr,priority:0}),sub:()=>({conversion:zr,priority:0}),sup:()=>({conversion:zr,priority:0}),u:()=>({conversion:zr,priority:0})}}static importJSON(e){const t=$r(e.text);return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}exportDOM(e){let{element:t}=super.exportDOM(e);return null!==t&&hn(t)||re(132),t.style.whiteSpace="pre-wrap",this.hasFormat("bold")&&(t=Rr(t,"b")),this.hasFormat("italic")&&(t=Rr(t,"i")),this.hasFormat("strikethrough")&&(t=Rr(t,"s")),this.hasFormat("underline")&&(t=Rr(t,"u")),{element:t}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),type:"text",version:1}}selectionTransform(e,t){}setFormat(e){const t=this.getWritable();return t.__format="string"==typeof e?ze[e]:e,t}setDetail(e){const t=this.getWritable();return t.__detail="string"==typeof e?$e[e]:e,t}setStyle(e){const t=this.getWritable();return t.__style=e,t}toggleFormat(e){const t=pt(this.getFormat(),e,null);return this.setFormat(t)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const t=We[e];if(this.__mode===t)return this;const n=this.getWritable();return n.__mode=t,n}setTextContent(e){if(this.__text===e)return this;const t=this.getWritable();return t.__text=e,t}select(e,t){Ns();let n=e,r=t;const s=hs(),o=this.getTextContent(),i=this.__key;if("string"==typeof o){const e=o.length;void 0===n&&(n=e),void 0===r&&(r=e)}else n=0,r=0;if(!Gr(s))return as(i,n,i,r,"text","text");{const e=xt();e!==s.anchor.key&&e!==s.focus.key||wt(i),s.setTextNodeRange(this,n,this,r)}return s}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,n,r){const s=this.getWritable(),o=s.__text,i=n.length;let l=e;l<0&&(l=i+l,l<0&&(l=0));const a=hs();if(r&&Gr(a)){const t=e+i;a.setTextNodeRange(s,t,s,t)}const c=o.slice(0,l)+n+o.slice(l+t);return s.__text=c,s}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){Ns();const t=this.getLatest(),n=t.getTextContent(),r=t.__key,s=xt(),o=new Set(e),i=[],l=n.length;let a="";for(let v=0;v<l;v++)""!==a&&o.has(v)&&(i.push(a),a=""),a+=n[v];""!==a&&i.push(a);const c=i.length;if(0===c)return[];if(i[0]===n)return[t];const u=i[0],d=t.getParentOrThrow();let h;const f=t.getFormat(),g=t.getStyle(),p=t.__detail;let m=!1;t.isSegmented()?(h=$r(u),h.__format=f,h.__style=g,h.__detail=p,m=!0):(h=t.getWritable(),h.__text=u);const _=hs(),y=[h];let b=u.length;for(let v=1;v<c;v++){const e=i[v],t=e.length,n=$r(e).getWritable();n.__format=f,n.__style=g,n.__detail=p;const o=n.__key,l=b+t;if(Gr(_)){const e=_.anchor,t=_.focus;e.key===r&&"text"===e.type&&e.offset>b&&e.offset<=l&&(e.key=o,e.offset-=b,_.dirty=!0),t.key===r&&"text"===t.type&&t.offset>b&&t.offset<=l&&(t.key=o,t.offset-=b,_.dirty=!0)}s===r&&wt(o),b=l,y.push(n)}!function(e){const t=e.getPreviousSibling(),n=e.getNextSibling();null!==t&&bt(t),null!==n&&bt(n)}(this);const w=d.getWritable(),x=this.getIndexWithinParent();return m?(w.splice(x,0,y),this.remove()):w.splice(x,1,y),Gr(_)&&gs(_,d,x,c-1),y}mergeWithSibling(e){const t=e===this.getPreviousSibling();t||e===this.getNextSibling()||re(50);const n=this.__key,r=e.__key,s=this.__text,o=s.length;xt()===r&&wt(n);const i=hs();if(Gr(i)){const s=i.anchor,l=i.focus;null!==s&&s.key===r&&(_s(s,t,n,e,o),i.dirty=!0),null!==l&&l.key===r&&(_s(l,t,n,e,o),i.dirty=!0)}const l=e.__text,a=t?l+s:s+l;this.setTextContent(a);const c=this.getWritable();return e.remove(),c}isTextEntity(){return!1}}function Or(e){const t=e.style,n=t.fontWeight,r="700"===n||"bold"===n,s="line-through"===t.textDecoration,o="italic"===t.fontStyle,i="underline"===t.textDecoration,l=t.verticalAlign;return{forChild:e=>Ur(e)?(r&&e.toggleFormat("bold"),s&&e.toggleFormat("strikethrough"),o&&e.toggleFormat("italic"),i&&e.toggleFormat("underline"),"sub"===l&&e.toggleFormat("subscript"),"super"===l&&e.toggleFormat("superscript"),e):e,node:null}}function Fr(e){const t="normal"===e.style.fontWeight;return{forChild:e=>(Ur(e)&&!t&&e.toggleFormat("bold"),e),node:null}}const Dr=new WeakMap;function Pr(e){return"PRE"===e.nodeName||e.nodeType===pe&&void 0!==e.style&&void 0!==e.style.whiteSpace&&e.style.whiteSpace.startsWith("pre")}function Lr(e){const t=e;null===e.parentElement&&re(129);let n=t.textContent||"";if(null!==function(e){let t,n=e.parentNode;const r=[e];for(;null!==n&&void 0===(t=Dr.get(n))&&!Pr(n);)r.push(n),n=n.parentNode;const s=void 0===t?n:t;for(let o=0;o<r.length;o++)Dr.set(r[o],s);return s}(t)){const e=n.split(/(\r?\n|\t)/),t=[],r=e.length;for(let n=0;n<r;n++){const r=e[n];"\n"===r||"\r\n"===r?t.push(xr()):"\t"===r?t.push(Wr()):""!==r&&t.push($r(r))}return{node:t}}if(n=n.replace(/\r/g,"").replace(/[ \t\n]+/g," "),""===n)return{node:null};if(" "===n[0]){let e=t,r=!0;for(;null!==e&&null!==(e=Mr(e,!1));){const t=e.textContent||"";if(t.length>0){/[ \t\n]$/.test(t)&&(n=n.slice(1)),r=!1;break}}r&&(n=n.slice(1))}if(" "===n[n.length-1]){let e=t,r=!0;for(;null!==e&&null!==(e=Mr(e,!0));)if((e.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){r=!1;break}r&&(n=n.slice(0,n.length-1))}return""===n?{node:null}:{node:$r(n)}}const Ir=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/,"i");function Mr(e,t){let n=e;for(;;){let e;for(;null===(e=t?n.nextSibling:n.previousSibling);){const e=n.parentElement;if(null===e)return null;n=e}if(n=e,n.nodeType===pe){const e=n.style.display;if(""===e&&null===n.nodeName.match(Ir)||""!==e&&!e.startsWith("inline"))return null}let r=n;for(;null!==(r=t?n.firstChild:n.lastChild);)n=r;if(n.nodeType===me)return n;if("BR"===n.nodeName)return null}}const Br={code:"code",em:"italic",i:"italic",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function zr(e){const t=Br[e.nodeName.toLowerCase()];return void 0===t?{node:null}:{forChild:e=>(Ur(e)&&!e.hasFormat(t)&&e.toggleFormat(t),e),node:null}}function $r(e=""){return sn(new Ar(e))}function Ur(e){return e instanceof Ar}class Kr extends Ar{static getType(){return"tab"}static clone(e){const t=new Kr(e.__key);return t.__text=e.__text,t.__format=e.__format,t.__style=e.__style,t}constructor(e){super("\t",e),this.__detail=2}static importDOM(){return null}static importJSON(e){const t=Wr();return t.setFormat(e.format),t.setStyle(e.style),t}exportJSON(){return{...super.exportJSON(),type:"tab",version:1}}setTextContent(e){re(126)}setDetail(e){re(127)}setMode(e){re(128)}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function Wr(){return sn(new Kr)}function jr(e){return e instanceof Kr}class Hr{constructor(e,t,n){this._selection=null,this.key=e,this.offset=t,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){let t=this.getNode(),n=e.getNode();const r=this.offset,s=e.offset;if(Js(t)){const e=t.getDescendantByIndex(r);t=null!=e?e:t}if(Js(n)){const e=n.getDescendantByIndex(s);n=null!=e?e:n}return t===n?r<s:t.isBefore(n)}getNode(){const e=vt(this.key);return null===e&&re(20),e}set(e,t,n){const r=this._selection,s=this.key;this.key=e,this.offset=t,this.type=n,Ts()||(xt()===s&&wt(e),null!==r&&(r.setCachedNodes(null),r.dirty=!0))}}function Jr(e,t,n){return new Hr(e,t,n)}function Vr(e,t){let n=t.__key,r=e.offset,s="element";if(Ur(t)){s="text";const e=t.getTextContentSize();r>e&&(r=e)}else if(!Js(t)){const e=t.getNextSibling();if(Ur(e))n=e.__key,r=0,s="text";else{const e=t.getParent();e&&(n=e.__key,r=t.getIndexWithinParent()+1)}}e.set(n,r,s)}function Yr(e,t){if(Js(t)){const n=t.getLastDescendant();Js(n)||Ur(n)?Vr(e,n):Vr(e,t)}else Vr(e,t)}function Zr(e,t,n,r){const s=e.getNode(),o=s.getChildAtIndex(e.offset),i=$r(),l=Zs(s)?to().append(i):i;i.setFormat(n),i.setStyle(r),null===o?s.append(l):o.insertBefore(l),e.is(t)&&t.set(i.__key,0,"text"),e.set(i.__key,0,"text")}function Xr(e,t,n,r){e.key=t,e.offset=n,e.type=r}class qr{constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!es(e))return!1;const t=this._nodes,n=e._nodes;return t.size===n.size&&Array.from(t).every((e=>n.has(e)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new qr(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.getNodes(),n=t.length,r=t[n-1];let s;if(Ur(r))s=r.select();else{const e=r.getIndexWithinParent()+1;s=r.getParentOrThrow().select(e,e)}s.insertNodes(e);for(let o=0;o<n;o++)t[o].remove()}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=this._nodes,n=[];for(const r of t){const e=vt(r);null!==e&&n.push(e)}return Ts()||(this._cachedNodes=n),n}getTextContent(){const e=this.getNodes();let t="";for(let n=0;n<e.length;n++)t+=e[n].getTextContent();return t}}function Gr(e){return e instanceof Qr}class Qr{constructor(e,t,n,r){this.anchor=e,this.focus=t,e._selection=this,t._selection=this,this._cachedNodes=null,this.format=n,this.style=r,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!Gr(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=this.anchor,n=this.focus,r=t.isBefore(n),s=r?t:n,o=r?n:t;let i=s.getNode(),l=o.getNode();const a=s.offset,c=o.offset;if(Js(i)){const e=i.getDescendantByIndex(a);i=null!=e?e:i}if(Js(l)){let e=l.getDescendantByIndex(c);null!==e&&e!==i&&l.getChildAtIndex(c)===e&&(e=e.getPreviousSibling()),l=null!=e?e:l}let u;return u=i.is(l)?Js(i)&&i.getChildrenSize()>0?[]:[i]:i.getNodesBetween(l),Ts()||(this._cachedNodes=u),u}setTextNodeRange(e,t,n,r){Xr(this.anchor,e.__key,t,"text"),Xr(this.focus,n.__key,r,"text"),this._cachedNodes=null,this.dirty=!0}getTextContent(){const e=this.getNodes();if(0===e.length)return"";const t=e[0],n=e[e.length-1],r=this.anchor,s=this.focus,o=r.isBefore(s),[i,l]=ns(this);let a="",c=!0;for(let u=0;u<e.length;u++){const d=e[u];if(Js(d)&&!d.isInline())c||(a+="\n"),c=!d.isEmpty();else if(c=!1,Ur(d)){let e=d.getTextContent();d===t?d===n?"element"===r.type&&"element"===s.type&&s.offset!==r.offset||(e=i<l?e.slice(i,l):e.slice(l,i)):e=o?e.slice(i):e.slice(l):d===n&&(e=o?e.slice(0,l):e.slice(0,i)),a+=e}else!js(d)&&!vr(d)||d===n&&this.isCollapsed()||(a+=d.getTextContent())}return a}applyDOMRange(e){const t=Os(),n=t.getEditorState()._selection,r=ls(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,n);if(null===r)return;const[s,o]=r;Xr(this.anchor,s.key,s.offset,s.type),Xr(this.focus,o.key,o.offset,o.type),this._cachedNodes=null}clone(){const e=this.anchor,t=this.focus;return new Qr(Jr(e.key,e.offset,e.type),Jr(t.key,t.offset,t.type),this.format,this.style)}toggleFormat(e){this.format=pt(this.format,e,null),this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const t=ze[e];return!!(this.format&t)}insertRawText(e){const t=e.split(/(\r?\n|\t)/),n=[],r=t.length;for(let s=0;s<r;s++){const e=t[s];"\n"===e||"\r\n"===e?n.push(xr()):"\t"===e?n.push(Wr()):n.push($r(e))}this.insertNodes(n)}insertText(e){const t=this.anchor,n=this.focus,r=this.isCollapsed()||t.isBefore(n),s=this.format,o=this.style;r&&"element"===t.type?Zr(t,n,s,o):r||"element"!==n.type||Zr(n,t,s,o);const i=this.getNodes(),l=i.length,a=r?n:t,c=(r?t:n).offset,u=a.offset;let d=i[0];Ur(d)||re(26);const h=d.getTextContent().length,f=d.getParentOrThrow();let g=i[l-1];if(this.isCollapsed()&&c===h&&(d.isSegmented()||d.isToken()||!d.canInsertTextAfter()||!f.canInsertTextAfter()&&null===d.getNextSibling())){let t=d.getNextSibling();if(Ur(t)&&t.canInsertTextBefore()&&!ht(t)||(t=$r(),t.setFormat(s),f.canInsertTextAfter()?d.insertAfter(t):f.insertAfter(t)),t.select(0,0),d=t,""!==e)return void this.insertText(e)}else if(this.isCollapsed()&&0===c&&(d.isSegmented()||d.isToken()||!d.canInsertTextBefore()||!f.canInsertTextBefore()&&null===d.getPreviousSibling())){let t=d.getPreviousSibling();if(Ur(t)&&!ht(t)||(t=$r(),t.setFormat(s),f.canInsertTextBefore()?d.insertBefore(t):f.insertBefore(t)),t.select(),d=t,""!==e)return void this.insertText(e)}else if(d.isSegmented()&&c!==h){const e=$r(d.getTextContent());e.setFormat(s),d.replace(e),d=e}else if(!this.isCollapsed()&&""!==e){const t=g.getParent();if(!f.canInsertTextBefore()||!f.canInsertTextAfter()||Js(t)&&(!t.canInsertTextBefore()||!t.canInsertTextAfter()))return this.insertText(""),is(this.anchor,this.focus,null),void this.insertText(e)}if(1===l){if(d.isToken()){const t=$r(e);return t.select(),void d.replace(t)}const t=d.getFormat(),n=d.getStyle();if(c!==u||t===s&&n===o){if(jr(d)){const t=$r(e);return t.setFormat(s),t.setStyle(o),t.select(),void d.replace(t)}}else{if(""!==d.getTextContent()){const t=$r(e);if(t.setFormat(s),t.setStyle(o),t.select(),0===c)d.insertBefore(t,!1);else{const[e]=d.splitText(c);e.insertAfter(t,!1)}return void(t.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length))}d.setFormat(s),d.setStyle(o)}const r=u-c;d=d.spliceText(c,r,e,!0),""===d.getTextContent()?d.remove():"text"===this.anchor.type&&(d.isComposing()?this.anchor.offset-=e.length:(this.format=t,this.style=n))}else{const t=new Set([...d.getParentKeys(),...g.getParentKeys()]),n=Js(d)?d:d.getParentOrThrow();let r=Js(g)?g:g.getParentOrThrow(),s=g;if(!n.is(r)&&r.isInline())do{s=r,r=r.getParentOrThrow()}while(r.isInline());if("text"===a.type&&(0!==u||""===g.getTextContent())||"element"===a.type&&g.getIndexWithinParent()<u)if(Ur(g)&&!g.isToken()&&u!==g.getTextContentSize()){if(g.isSegmented()){const e=$r(g.getTextContent());g.replace(e),g=e}Zs(a.getNode())||"text"!==a.type||(g=g.spliceText(0,u,"")),t.add(g.__key)}else{const e=g.getParentOrThrow();e.canBeEmpty()||1!==e.getChildrenSize()?g.remove():e.remove()}else t.add(g.__key);const o=r.getChildren(),f=new Set(i),p=n.is(r),m=n.isInline()&&null===d.getNextSibling()?n:d;for(let e=o.length-1;e>=0;e--){const t=o[e];if(t.is(d)||Js(t)&&t.isParentOf(d))break;t.isAttached()&&(!f.has(t)||t.is(s)?p||m.insertAfter(t,!1):t.remove())}if(!p){let e=r,n=null;for(;null!==e;){const r=e.getChildren(),s=r.length;(0===s||r[s-1].is(n))&&(t.delete(e.__key),n=e),e=e.getParent()}}if(d.isToken())if(c===h)d.select();else{const t=$r(e);t.select(),d.replace(t)}else d=d.spliceText(c,h-c,e,!0),""===d.getTextContent()?d.remove():d.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length);for(let e=1;e<l;e++){const n=i[e],r=n.__key;t.has(r)||n.remove()}}}removeText(){this.insertText("")}formatText(e){if(this.isCollapsed())return this.toggleFormat(e),void wt(null);const t=this.getNodes(),n=[];for(const _ of t)Ur(_)&&n.push(_);const r=n.length;if(0===r)return this.toggleFormat(e),void wt(null);const s=this.anchor,o=this.focus,i=this.isBackward(),l=i?o:s,a=i?s:o;let c=0,u=n[0],d="element"===l.type?0:l.offset;if("text"===l.type&&d===u.getTextContentSize()&&(c=1,u=n[1],d=0),null==u)return;const h=u.getFormatFlags(e,null),f=r-1;let g=n[f];const p="text"===a.type?a.offset:g.getTextContentSize();if(u.is(g)){if(d===p)return;if(0===d&&p===u.getTextContentSize())u.setFormat(h);else{const e=u.splitText(d,p),t=0===d?e[0]:e[1];t.setFormat(h),"text"===l.type&&l.set(t.__key,0,"text"),"text"===a.type&&a.set(t.__key,p-d,"text")}return void(this.format=h)}0!==d&&([,u]=u.splitText(d),d=0),u.setFormat(h);const m=g.getFormatFlags(e,h);p>0&&(p!==g.getTextContentSize()&&([g]=g.splitText(p)),g.setFormat(m));for(let _=c+1;_<f;_++){const t=n[_];if(!t.isToken()){const n=t.getFormatFlags(e,m);t.setFormat(n)}}"text"===l.type&&l.set(u.__key,d,"text"),"text"===a.type&&a.set(g.__key,p,"text"),this.format=h|m}insertNodes(e){if(0===e.length)return;if("root"===this.anchor.key){this.insertParagraph();const t=hs();return Gr(t)||re(134),t.insertNodes(e)}const t=gn((this.isBackward()?this.focus:this.anchor).getNode(),fn),n=e[e.length-1];if("__language"in t&&Js(t)){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const r=bs(this);t.splice(r,0,e),n.selectEnd()}return}if(!e.some((e=>(Js(e)||js(e))&&!e.isInline()))){Js(t)||re(135);const r=bs(this);return t.splice(r,0,e),void n.selectEnd()}const r=function(e){const t=to();let n=null;for(let r=0;r<e.length;r++){const s=e[r],o=vr(s);if(o||js(s)&&s.isInline()||Js(s)&&s.isInline()||Ur(s)||s.isParentRequired()){if(null===n&&(n=s.createParentElementNode(),t.append(n),o))continue;null!==n&&n.append(s)}else t.append(s),n=null}return t}(e),s=r.getLastDescendant(),o=r.getChildren(),i=e=>"__value"in e&&"__checked"in e,l=Js(t)&&t.isEmpty()?null:this.insertParagraph(),a=o[o.length-1];let c=o[0];var u;Js(u=c)&&fn(u)&&!u.isEmpty()&&Js(t)&&(!t.isEmpty()||i(t))&&(Js(t)||re(135),t.append(...c.getChildren()),c=o[1]),c&&function(e,t,n){const r=t.getParentOrThrow().getLastChild();let s=t;const o=[t];for(;s!==r;)s.getNextSibling()||re(140),s=s.getNextSibling(),o.push(s);let i=e;for(const l of o)i=i.insertAfter(l)}(t,c);const d=gn(s,fn);l&&Js(d)&&(i(l)||fn(a))&&(d.append(...l.getChildren()),l.remove()),Js(t)&&t.isEmpty()&&t.remove(),s.selectEnd();const h=Js(t)?t.getLastChild():null;vr(h)&&d!==t&&h.remove()}insertParagraph(){if("root"===this.anchor.key){const e=to();return Tt().splice(this.anchor.offset,0,[e]),e.select(),e}const e=bs(this),t=gn(this.anchor.getNode(),fn);Js(t)||re(136);const n=t.getChildAtIndex(e),r=n?[n,...n.getNextSiblings()]:[],s=t.insertNewAfter(this,!1);return s?(s.append(...r),s.selectStart(),s):null}insertLineBreak(e){const t=xr();if(this.insertNodes([t]),e){const e=t.getParentOrThrow(),n=t.getIndexWithinParent();e.select(n,n)}}extract(){const e=this.getNodes(),t=e.length,n=t-1,r=this.anchor,s=this.focus;let o=e[0],i=e[n];const[l,a]=ns(this);if(0===t)return[];if(1===t){if(Ur(o)&&!this.isCollapsed()){const e=l>a?a:l,t=l>a?l:a,n=o.splitText(e,t),r=0===e?n[0]:n[1];return null!=r?[r]:[]}return[o]}const c=r.isBefore(s);if(Ur(o)){const t=c?l:a;t===o.getTextContentSize()?e.shift():0!==t&&([,o]=o.splitText(t),e[0]=o)}if(Ur(i)){const t=i.getTextContent().length,r=c?a:l;0===r?e.pop():r!==t&&([i]=i.splitText(r),e[n]=i)}return e}modify(e,t,n){const r=this.focus,s=this.anchor,o="move"===e,i=Zt(r,t);if(js(i)&&!i.isIsolated()){if(o&&i.isKeyboardSelectable()){const e=us();return e.add(i.__key),void Rt(e)}const e=t?i.getPreviousSibling():i.getNextSibling();if(Ur(e)){const n=e.__key,i=t?e.getTextContent().length:0;return r.set(n,i,"text"),void(o&&s.set(n,i,"text"))}{const n=i.getParentOrThrow();let l,a;return Js(e)?(a=e.__key,l=t?e.getChildrenSize():0):(l=i.getIndexWithinParent(),a=n.__key,t||l++),r.set(a,l,"element"),void(o&&s.set(a,l,"element"))}}const l=Os(),a=cn(l._window);if(!a)return;const c=l._blockCursorElement,u=l._rootElement;if(null===u||null===c||!Js(i)||i.isInline()||i.canBeEmpty()||an(c,l,u),d=e,h=t?"backward":"forward",f=n,a.modify(d,h,f),a.rangeCount>0){const e=a.getRangeAt(0),n=this.anchor.getNode(),r=Zs(n)?n:function(e){let t=e.getParentOrThrow();for(;null!==t;){if(rn(t))return t;t=t.getParentOrThrow()}return t}(n);if(this.applyDOMRange(e),this.dirty=!0,!o){const n=this.getNodes(),s=[];let o=!1;for(let e=0;e<n.length;e++){const t=n[e];tn(t,r)?s.push(t):o=!0}if(o&&s.length>0)if(t){const e=s[0];Js(e)?e.selectStart():e.getParentOrThrow().selectStart()}else{const e=s[s.length-1];Js(e)?e.selectEnd():e.getParentOrThrow().selectEnd()}a.anchorNode===e.startContainer&&a.anchorOffset===e.startOffset||function(e){const t=e.focus,n=e.anchor,r=n.key,s=n.offset,o=n.type;Xr(n,t.key,t.offset,t.type),Xr(t,r,s,o),e._cachedNodes=null}(this)}}var d,h,f}forwardDeletion(e,t,n){if(!n&&("element"===e.type&&Js(t)&&e.offset===t.getChildrenSize()||"text"===e.type&&e.offset===t.getTextContentSize())){const e=t.getParent(),n=t.getNextSibling()||(null===e?null:e.getNextSibling());if(Js(n)&&n.isShadowRoot())return!0}return!1}deleteCharacter(e){const t=this.isCollapsed();if(this.isCollapsed()){const t=this.anchor;let n=t.getNode();if(this.forwardDeletion(t,n,e))return;const r=this.focus,s=Zt(r,e);if(js(s)&&!s.isIsolated()){if(s.isKeyboardSelectable()&&Js(n)&&0===n.getChildrenSize()){n.remove();const e=us();e.add(s.__key),Rt(e)}else s.remove(),Os().dispatchCommand(h,void 0);return}if(!e&&Js(s)&&Js(n)&&n.isEmpty())return n.remove(),void s.selectStart();if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&0===t.offset&&("element"===t.type?t.getNode():t.getNode().getParentOrThrow()).collapseAtStart(this))return}else{const s="text"===r.type?r.getNode():null;if(n="text"===t.type?t.getNode():null,null!==s&&s.isSegmented()){const t=r.offset,o=s.getTextContentSize();if(s.is(n)||e&&t!==o||!e&&0!==t)return void rs(s,e,t)}else if(null!==n&&n.isSegmented()){const r=t.offset,o=n.getTextContentSize();if(n.is(s)||e&&0!==r||!e&&r!==o)return void rs(n,e,r)}!function(e,t){const n=e.anchor,r=e.focus,s=n.getNode();if(s===r.getNode()&&"text"===n.type&&"text"===r.type){const e=n.offset,o=r.offset,i=e<o,l=i?e:o,a=i?o:e,c=a-1;l!==c&&(Ft(s.getTextContent().slice(l,a))||(t?r.offset=c:n.offset=c))}}(this,e)}}if(this.removeText(),e&&!t&&this.isCollapsed()&&"element"===this.anchor.type&&0===this.anchor.offset){const e=this.anchor.getNode();e.isEmpty()&&Zs(e.getParent())&&0===e.getIndexWithinParent()&&e.collapseAtStart(this)}}deleteLine(e){this.isCollapsed()&&("text"===this.anchor.type&&this.modify("extend",e,"lineboundary"),0===(e?this.focus:this.anchor).offset&&this.modify("extend",e,"character")),this.removeText()}deleteWord(e){if(this.isCollapsed()){const t=this.anchor,n=t.getNode();if(this.forwardDeletion(t,n,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function es(e){return e instanceof qr}function ts(e){const t=e.offset;if("text"===e.type)return t;const n=e.getNode();return t===n.getChildrenSize()?n.getTextContent().length:0}function ns(e){const t=e.getStartEndPoints();if(null===t)return[0,0];const[n,r]=t;return"element"===n.type&&"element"===r.type&&n.key===r.key&&n.offset===r.offset?[0,0]:[ts(n),ts(r)]}function rs(e,t,n){const r=e,s=r.getTextContent().split(/(?=\s)/g),o=s.length;let i=0,l=0;for(let c=0;c<o;c++){const e=c===o-1;if(l=i,i+=s[c].length,t&&i===n||i>n||e){s.splice(c,1),e&&(l=void 0);break}}const a=s.join("").trim();""===a?r.remove():(r.setTextContent(a),r.select(l,l))}function ss(e,t,n,r){let s,o=t;if(e.nodeType===pe){let i=!1;const l=e.childNodes,a=l.length;o===a&&(i=!0,o=a-1);let c=l[o],u=!1;if(c===r._blockCursorElement?(c=l[o+1],u=!0):null!==r._blockCursorElement&&o--,s=At(c),Ur(s))o=Ot(s,i);else{let r=At(e);if(null===r)return null;if(Js(r)){o=Math.min(r.getChildrenSize(),o);let e=r.getChildAtIndex(o);if(Js(e)&&function(e,t,n){const r=e.getParent();return null===n||null===r||!r.canBeEmpty()||r!==n.getNode()}(e,0,n)){const t=i?e.getLastDescendant():e.getFirstDescendant();null===t?(r=e,o=0):(e=t,r=Js(e)?e:e.getParentOrThrow())}Ur(e)?(s=e,r=null,o=Ot(e,i)):e!==r&&i&&!u&&o++}else{const n=r.getIndexWithinParent();o=0===t&&js(r)&&At(e)===r?n:n+1,r=r.getParentOrThrow()}if(Js(r))return Jr(r.__key,o,"element")}}else s=At(e);return Ur(s)?Jr(s.__key,o,"text"):null}function os(e,t,n){const r=e.offset,s=e.getNode();if(0===r){const r=s.getPreviousSibling(),o=s.getParent();if(t){if((n||!t)&&null===r&&Js(o)&&o.isInline()){const t=o.getPreviousSibling();Ur(t)&&(e.key=t.__key,e.offset=t.getTextContent().length)}}else Js(r)&&!n&&r.isInline()?(e.key=r.__key,e.offset=r.getChildrenSize(),e.type="element"):Ur(r)&&(e.key=r.__key,e.offset=r.getTextContent().length)}else if(r===s.getTextContent().length){const r=s.getNextSibling(),o=s.getParent();if(t&&Js(r)&&r.isInline())e.key=r.__key,e.offset=0,e.type="element";else if((n||t)&&null===r&&Js(o)&&o.isInline()&&!o.canInsertTextAfter()){const t=o.getNextSibling();Ur(t)&&(e.key=t.__key,e.offset=0)}}}function is(e,t,n){if("text"===e.type&&"text"===t.type){const r=e.isBefore(t),s=e.is(t);os(e,r,s),os(t,!r,s),s&&(t.key=e.key,t.offset=e.offset,t.type=e.type);const o=Os();if(o.isComposing()&&o._compositionKey!==e.key&&Gr(n)){const r=n.anchor,s=n.focus;Xr(e,r.key,r.offset,r.type),Xr(t,s.key,s.offset,s.type)}}}function ls(e,t,n,r,s,o){if(null===e||null===n||!ut(s,e,n))return null;const i=ss(e,t,Gr(o)?o.anchor:null,s);if(null===i)return null;const l=ss(n,r,Gr(o)?o.focus:null,s);if(null===l)return null;if("element"===i.type&&"element"===l.type){const t=At(e),r=At(n);if(js(t)&&js(r))return null}return is(i,l,o),[i,l]}function as(e,t,n,r,s,o){const i=As(),l=new Qr(Jr(e,t,s),Jr(n,r,o),0,"");return l.dirty=!0,i._selection=l,l}function cs(){const e=Jr("root",0,"element"),t=Jr("root",0,"element");return new Qr(e,t,0,"")}function us(){return new qr(new Set)}function ds(e,t,n,r){const s=n._window;if(null===s)return null;const o=r||s.event,i=o?o.type:void 0,l="selectionchange"===i,a=!Ve&&(l||"beforeinput"===i||"compositionstart"===i||"compositionend"===i||"click"===i&&o&&3===o.detail||"drop"===i||void 0===i);let c,u,d,h;if(Gr(e)&&!a)return e.clone();if(null===t)return null;if(c=t.anchorNode,u=t.focusNode,d=t.anchorOffset,h=t.focusOffset,l&&Gr(e)&&!ut(n,c,u))return e.clone();const f=ls(c,d,u,h,n,e);if(null===f)return null;const[g,p]=f;return new Qr(g,p,Gr(e)?e.format:0,Gr(e)?e.style:"")}function hs(){return As()._selection}function fs(){return Os()._editorState._selection}function gs(e,t,n,r=1){const s=e.anchor,o=e.focus,i=s.getNode(),l=o.getNode();if(!t.is(i)&&!t.is(l))return;const a=t.__key;if(e.isCollapsed()){const t=s.offset;if(n<=t&&r>0||n<t&&r<0){const n=Math.max(0,t+r);s.set(a,n,"element"),o.set(a,n,"element"),ps(e)}}else{const i=e.isBackward(),l=i?o:s,c=l.getNode(),u=i?s:o,d=u.getNode();if(t.is(c)){const e=l.offset;(n<=e&&r>0||n<e&&r<0)&&l.set(a,Math.max(0,e+r),"element")}if(t.is(d)){const e=u.offset;(n<=e&&r>0||n<e&&r<0)&&u.set(a,Math.max(0,e+r),"element")}}ps(e)}function ps(e){const t=e.anchor,n=t.offset,r=e.focus,s=r.offset,o=t.getNode(),i=r.getNode();if(e.isCollapsed()){if(!Js(o))return;const e=o.getChildrenSize(),s=n>=e,i=s?o.getChildAtIndex(e-1):o.getChildAtIndex(n);if(Ur(i)){let e=0;s&&(e=i.getTextContentSize()),t.set(i.__key,e,"text"),r.set(i.__key,e,"text")}}else{if(Js(o)){const e=o.getChildrenSize(),r=n>=e,s=r?o.getChildAtIndex(e-1):o.getChildAtIndex(n);if(Ur(s)){let e=0;r&&(e=s.getTextContentSize()),t.set(s.__key,e,"text")}}if(Js(i)){const e=i.getChildrenSize(),t=s>=e,n=t?i.getChildAtIndex(e-1):i.getChildAtIndex(s);if(Ur(n)){let e=0;t&&(e=n.getTextContentSize()),r.set(n.__key,e,"text")}}}}function ms(e,t,n,r,s){let o=null,i=0,l=null;null!==r?(o=r.__key,Ur(r)?(i=r.getTextContentSize(),l="text"):Js(r)&&(i=r.getChildrenSize(),l="element")):null!==s&&(o=s.__key,Ur(s)?l="text":Js(s)&&(l="element")),null!==o&&null!==l?e.set(o,i,l):(i=t.getIndexWithinParent(),-1===i&&(i=n.getChildrenSize()),e.set(n.__key,i,"element"))}function _s(e,t,n,r,s){"text"===e.type?(e.key=n,t||(e.offset+=s)):e.offset>r.getIndexWithinParent()&&(e.offset-=1)}function ys(e){let t=hs()||fs();null===t&&(t=Tt().selectEnd()),t.insertNodes(e)}function bs(e){e.isCollapsed()||e.removeText();const t=e.anchor;let n=t.getNode(),r=t.offset;for(;!fn(n);)[n,r]=ws(n,r);return r}function ws(e,t){const n=e.getParent();if(!n){const e=to();return Tt().append(e),e.select(),[Tt(),0]}if(Ur(e)){const r=e.splitText(t);if(0===r.length)return[n,e.getIndexWithinParent()];const s=0===t?0:1;return[n,r[0].getIndexWithinParent()+s]}if(!Js(e)||0===t)return[n,e.getIndexWithinParent()];const r=e.getChildAtIndex(t);if(r){const n=new Qr(Jr(e.__key,t,"element"),Jr(e.__key,t,"element"),0,""),s=e.insertNewAfter(n);s&&s.append(r,...r.getNextSiblings())}return[n,e.getIndexWithinParent()+1]}let xs=null,vs=null,Ss=!1,Cs=!1,ks=0;const Es={characterData:!0,childList:!0,subtree:!0};function Ts(){return Ss||null!==xs&&xs._readOnly}function Ns(){Ss&&re(13)}function Rs(){ks>99&&re(14)}function As(){return null===xs&&re(15),xs}function Os(){return null===vs&&re(16),vs}function Fs(e,t,n){const r=t.__type,s=function(e,t){const n=e._nodes.get(t);return void 0===n&&re(30,t),n}(e,r);let o=n.get(r);void 0===o&&(o=Array.from(s.transforms),n.set(r,o));const i=o.length;for(let l=0;l<i&&(o[l](t),t.isAttached());l++);}function Ds(e,t){return void 0!==e&&e.__key!==t&&e.isAttached()}function Ps(e){return Ls(e,Os()._nodes)}function Ls(e,t){const n=e.type,r=t.get(n);void 0===r&&re(17,n);const s=r.klass;e.type!==s.getType()&&re(18,s.name);const o=s.importJSON(e),i=e.children;if(Js(o)&&Array.isArray(i))for(let l=0;l<i.length;l++){const e=Ls(i[l],t);o.append(e)}return o}function Is(e,t){const n=xs,r=Ss,s=vs;xs=e,Ss=!0,vs=null;try{return t()}finally{xs=n,Ss=r,vs=s}}function Ms(e,t){const n=e._pendingEditorState,r=e._rootElement,s=e._headless||null===r;if(null===n)return;const o=e._editorState,i=o._selection,l=n._selection,a=e._dirtyType!==_e,c=xs,u=Ss,d=vs,f=e._updating,g=e._observer;let p=null;if(e._pendingEditorState=null,e._editorState=n,!s&&a&&null!==g){vs=e,xs=n,Ss=!1,e._updating=!0;try{const t=e._dirtyType,r=e._dirtyElements,s=e._dirtyLeaves;g.disconnect(),p=function(e,t,n,r,s,o){En="",Rn="",Tn="",An=r===be,Fn=null,_n=n,mn=n._config,yn=n._nodes,bn=_n._listeners.mutation,wn=s,xn=o,vn=e._nodeMap,Sn=t._nodeMap,On=t._readOnly,Cn=new Map(n._keyToDOMMap);const i=new Map;return kn=i,Hn("root",null),_n=void 0,yn=void 0,wn=void 0,xn=void 0,vn=void 0,Sn=void 0,mn=void 0,Cn=void 0,kn=void 0,i}(o,n,e,t,r,s)}catch(S){if(S instanceof Error&&e._onError(S),Cs)throw S;return ao(e,null,r,n),tt(e),e._dirtyType=be,Cs=!0,Ms(e,o),void(Cs=!1)}finally{g.observe(r,Es),e._updating=f,xs=c,Ss=u,vs=d}}n._readOnly||(n._readOnly=!0);const m=e._dirtyLeaves,_=e._dirtyElements,y=e._normalizedNodes,b=e._updateTags,w=e._deferred;a&&(e._dirtyType=_e,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),function(e,t){const n=e._decorators;let r=e._pendingDecorators||n;const s=t._nodeMap;let o;for(o in r)s.has(o)||(r===n&&(r=kt(e)),delete r[o])}(e,n);const x=s?null:cn(e._window);if(e._editable&&null!==x&&(a||null===l||l.dirty)){vs=e,xs=n;try{if(null!==g&&g.disconnect(),a||null===l||l.dirty){const t=e._blockCursorElement;null!==t&&an(t,e,r),function(e,t,n,r,s,o,i){const l=r.anchorNode,a=r.focusNode,c=r.anchorOffset,u=r.focusOffset,d=document.activeElement;if(s.has("collaboration")&&d!==o||null!==d&&ct(d))return;if(!Gr(t))return void(null!==e&&ut(n,l,a)&&r.removeAllRanges());const h=t.anchor,f=t.focus,g=h.key,p=f.key,m=Qt(n,g),_=Qt(n,p),y=h.offset,b=f.offset,w=t.format,x=t.style,v=t.isCollapsed();let S=m,C=_,k=!1;if("text"===h.type){S=gt(m);const e=h.getNode();k=e.getFormat()!==w||e.getStyle()!==x}else Gr(e)&&"text"===e.anchor.type&&(k=!0);var E,T,N,R,A;if("text"===f.type&&(C=gt(_)),null!==S&&null!==C&&(v&&(null===e||k||Gr(e)&&(e.format!==w||e.style!==x))&&(E=w,T=x,N=y,R=g,A=performance.now(),ir=[E,T,N,R,A]),c!==y||u!==b||l!==S||a!==C||"Range"===r.type&&v||(null!==d&&o.contains(d)||o.focus({preventScroll:!0}),"element"===h.type))){try{r.setBaseAndExtent(S,y,C,b)}catch(O){}if(!s.has("skip-scroll-into-view")&&t.isCollapsed()&&null!==o&&o===document.activeElement){const e=t instanceof Qr&&"element"===t.anchor.type?S.childNodes[y]||null:r.rangeCount>0?r.getRangeAt(0):null;if(null!==e){let t;if(e instanceof Text){const n=document.createRange();n.selectNode(e),t=n.getBoundingClientRect()}else t=e.getBoundingClientRect();!function(e,t,n){const r=n.ownerDocument,s=r.defaultView;if(null===s)return;let{top:o,bottom:i}=t,l=0,a=0,c=n;for(;null!==c;){const t=c===r.body;if(t)l=0,a=nn(e).innerHeight;else{const e=c.getBoundingClientRect();l=e.top,a=e.bottom}let n=0;if(o<l?n=-(l-o):i>a&&(n=i-a),0!==n)if(t)s.scrollBy(0,n);else{const e=c.scrollTop;c.scrollTop+=n;const t=c.scrollTop-e;o-=t,i-=t}if(t)break;c=en(c)}}(n,t,o)}}nr=!0}}(i,l,e,x,b,r)}(function(e,t,n){let r=e._blockCursorElement;if(Gr(n)&&n.isCollapsed()&&"element"===n.anchor.type&&t.contains(document.activeElement)){const s=n.anchor,o=s.getNode(),i=s.offset;let l=!1,a=null;if(i===o.getChildrenSize())ln(o.getChildAtIndex(i-1))&&(l=!0);else{const t=o.getChildAtIndex(i);if(ln(t)){const n=t.getPreviousSibling();(null===n||ln(n))&&(l=!0,a=e.getElementByKey(t.__key))}}if(l){const n=e.getElementByKey(o.__key);return null===r&&(e._blockCursorElement=r=function(e){const t=e.theme,n=document.createElement("div");n.contentEditable="false",n.setAttribute("data-lexical-cursor","true");let r=t.blockCursor;if(void 0!==r){if("string"==typeof r){const e=He(r);r=t.blockCursor=e}void 0!==r&&n.classList.add(...r)}return n}(e._config)),t.style.caretColor="transparent",void(null===a?n.appendChild(r):n.insertBefore(r,a))}}null!==r&&an(r,e,t)})(e,r,l),null!==g&&g.observe(r,Es)}finally{vs=d,xs=c}}null!==p&&function(e,t,n,r,s){const o=Array.from(e._listeners.mutation),i=o.length;for(let l=0;l<i;l++){const[e,i]=o[l],a=t.get(i);void 0!==a&&e(a,{dirtyLeaves:r,prevEditorState:s,updateTags:n})}}(e,p,b,m,o),Gr(l)||null===l||null!==i&&i.is(l)||e.dispatchCommand(h,void 0);const v=e._pendingDecorators;null!==v&&(e._decorators=v,e._pendingDecorators=null,Bs("decorator",e,!0,v)),function(e,t,n){const r=Et(t),s=Et(n);r!==s&&Bs("textcontent",e,!0,s)}(e,t||o,n),Bs("update",e,!0,{dirtyElements:_,dirtyLeaves:m,editorState:n,normalizedNodes:y,prevEditorState:t||o,tags:b}),function(e,t){if(e._deferred=[],0!==t.length){const n=e._updating;e._updating=!0;try{for(let e=0;e<t.length;e++)t[e]()}finally{e._updating=n}}}(e,w),function(e){const t=e._updates;if(0!==t.length){const n=t.shift();if(n){const[t,r]=n;Us(e,t,r)}}}(e)}function Bs(e,t,n,...r){const s=t._updating;t._updating=n;try{const n=Array.from(t._listeners[e]);for(let e=0;e<n.length;e++)n[e].apply(null,r)}finally{t._updating=s}}function zs(e,t,n){if(!1===e._updating||vs!==e){let r=!1;return e.update((()=>{r=zs(e,t,n)})),r}const r=Dt(e);for(let s=4;s>=0;s--)for(let o=0;o<r.length;o++){const i=r[o]._commands.get(t);if(void 0!==i){const t=i[s];if(void 0!==t){const r=Array.from(t),s=r.length;for(let t=0;t<s;t++)if(!0===r[t](n,e))return!0}}}return!1}function $s(e,t){const n=e._updates;let r=t||!1;for(;0!==n.length;){const t=n.shift();if(t){const[n,s]=t;let o,i;void 0!==s&&(o=s.onUpdate,i=s.tag,s.skipTransforms&&(r=!0),o&&e._deferred.push(o),i&&e._updateTags.add(i)),n()}}return r}function Us(e,t,n){const r=e._updateTags;let s,o,i=!1,l=!1;void 0!==n&&(s=n.onUpdate,o=n.tag,null!=o&&r.add(o),i=n.skipTransforms||!1,l=n.discrete||!1),s&&e._deferred.push(s);const a=e._editorState;let c=e._pendingEditorState,u=!1;(null===c||c._readOnly)&&(c=e._pendingEditorState=new Gs(new Map((c||a)._nodeMap)),u=!0),c._flushSync=l;const d=xs,h=Ss,f=vs,g=e._updating;xs=c,Ss=!1,e._updating=!0,vs=e;try{u&&(e._headless?null!==a._selection&&(c._selection=a._selection.clone()):c._selection=function(e){const t=e.getEditorState()._selection,n=cn(e._window);return Gr(t)||null==t?ds(t,n,e,null):t.clone()}(e));const n=e._compositionKey;t(),i=$s(e,i),function(e,t){const n=t.getEditorState()._selection,r=e._selection;if(Gr(r)){const e=r.anchor,t=r.focus;let s;if("text"===e.type&&(s=e.getNode(),s.selectionTransform(n,r)),"text"===t.type){const e=t.getNode();s!==e&&e.selectionTransform(n,r)}}}(c,e),e._dirtyType!==_e&&(i?function(e,t){const n=t._dirtyLeaves,r=e._nodeMap;for(const s of n){const e=r.get(s);Ur(e)&&e.isAttached()&&e.isSimpleText()&&!e.isUnmergeable()&&st(e)}}(c,e):function(e,t){const n=t._dirtyLeaves,r=t._dirtyElements,s=e._nodeMap,o=xt(),i=new Map;let l=n,a=l.size,c=r,u=c.size;for(;a>0||u>0;){if(a>0){t._dirtyLeaves=new Set;for(const e of l){const r=s.get(e);Ur(r)&&r.isAttached()&&r.isSimpleText()&&!r.isUnmergeable()&&st(r),void 0!==r&&Ds(r,o)&&Fs(t,r,i),n.add(e)}if(l=t._dirtyLeaves,a=l.size,a>0){ks++;continue}}t._dirtyLeaves=new Set,t._dirtyElements=new Map;for(const e of c){const n=e[0],l=e[1];if("root"!==n&&!l)continue;const a=s.get(n);void 0!==a&&Ds(a,o)&&Fs(t,a,i),r.set(n,l)}l=t._dirtyLeaves,a=l.size,c=t._dirtyElements,u=c.size,ks++}t._dirtyLeaves=n,t._dirtyElements=r}(c,e),$s(e),function(e,t,n,r){const s=e._nodeMap,o=t._nodeMap,i=[];for(const[l]of r){const e=o.get(l);void 0!==e&&(e.isAttached()||(Js(e)&&pn(e,l,s,o,i,r),s.has(l)||r.delete(l),i.push(l)))}for(const l of i)o.delete(l);for(const l of n){const e=o.get(l);void 0===e||e.isAttached()||(s.has(l)||n.delete(l),o.delete(l))}}(a,c,e._dirtyLeaves,e._dirtyElements)),n!==e._compositionKey&&(c._flushSync=!0);const r=c._selection;if(Gr(r)){const e=c._nodeMap,t=r.anchor.key,n=r.focus.key;void 0!==e.get(t)&&void 0!==e.get(n)||re(19)}else es(r)&&0===r._nodes.size&&(c._selection=null)}catch(p){return p instanceof Error&&e._onError(p),e._pendingEditorState=a,e._dirtyType=be,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Ms(e)}finally{xs=d,Ss=h,vs=f,e._updating=g,ks=0}e._dirtyType!==_e||function(e,t){const n=t.getEditorState()._selection,r=e._selection;if(null!==r){if(r.dirty||!r.is(n))return!0}else if(null!==n)return!0;return!1}(c,e)?c._flushSync?(c._flushSync=!1,Ms(e)):u&&at((()=>{Ms(e)})):(c._flushSync=!1,u&&(r.clear(),e._deferred=[],e._pendingEditorState=null))}function Ks(e,t,n){e._updating?e._updates.push([t,n]):Us(e,t,n)}class Ws extends yr{constructor(e){super(e)}decorate(e,t){re(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function js(e){return e instanceof Ws}class Hs extends yr{constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__indent=0,this.__dir=null}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return Ke[e]||""}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let t=this.getFirstChild();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getChildrenKeys(){const e=[];let t=this.getFirstChild();for(;null!==t;)e.push(t.__key),t=t.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return 0===this.getChildrenSize()}isDirty(){const e=Os()._dirtyElements;return null!==e&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),t=this.getParentOrThrow().getLastChild();return null!==t&&t.is(e)}getAllTextNodes(){const e=[];let t=this.getFirstChild();for(;null!==t;){if(Ur(t)&&e.push(t),Js(t)){const n=t.getAllTextNodes();e.push(...n)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;Js(e);){const t=e.getFirstChild();if(null===t)break;e=t}return e}getLastDescendant(){let e=this.getLastChild();for(;Js(e);){const t=e.getLastChild();if(null===t)break;e=t}return e}getDescendantByIndex(e){const t=this.getChildren(),n=t.length;if(e>=n){const e=t[n-1];return Js(e)&&e.getLastDescendant()||e||null}const r=t[e];return Js(r)&&r.getFirstDescendant()||r||null}getFirstChild(){const e=this.getLatest().__first;return null===e?null:vt(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return null===e&&re(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return null===e?null:vt(e)}getLastChildOrThrow(){const e=this.getLastChild();return null===e&&re(96,this.__key),e}getChildAtIndex(e){const t=this.getChildrenSize();let n,r;if(e<t/2){for(n=this.getFirstChild(),r=0;null!==n&&r<=e;){if(r===e)return n;n=n.getNextSibling(),r++}return null}for(n=this.getLastChild(),r=t-1;null!==n&&r>=e;){if(r===e)return n;n=n.getPreviousSibling(),r--}return null}getTextContent(){let e="";const t=this.getChildren(),n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=s.getTextContent(),Js(s)&&r!==n-1&&!s.isInline()&&(e+=De)}return e}getTextContentSize(){let e=0;const t=this.getChildren(),n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=s.getTextContentSize(),Js(s)&&r!==n-1&&!s.isInline()&&(e+=De.length)}return e}getDirection(){return this.getLatest().__dir}hasFormat(e){if(""!==e){const t=Ue[e];return!!(this.getFormat()&t)}return!1}select(e,t){Ns();const n=hs();let r=e,s=t;const o=this.getChildrenSize();if(!this.canBeEmpty())if(0===e&&0===t){const e=this.getFirstChild();if(Ur(e)||Js(e))return e.select(0,0)}else if(!(void 0!==e&&e!==o||void 0!==t&&t!==o)){const e=this.getLastChild();if(Ur(e)||Js(e))return e.select()}void 0===r&&(r=o),void 0===s&&(s=o);const i=this.__key;return Gr(n)?(n.anchor.set(i,r,"element"),n.focus.set(i,s,"element"),n.dirty=!0,n):as(i,r,i,s,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach((e=>e.remove())),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const t=this.getWritable();return t.__dir=e,t}setFormat(e){return this.getWritable().__format=""!==e?Ue[e]:0,this}setIndent(e){return this.getWritable().__indent=e,this}splice(e,t,n){const r=n.length,s=this.getChildrenSize(),o=this.getWritable(),i=o.__key,l=[],a=[],c=this.getChildAtIndex(e+t);let u=null,d=s-t+r;if(0!==e)if(e===s)u=this.getLastChild();else{const t=this.getChildAtIndex(e);null!==t&&(u=t.getPreviousSibling())}if(t>0){let e=null===u?this.getFirstChild():u.getNextSibling();for(let n=0;n<t;n++){null===e&&re(100);const t=e.getNextSibling(),n=e.__key;yt(e.getWritable()),a.push(n),e=t}}let h=u;for(let f=0;f<r;f++){const e=n[f];null!==h&&e.is(h)&&(u=h=h.getPreviousSibling());const t=e.getWritable();t.__parent===i&&d--,yt(t);const r=e.__key;if(null===h)o.__first=r,t.__prev=null;else{const e=h.getWritable();e.__next=r,t.__prev=e.__key}e.__key===i&&re(76),t.__parent=i,l.push(r),h=e}if(e+t===s)null!==h&&(h.getWritable().__next=null,o.__last=h.__key);else if(null!==c){const e=c.getWritable();if(null!==h){const t=h.getWritable();e.__prev=h.__key,t.__next=c.__key}else e.__prev=null}if(o.__size=d,a.length){const e=hs();if(Gr(e)){const t=new Set(a),n=new Set(l),{anchor:r,focus:s}=e;Vs(r,t,n)&&ms(r,r.getNode(),this,u,c),Vs(s,t,n)&&ms(s,s.getNode(),this,u,c),0!==d||this.canBeEmpty()||rn(this)||this.remove()}}return o}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"element",version:1}}insertNewAfter(e,t){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,t,n){return!1}}function Js(e){return e instanceof Hs}function Vs(e,t,n){let r=e.getNode();for(;r;){const e=r.__key;if(t.has(e)&&!n.has(e))return!0;r=r.getParent()}return!1}class Ys extends Hs{static getType(){return"root"}static clone(){return new Ys}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){re(51)}getTextContent(){const e=this.__cachedText;return!Ts()&&Os()._dirtyType!==_e||null===e?super.getTextContent():e}remove(){re(52)}replace(e){re(53)}insertBefore(e){re(54)}insertAfter(e){re(55)}updateDOM(e,t){return!1}append(...e){for(let t=0;t<e.length;t++){const n=e[t];Js(n)||js(n)||re(56)}return super.append(...e)}static importJSON(e){const t=Tt();return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"root",version:1}}collapseAtStart(){return!0}}function Zs(e){return e instanceof Ys}function Xs(){return new Gs(new Map([["root",new Ys]]))}function qs(e){const t=e.exportJSON(),n=e.constructor;if(t.type!==n.getType()&&re(130,n.name),Js(e)){const r=t.children;Array.isArray(r)||re(59,n.name);const s=e.getChildren();for(let e=0;e<s.length;e++){const t=qs(s[e]);r.push(t)}}return t}class Gs{constructor(e,t){this._nodeMap=e,this._selection=t||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return 1===this._nodeMap.size&&null===this._selection}read(e){return Is(this,e)}clone(e){const t=new Gs(this._nodeMap,void 0===e?this._selection:e);return t._readOnly=!0,t}toJSON(){return Is(this,(()=>({root:qs(Tt())})))}}class Qs extends Hs{constructor(e){super(e),this.__textFormat=0}static getType(){return"paragraph"}getTextFormat(){return this.getLatest().__textFormat}setTextFormat(e){const t=this.getWritable();return t.__textFormat=e,t}hasTextFormat(e){const t=ze[e];return!!(this.getTextFormat()&t)}static clone(e){return new Qs(e.__key)}createDOM(e){const t=document.createElement("p"),n=Jt(e.theme,"paragraph");return void 0!==n&&t.classList.add(...n),t}updateDOM(e,t,n){return!1}static importDOM(){return{p:e=>({conversion:eo,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&hn(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();n&&(t.dir=n);const r=this.getIndent();r>0&&(t.style.textIndent=20*r+"px")}return{element:t}}static importJSON(e){const t=to();return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t.setTextFormat(e.textFormat),t}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),type:"paragraph",version:1}}insertNewAfter(e,t){const n=to();n.setTextFormat(e.format);const r=this.getDirection();return n.setDirection(r),n.setFormat(this.getFormatType()),this.insertAfter(n,t),n}collapseAtStart(){const e=this.getChildren();if(0===e.length||Ur(e[0])&&""===e[0].getTextContent().trim()){if(null!==this.getNextSibling())return this.selectNext(),this.remove(),!0;if(null!==this.getPreviousSibling())return this.selectPrevious(),this.remove(),!0}return!1}}function eo(e){const t=to();if(e.style){t.setFormat(e.style.textAlign);const n=parseInt(e.style.textIndent,10)/20;n>0&&t.setIndent(n)}return{node:t}}function to(){return sn(new Qs)}function no(e){return e instanceof Qs}const ro=0,so=1,oo=2,io=3,lo=4;function ao(e,t,n,r){const s=e._keyToDOMMap;s.clear(),e._editorState=Xs(),e._pendingEditorState=r,e._compositionKey=null,e._dirtyType=_e,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const o=e._observer;null!==o&&(o.disconnect(),e._observer=null),null!==t&&(t.textContent=""),null!==n&&(n.textContent="",s.set("root",n))}function co(e){const t=e||{},n=vs,r=t.theme||{},s=void 0===e?n:t.parentEditor||null,o=t.disableEvents||!1,i=Xs(),l=t.namespace||(null!==s?s._config.namespace:Pt()),a=t.editorState,c=[Ys,Ar,br,Kr,Qs,...t.nodes||[]],{onError:u,html:d}=t,h=void 0===t.editable||t.editable;let f;if(void 0===e&&null!==n)f=n._nodes;else{f=new Map;for(let e=0;e<c.length;e++){let t=c[e],n=null,r=null;if("function"!=typeof t){const e=t;t=e.replace,n=e.with,r=e.withKlass||null}const s=t.getType(),o=t.transform(),i=new Set;null!==o&&i.add(o),f.set(s,{exportDOM:d&&d.export?d.export.get(t):void 0,klass:t,replace:n,replaceWithKlass:r,transforms:i})}}const g=new uo(i,s,f,{disableEvents:o,namespace:l,theme:r},u||console.error,function(e,t){const n=new Map,r=new Set,s=e=>{Object.keys(e).forEach((t=>{let r=n.get(t);void 0===r&&(r=[],n.set(t,r)),r.push(e[t])}))};return e.forEach((e=>{const t=e.klass.importDOM;if(null==t||r.has(t))return;r.add(t);const n=t.call(e.klass);null!==n&&s(n)})),t&&s(t),n}(f,d?d.import:void 0),h);return void 0!==a&&(g._pendingEditorState=a,g._dirtyType=be),g}class uo{constructor(e,t,n,r,s,o,i){this._parentEditor=t,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=r,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=_e,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=Pt(),this._onError=s,this._htmlConversions=o,this._editable=i,this._headless=null!==t&&t._headless,this._window=null,this._blockCursorElement=null}isComposing(){return null!=this._compositionKey}registerUpdateListener(e){const t=this._listeners.update;return t.add(e),()=>{t.delete(e)}}registerEditableListener(e){const t=this._listeners.editable;return t.add(e),()=>{t.delete(e)}}registerDecoratorListener(e){const t=this._listeners.decorator;return t.add(e),()=>{t.delete(e)}}registerTextContentListener(e){const t=this._listeners.textcontent;return t.add(e),()=>{t.delete(e)}}registerRootListener(e){const t=this._listeners.root;return e(this._rootElement,null),t.add(e),()=>{e(null,this._rootElement),t.delete(e)}}registerCommand(e,t,n){void 0===n&&re(35);const r=this._commands;r.has(e)||r.set(e,[new Set,new Set,new Set,new Set,new Set]);const s=r.get(e);void 0===s&&re(36,String(e));const o=s[n];return o.add(t),()=>{o.delete(t),s.every((e=>0===e.size))&&r.delete(e)}}registerMutationListener(e,t){void 0===this._nodes.get(e.getType())&&re(37,e.name);const n=this._listeners.mutation;return n.set(t,e),()=>{n.delete(t)}}registerNodeTransformToKlass(e,t){const n=e.getType(),r=this._nodes.get(n);return void 0===r&&re(37,e.name),r.transforms.add(t),r}registerNodeTransform(e,t){const n=this.registerNodeTransformToKlass(e,t),r=[n],s=n.replaceWithKlass;if(null!=s){const e=this.registerNodeTransformToKlass(s,t);r.push(e)}var o;return this,o=e.getType(),Ks(this,(()=>{const e=As();if(e.isEmpty())return;if("root"===o)return void Tt().markDirty();const t=e._nodeMap;for(const[,n]of t)n.markDirty()}),null===this._pendingEditorState?{tag:"history-merge"}:void 0),()=>{r.forEach((e=>e.transforms.delete(t)))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return qt(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const t=this._rootElement;if(e!==t){const n=Jt(this._config.theme,"root"),r=this._pendingEditorState||this._editorState;if(this._rootElement=e,ao(this,t,e,r),null!==t&&(this._config.disableEvents||function(e){const t=e.ownerDocument,n=tr.get(t);if(void 0===n)throw Error("Root element not registered");tr.set(t,n-1),0===tr.get(t)&&t.removeEventListener("selectionchange",gr);const r=e.__lexicalEditor;null!=r&&(function(e){if(null!==e._parentEditor){const t=Dt(e),n=t[t.length-1]._key;fr.get(n)===e&&fr.delete(n)}else fr.delete(e._key)}(r),e.__lexicalEditor=null);const s=hr(e);for(let o=0;o<s.length;o++)s[o]();e.__lexicalEventHandles=[]}(t),null!=n&&t.classList.remove(...n)),null!==e){const t=function(e){const t=e.ownerDocument;return t&&t.defaultView||null}(e),r=e.style;r.userSelect="text",r.whiteSpace="pre-wrap",r.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=t,this._dirtyType=be,tt(this),this._updateTags.add("history-merge"),Ms(this),this._config.disableEvents||function(e,t){const n=e.ownerDocument,r=tr.get(n);(void 0===r||r<1)&&n.addEventListener("selectionchange",gr),tr.set(n,r||1),e.__lexicalEditor=t;const s=hr(e);for(let o=0;o<Xn.length;o++){const[n,r]=Xn[o],i="function"==typeof r?e=>{mr(e)||(pr(e),(t.isEditable()||"click"===n)&&r(e,t))}:e=>{if(!mr(e)&&(pr(e),t.isEditable()))switch(n){case"cut":return qt(t,Y,e);case"copy":return qt(t,V,e);case"paste":return qt(t,b,e);case"dragstart":return qt(t,j,e);case"dragover":return qt(t,H,e);case"dragend":return qt(t,J,e);case"focus":return qt(t,ee,e);case"blur":return qt(t,te,e);case"drop":return qt(t,K,e)}};e.addEventListener(n,i),s.push((()=>{e.removeEventListener(n,i)}))}}(e,this),null!=n&&e.classList.add(...n)}else this._editorState=r,this._pendingEditorState=null,this._window=null;Bs("root",this,!1,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,t){e.isEmpty()&&re(38),et(this);const n=this._pendingEditorState,r=this._updateTags,s=void 0!==t?t.tag:null;null===n||n.isEmpty()||(null!=s&&r.add(s),Ms(this)),this._pendingEditorState=e,this._dirtyType=be,this._dirtyElements.set("root",!1),this._compositionKey=null,null!=s&&r.add(s),Ms(this)}parseEditorState(e,t){return function(e,t,n){const r=Xs(),s=xs,o=Ss,i=vs,l=t._dirtyElements,a=t._dirtyLeaves,c=t._cloneNotNeeded,u=t._dirtyType;t._dirtyElements=new Map,t._dirtyLeaves=new Set,t._cloneNotNeeded=new Set,t._dirtyType=0,xs=r,Ss=!1,vs=t;try{const s=t._nodes;Ls(e.root,s),n&&n(),r._readOnly=!0}catch(d){d instanceof Error&&t._onError(d)}finally{t._dirtyElements=l,t._dirtyLeaves=a,t._cloneNotNeeded=c,t._dirtyType=u,xs=s,Ss=o,vs=i}return r}("string"==typeof e?JSON.parse(e):e,this,t)}update(e,t){Ks(this,e,t)}focus(e,t={}){const n=this._rootElement;null!==n&&(n.setAttribute("autocapitalize","off"),Ks(this,(()=>{const e=hs(),n=Tt();null!==e?e.dirty=!0:0!==n.getChildrenSize()&&("rootStart"===t.defaultSelection?n.selectStart():n.selectEnd())}),{onUpdate:()=>{n.removeAttribute("autocapitalize"),e&&e()},tag:"focus"}),null===this._pendingEditorState&&n.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;null!==e&&e.blur();const t=cn(this._window);null!==t&&t.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,Bs("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}const ho=new Map;function fo(e){let t=e;for(;null!=t;){if(t.nodeType===Node.TEXT_NODE)return t;t=t.firstChild}return null}function go(e){const t=e.parentNode;if(null==t)throw new Error("Should never happen");return[t,Array.from(t.childNodes).indexOf(e)]}function po(e,t,n,r,s){const o=t.getKey(),i=r.getKey(),l=document.createRange();let a=e.getElementByKey(o),c=e.getElementByKey(i),u=n,d=s;if(Ur(t)&&(a=fo(a)),Ur(r)&&(c=fo(c)),void 0===t||void 0===r||null===a||null===c)return null;"BR"===a.nodeName&&([a,u]=go(a)),"BR"===c.nodeName&&([c,d]=go(c));const h=a.firstChild;a===c&&null!=h&&"BR"===h.nodeName&&0===u&&0===d&&(d=1);try{l.setStart(a,u),l.setEnd(c,d)}catch(f){return null}return!l.collapsed||u===d&&o===i||(l.setStart(c,d),l.setEnd(a,u)),l}function mo(e,t){const n=e.getRootElement();if(null===n)return[];const r=n.getBoundingClientRect(),s=getComputedStyle(n),o=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),i=Array.from(t.getClientRects());let l,a=i.length;i.sort(((e,t)=>{const n=e.top-t.top;return Math.abs(n)<=3?e.left-t.left:n}));for(let c=0;c<a;c++){const e=i[c],t=l&&l.top<=e.top&&l.top+l.height>e.top&&l.left+l.width>e.left,n=e.width+o===r.width;t||n?(i.splice(c--,1),a--):l=e}return i}function _o(e){const t={},n=e.split(";");for(const r of n)if(""!==r){const[e,n]=r.split(/:([^]+)/);e&&n&&(t[e.trim()]=n.trim())}return t}function yo(e){let t=ho.get(e);return void 0===t&&(t=_o(e),ho.set(e,t)),t}function bo(e){const t=e.constructor.clone(e);return t.__parent=e.__parent,t.__next=e.__next,t.__prev=e.__prev,Js(e)&&Js(t)?(o=e,(s=t).__first=o.__first,s.__last=o.__last,s.__size=o.__size,s.__format=o.__format,s.__indent=o.__indent,s.__dir=o.__dir,s):Ur(e)&&Ur(t)?(r=e,(n=t).__format=r.__format,n.__style=r.__style,n.__mode=r.__mode,n.__detail=r.__detail,n):no(e)&&no(t)?function(e,t){return e.__textFormat=t.__textFormat,e}(t,e):t;var n,r,s,o}function wo(e,t){const n=e.getStartEndPoints();if(t.isSelected(e)&&!t.isSegmented()&&!t.isToken()&&null!==n){const[r,s]=n,o=e.isBackward(),i=r.getNode(),l=s.getNode(),a=t.is(i),c=t.is(l);if(a||c){const[n,r]=ns(e),s=i.is(l),a=t.is(o?l:i),c=t.is(o?i:l);let u,d=0;return s?(d=n>r?r:n,u=n>r?n:r):a?(d=o?r:n,u=void 0):c&&(d=0,u=o?n:r),t.__text=t.__text.slice(d,u),t}}return t}function xo(e){if("text"===e.type)return e.offset===e.getNode().getTextContentSize();const t=e.getNode();if(!Js(t))throw Error("isAtNodeEnd: node must be a TextNode or ElementNode");return e.offset===t.getChildrenSize()}function vo(e,t,n){let r=t.getNode(),s=n;if(Js(r)){const e=r.getDescendantByIndex(t.offset);null!==e&&(r=e)}for(;s>0&&null!==r;){if(Js(r)){const e=r.getLastDescendant();null!==e&&(r=e)}let n=r.getPreviousSibling(),o=0;if(null===n){let e=r.getParentOrThrow(),t=e.getPreviousSibling();for(;null===t;){if(e=e.getParent(),null===e){n=null;break}t=e.getPreviousSibling()}null!==e&&(o=e.isInline()?0:2,n=t)}let i=r.getTextContent();""===i&&Js(r)&&!r.isInline()&&(i="\n\n");const l=i.length;if(!Ur(r)||s>=l){const e=r.getParent();r.remove(),null==e||0!==e.getChildrenSize()||Zs(e)||e.remove(),s-=l+o,r=n}else{const n=r.getKey(),o=e.getEditorState().read((()=>{const e=vt(n);return Ur(e)&&e.isSimpleText()?e.getTextContent():null})),a=l-s,c=i.slice(0,a);if(null!==o&&o!==i){const e=fs();let t=r;if(r.isSimpleText())r.setTextContent(o);else{const e=$r(o);r.replace(e),t=e}if(Gr(e)&&e.isCollapsed()){const n=e.anchor.offset;t.select(n,n)}}else if(r.isSimpleText()){const e=t.key===n;let o=t.offset;o<s&&(o=l);const i=e?o-s:0,c=e?o:a;if(e&&0===i){const[e]=r.splitText(i,c);e.remove()}else{const[,e]=r.splitText(i,c);e.remove()}}else{const e=$r(c);r.replace(e)}s=0}}}function So(e){const t=e.getStyle(),n=_o(t);ho.set(t,n)}function Co(e,t){const n=yo("getStyle"in e?e.getStyle():e.style),r=Object.entries(t).reduce(((e,[t,r])=>(r instanceof Function?e[t]=r(n[t]):null===r?delete e[t]:e[t]=r,e)),{...n}),s=function(e){let t="";for(const n in e)n&&(t+=`${n}: ${e[n]};`);return t}(r);e.setStyle(s),ho.set(s,r)}function ko(e,t){const n=e.getNodes(),r=n.length,s=e.getStartEndPoints();if(null===s)return;const[o,i]=s,l=r-1;let a=n[0],c=n[l];if(e.isCollapsed()&&Gr(e))return void Co(e,t);const u=a.getTextContent().length,d=i.offset;let h=o.offset;const f=o.isBefore(i);let g=f?h:d,p=f?d:h;const m=f?o.type:i.type,_=f?i.type:o.type,y=f?i.key:o.key;if(Ur(a)&&g===u){const e=a.getNextSibling();Ur(e)&&(h=0,g=0,a=e)}if(1===n.length){if(Ur(a)&&a.canHaveFormat()){if(g="element"===m?0:h>d?d:h,p="element"===_?u:h>d?h:d,g===p)return;if(0===g&&p===u)Co(a,t),a.select(g,p);else{const e=a.splitText(g,p),n=0===g?e[0]:e[1];Co(n,t),n.select(0,p-g)}}}else{if(Ur(a)&&g<a.getTextContentSize()&&a.canHaveFormat()&&(0!==g&&(a=a.splitText(g)[1],g=0,o.set(a.getKey(),g,"text")),Co(a,t)),Ur(c)&&c.canHaveFormat()){const e=c.getTextContent().length;c.__key!==y&&0!==p&&(p=e),p!==e&&([c]=c.splitText(p)),0===p&&"element"!==_||Co(c,t)}for(let e=1;e<l;e++){const r=n[e],s=r.getKey();Ur(r)&&r.canHaveFormat()&&s!==a.getKey()&&s!==c.getKey()&&!r.isToken()&&Co(r,t)}}}function Eo(e,t){if(null===e)return;const n=e.getStartEndPoints(),r=n?n[0]:null;if(null!==r&&"root"===r.key){const e=t(),n=Tt(),r=n.getFirstChild();return void(r?r.replace(e,!0):n.append(e))}const s=e.getNodes(),o=null!==r&&function(e,t){let n=e;for(;null!==n&&null!==n.getParent()&&!t(n);)n=n.getParentOrThrow();return t(n)?n:null}(r.getNode(),Fo);o&&-1===s.indexOf(o)&&s.push(o);for(let i=0;i<s.length;i++){const e=s[i];if(!Fo(e))continue;if(!Js(e))throw Error("Expected block node to be an ElementNode");const n=t();n.setFormat(e.getFormatType()),n.setIndent(e.getIndent()),e.replace(n,!0)}}function To(e,t){const n=Zt(e.focus,t);return js(n)&&!n.isIsolated()||Js(n)&&!n.isInline()&&!n.canBeEmpty()}function No(e){const t=e.anchor.getNode();return"rtl"===(Zs(t)?t:t.getParentOrThrow()).getDirection()}function Ro(e,t,n){const r=No(e);!function(e,t,n,r){e.modify(t?"extend":"move",n,r)}(e,t,n?!r:r,"character")}function Ao(e,t,n){const r=yo(e.getStyle());return null!==r&&r[t]||n}function Oo(e,t,n=""){let r=null;const s=e.getNodes(),o=e.anchor,i=e.focus,l=e.isBackward(),a=l?i.offset:o.offset,c=l?i.getNode():o.getNode();if(e.isCollapsed()&&""!==e.style){const n=yo(e.style);if(null!==n&&t in n)return n[t]}for(let u=0;u<s.length;u++){const e=s[u];if((0===u||0!==a||!e.is(c))&&Ur(e)){const s=Ao(e,t,n);if(null===r)r=s;else if(r!==s){r="";break}}}return null===r?n:r}function Fo(e){if(js(e))return!1;if(!Js(e)||rn(e))return!1;const t=e.getFirstChild(),n=null===t||vr(t)||Ur(t)||t.isInline();return!e.isInline()&&!1!==e.canBeEmpty()&&n}var Do=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};const Po="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Lo=Po&&"documentMode"in document?document.documentMode:null,Io=Po&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);function Mo(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}function Bo(...e){return()=>{e.forEach((e=>e()))}}function zo(e,...t){const n=Mo(...t);n.length>0&&e.classList.add(...n)}function $o(e,...t){const n=Mo(...t);n.length>0&&e.classList.remove(...n)}function Uo(e,t){for(const n of t)if(e.type.startsWith(n))return!0;return!1}function Ko(e,t){const n=e[Symbol.iterator]();return new Promise(((e,r)=>{const s=[],o=()=>{const{done:i,value:l}=n.next();if(i)return e(s);const a=new FileReader;a.addEventListener("error",r),a.addEventListener("load",(()=>{const e=a.result;"string"==typeof e&&s.push({file:l,result:e}),o()})),Uo(l,t)?a.readAsDataURL(l):o()};o()}))}function Wo(e,t){let n=e;for(;null!=n;){if(n instanceof t)return n;n=n.getParent()}return null}function jo(e){const t=Ho(e,(e=>Js(e)&&!e.isInline()));return Js(t)||Do(4,e.__key),t}Po&&"InputEvent"in window&&!Lo&&new window.InputEvent("input");const Ho=(e,t)=>{let n=e;for(;n!==Tt()&&null!=n;){if(t(n))return n;n=n.getParent()}return null};function Jo(e,t,n,r){const s=e=>e instanceof t;return e.registerNodeTransform(t,(e=>{const t=(e=>{const t=e.getChildren();for(let o=0;o<t.length;o++){const e=t[o];if(s(e))return null}let n=e,r=e;for(;null!==n;)if(r=n,n=n.getParent(),s(n))return{child:r,parent:n};return null})(e);if(null!==t){const{child:s,parent:o}=t;if(s.is(e)){r(o,e);const t=s.getNextSiblings(),i=t.length;if(o.insertAfter(s),0!==i){const e=n(o);s.insertAfter(e);for(let n=0;n<i;n++)e.append(t[n])}o.canBeEmpty()||0!==o.getChildrenSize()||o.remove()}}}))}function Vo(e,t){const n=new Map,r=e._pendingEditorState;for(const[o,i]of t._nodeMap){const e=bo(i);if(Ur(e)){if(!Ur(i))throw Error("Expected node be a TextNode");e.__text=i.__text}n.set(o,e)}r&&(r._nodeMap=n),e._dirtyType=2;const s=t._selection;Rt(null===s?null:s.clone())}function Yo(e){const t=hs()||fs();if(Gr(t)){const{focus:n}=t,r=n.getNode(),s=n.offset;if(rn(r)){const t=r.getChildAtIndex(s);null==t?r.append(e):t.insertBefore(e),e.selectNext()}else{let t,n;Ur(r)?(t=r.getParentOrThrow(),n=r.getIndexWithinParent(),s>0&&(n+=1,r.splitText(s))):(t=r,n=s);const[,o]=un(t,n);o.insertBefore(e),o.selectStart()}}else{if(null!=t){const n=t.getNodes();n[n.length-1].getTopLevelElementOrThrow().insertAfter(e)}else Tt().append(e);const n=to();e.insertAfter(n),n.select()}return e.getLatest()}function Zo(e,t){const n=t();return e.replace(n),n.append(e),n}function Xo(e,t){return null!==e&&Object.getPrototypeOf(e).constructor.name===t.name}function qo(e,t){const n=e.getFirstChild();null!==n?n.insertBefore(t):e.append(t)}function Go(e){if(Io)return 1;let t=1;for(;e;)t*=Number(window.getComputedStyle(e).getPropertyValue("zoom")),e=e.parentElement;return t}const Qo=new Set(["http:","https:","mailto:","sms:","tel:"]);let ei=class e extends Hs{static getType(){return"link"}static clone(t){return new e(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(e,t={},n){super(n);const{target:r=null,rel:s=null,title:o=null}=t;this.__url=e,this.__target=r,this.__rel=s,this.__title=o}createDOM(e){const t=document.createElement("a");return t.href=this.sanitizeUrl(this.__url),null!==this.__target&&(t.target=this.__target),null!==this.__rel&&(t.rel=this.__rel),null!==this.__title&&(t.title=this.__title),zo(t,e.theme.link),t}updateDOM(e,t,n){const r=this.__url,s=this.__target,o=this.__rel,i=this.__title;return r!==e.__url&&(t.href=r),s!==e.__target&&(s?t.target=s:t.removeAttribute("target")),o!==e.__rel&&(o?t.rel=o:t.removeAttribute("rel")),i!==e.__title&&(i?t.title=i:t.removeAttribute("title")),!1}static importDOM(){return{a:e=>({conversion:ti,priority:1})}}static importJSON(e){const t=ni(e.url,{rel:e.rel,target:e.target,title:e.title});return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}sanitizeUrl(e){try{const t=new URL(e);if(!Qo.has(t.protocol))return"about:blank"}catch(t){return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),type:"link",url:this.getURL(),version:1}}getURL(){return this.getLatest().__url}setURL(e){this.getWritable().__url=e}getTarget(){return this.getLatest().__target}setTarget(e){this.getWritable().__target=e}getRel(){return this.getLatest().__rel}setRel(e){this.getWritable().__rel=e}getTitle(){return this.getLatest().__title}setTitle(e){this.getWritable().__title=e}insertNewAfter(e,t=!0){const n=ni(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,t),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,n){if(!Gr(t))return!1;const r=t.anchor.getNode(),s=t.focus.getNode();return this.isParentOf(r)&&this.isParentOf(s)&&t.getTextContent().length>0}};function ti(e){let t=null;if(dn(e)){const n=e.textContent;(null!==n&&""!==n||e.children.length>0)&&(t=ni(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function ni(e,t){return sn(new ei(e,t))}function ri(e){return e instanceof ei}let si=class e extends ei{static getType(){return"autolink"}static clone(t){return new e(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}static importJSON(e){const t=oi(e.url,{rel:e.rel,target:e.target,title:e.title});return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),type:"autolink",version:1}}insertNewAfter(e,t=!0){const n=this.getParentOrThrow().insertNewAfter(e,t);if(Js(n)){const e=oi(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return n.append(e),e}return null}};function oi(e,t){return sn(new si(e,t))}function ii(e){return e instanceof si}const li={};function ai(e,t={}){const{target:n,title:r}=t,s=void 0===t.rel?"noreferrer":t.rel,o=hs();if(!Gr(o))return;const i=o.extract();if(null===e)i.forEach((e=>{const t=e.getParent();if(ri(t)){const e=t.getChildren();for(let n=0;n<e.length;n++)t.insertBefore(e[n]);t.remove()}}));else{if(1===i.length){const t=function(e,t){let n=e;for(;null!==n&&null!==n.getParent()&&!t(n);)n=n.getParentOrThrow();return t(n)?n:null}(i[0],ri);if(null!==t)return t.setURL(e),void 0!==n&&t.setTarget(n),null!==s&&t.setRel(s),void(void 0!==r&&t.setTitle(r))}let t=null,o=null;i.forEach((i=>{const l=i.getParent();if(l!==o&&null!==l&&(!Js(i)||i.isInline())){if(ri(l))return o=l,l.setURL(e),void 0!==n&&l.setTarget(n),null!==s&&o.setRel(s),void(void 0!==r&&o.setTitle(r));if(l.is(t)||(t=l,o=ni(e,{rel:s,target:n,title:r}),ri(l)?null===i.getPreviousSibling()?l.insertBefore(o):l.insertAfter(o):i.insertBefore(o)),ri(i)){if(i.is(o))return;if(null!==o){const e=i.getChildren();for(let t=0;t<e.length;t++)o.append(e[t])}i.remove()}else null!==o&&o.append(i)}}))}}var ci=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};function ui(e){let t=1,n=e.getParent();for(;null!=n;){if(Ni(n)){const e=n.getParent();if(Li(e)){t++,n=e.getParent();continue}ci(40)}return t}return t}function di(e){let t=e.getParent();Li(t)||ci(40);let n=t;for(;null!==n;)n=n.getParent(),Li(n)&&(t=n);return t}function hi(e){let t=[];const n=e.getChildren().filter(Ni);for(let r=0;r<n.length;r++){const e=n[r],s=e.getFirstChild();Li(s)?t=t.concat(hi(s)):t.push(e)}return t}function fi(e){return Ni(e)&&Li(e.getFirstChild())}function gi(e){return Ti().append(e)}function pi(e,t){return Ni(e)&&(0===t.length||1===t.length&&e.is(t[0])&&0===e.getChildrenSize())}function mi(e,t){e.update((()=>{const e=hs();if(null!==e){const n=e.getNodes();if(Gr(e)){const r=e.getStartEndPoints();null===r&&ci(143);const[s]=r,o=s.getNode(),i=o.getParent();if(pi(o,n)){const e=Pi(t);if(rn(i)){o.replace(e);const t=Ti();Js(o)&&(t.setFormat(o.getFormatType()),t.setIndent(o.getIndent())),e.append(t)}else if(Ni(o)){const t=o.getParentOrThrow();_i(e,t.getChildren()),t.replace(e)}return}}const r=new Set;for(let e=0;e<n.length;e++){const s=n[e];if(!Js(s)||!s.isEmpty()||Ni(s)||r.has(s.getKey())){if(mt(s)){let e=s.getParent();for(;null!=e;){const n=e.getKey();if(Li(e)){if(!r.has(n)){const s=Pi(t);_i(s,e.getChildren()),e.replace(s),r.add(n)}break}{const s=e.getParent();if(rn(s)&&!r.has(n)){r.add(n),yi(e,t);break}e=s}}}}else yi(s,t)}}}))}function _i(e,t){e.splice(e.getChildrenSize(),0,t)}function yi(e,t){if(Li(e))return e;const n=e.getPreviousSibling(),r=e.getNextSibling(),s=Ti();if(s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),_i(s,e.getChildren()),Li(n)&&t===n.getListType())return n.append(s),e.remove(),Li(r)&&t===r.getListType()&&(_i(n,r.getChildren()),r.remove()),n;if(Li(r)&&t===r.getListType())return r.getFirstChildOrThrow().insertBefore(s),e.remove(),r;{const n=Pi(t);return n.append(s),e.replace(n),n}}function bi(e,t){const n=e.getLastChild(),r=t.getFirstChild();n&&r&&fi(n)&&fi(r)&&(bi(n.getFirstChild(),r.getFirstChild()),r.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function wi(e){const t=new Set;if(fi(e)||t.has(e.getKey()))return;const n=e.getParent(),r=e.getNextSibling(),s=e.getPreviousSibling();if(fi(r)&&fi(s)){const n=s.getFirstChild();if(Li(n)){n.append(e);const s=r.getFirstChild();Li(s)&&(_i(n,s.getChildren()),r.remove(),t.add(r.getKey()))}}else if(fi(r)){const t=r.getFirstChild();if(Li(t)){const n=t.getFirstChild();null!==n&&n.insertBefore(e)}}else if(fi(s)){const t=s.getFirstChild();Li(t)&&t.append(e)}else if(Li(n)){const t=Ti(),o=Pi(n.getListType());t.append(o),o.append(e),s?s.insertAfter(t):r?r.insertBefore(t):n.append(t)}}function xi(e){if(fi(e))return;const t=e.getParent(),n=t?t.getParent():void 0;if(Li(n?n.getParent():void 0)&&Ni(n)&&Li(t)){const r=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(r))n.insertBefore(e),t.isEmpty()&&n.remove();else if(e.is(s))n.insertAfter(e),t.isEmpty()&&n.remove();else{const r=t.getListType(),s=Ti(),o=Pi(r);s.append(o),e.getPreviousSiblings().forEach((e=>o.append(e)));const i=Ti(),l=Pi(r);i.append(l),_i(l,e.getNextSiblings()),n.insertBefore(s),n.insertAfter(i),n.replace(e)}}}function vi(...e){const t=[];for(const n of e)if(n&&"string"==typeof n)for(const[e]of n.matchAll(/\S+/g))t.push(e);return t}let Si=class e extends Hs{static getType(){return"listitem"}static clone(t){return new e(t.__value,t.__checked,t.__key)}constructor(e,t,n){super(n),this.__value=void 0===e?1:e,this.__checked=t}createDOM(e){const t=document.createElement("li"),n=this.getParent();return Li(n)&&"check"===n.getListType()&&ki(t,this,null),t.value=this.__value,Ci(t,e.theme,this),t}updateDOM(e,t,n){const r=this.getParent();return Li(r)&&"check"===r.getListType()&&ki(t,this,e),t.value=this.__value,Ci(t,n.theme,this),!1}static transform(){return e=>{if(Ni(e)||ci(144),null==e.__checked)return;const t=e.getParent();Li(t)&&"check"!==t.getListType()&&null!=e.getChecked()&&e.setChecked(void 0)}}static importDOM(){return{li:e=>({conversion:Ei,priority:0})}}static importJSON(e){const t=Ti();return t.setChecked(e.checked),t.setValue(e.value),t.setFormat(e.format),t.setDirection(e.direction),t}exportDOM(e){const t=this.createDOM(e._config);return t.style.textAlign=this.getFormatType(),{element:t}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),type:"listitem",value:this.getValue(),version:1}}append(...e){for(let t=0;t<e.length;t++){const n=e[t];if(Js(n)&&this.canMergeWith(n)){const e=n.getChildren();this.append(...e),n.remove()}else super.append(n)}return this}replace(e,t){if(Ni(e))return super.replace(e);this.setIndent(0);const n=this.getParentOrThrow();if(!Li(n))return e;if(n.__first===this.getKey())n.insertBefore(e);else if(n.__last===this.getKey())n.insertAfter(e);else{const t=Pi(n.getListType());let r=this.getNextSibling();for(;r;){const e=r;r=r.getNextSibling(),t.append(e)}n.insertAfter(e),e.insertAfter(t)}return t&&(Js(e)||ci(139),this.getChildren().forEach((t=>{e.append(t)}))),this.remove(),0===n.getChildrenSize()&&n.remove(),e}insertAfter(e,t=!0){const n=this.getParentOrThrow();if(Li(n)||ci(39),Ni(e))return super.insertAfter(e,t);const r=this.getNextSiblings();if(n.insertAfter(e,t),0!==r.length){const s=Pi(n.getListType());r.forEach((e=>s.append(e))),e.insertAfter(s,t)}return e}remove(e){const t=this.getPreviousSibling(),n=this.getNextSibling();super.remove(e),t&&n&&fi(t)&&fi(n)&&(bi(t.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(e,t=!0){const n=Ti(null==this.__checked&&void 0);return this.insertAfter(n,t),n}collapseAtStart(e){const t=to();this.getChildren().forEach((e=>t.append(e)));const n=this.getParentOrThrow(),r=n.getParentOrThrow(),s=Ni(r);if(1===n.getChildrenSize())if(s)n.remove(),r.select();else{n.insertBefore(t),n.remove();const r=e.anchor,s=e.focus,o=t.getKey();"element"===r.type&&r.getNode().is(this)&&r.set(o,r.offset,"element"),"element"===s.type&&s.getNode().is(this)&&s.set(o,s.offset,"element")}else n.insertBefore(t),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(e){this.getWritable().__value=e}getChecked(){return this.getLatest().__checked}setChecked(e){this.getWritable().__checked=e}toggleChecked(){this.setChecked(!this.__checked)}getIndent(){const e=this.getParent();if(null===e)return this.getLatest().__indent;let t=e.getParentOrThrow(),n=0;for(;Ni(t);)t=t.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(e){"number"==typeof e&&e>-1||ci(117);let t=this.getIndent();for(;t!==e;)t<e?(wi(this),t++):(xi(this),t--);return this}canInsertAfter(e){return Ni(e)}canReplaceWith(e){return Ni(e)}canMergeWith(e){return no(e)||Ni(e)}extractWithChild(e,t){if(!Gr(t))return!1;const n=t.anchor.getNode(),r=t.focus.getNode();return this.isParentOf(n)&&this.isParentOf(r)&&this.getTextContent().length===t.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return Pi("bullet")}};function Ci(e,t,n){const r=[],s=[],o=t.list,i=o?o.listitem:void 0;let l;if(o&&o.nested&&(l=o.nested.listitem),void 0!==i&&r.push(...vi(i)),o){const e=n.getParent(),t=Li(e)&&"check"===e.getListType(),i=n.getChecked();t&&!i||s.push(o.listitemUnchecked),t&&i||s.push(o.listitemChecked),t&&r.push(i?o.listitemChecked:o.listitemUnchecked)}if(void 0!==l){const e=vi(l);n.getChildren().some((e=>Li(e)))?r.push(...e):s.push(...e)}s.length>0&&$o(e,...s),r.length>0&&zo(e,...r)}function ki(e,t,n,r){Li(t.getFirstChild())?(e.removeAttribute("role"),e.removeAttribute("tabIndex"),e.removeAttribute("aria-checked")):(e.setAttribute("role","checkbox"),e.setAttribute("tabIndex","-1"),n&&t.__checked===n.__checked||e.setAttribute("aria-checked",t.getChecked()?"true":"false"))}function Ei(e){return{node:Ti(hn(e)&&"true"===e.getAttribute("aria-checked"))}}function Ti(e){return sn(new Si(void 0,e))}function Ni(e){return e instanceof Si}let Ri=class e extends Hs{static getType(){return"list"}static clone(t){const n=t.__listType||Di[t.__tag];return new e(n,t.__start,t.__key)}constructor(e,t,n){super(n);const r=Di[e]||e;this.__listType=r,this.__tag="number"===r?"ol":"ul",this.__start=t}getTag(){return this.__tag}setListType(e){const t=this.getWritable();t.__listType=e,t.__tag="number"===e?"ol":"ul"}getListType(){return this.__listType}getStart(){return this.__start}createDOM(e,t){const n=this.__tag,r=document.createElement(n);return 1!==this.__start&&r.setAttribute("start",String(this.__start)),r.__lexicalListType=this.__listType,Ai(r,e.theme,this),r}updateDOM(e,t,n){return e.__tag!==this.__tag||(Ai(t,n.theme,this),!1)}static transform(){return e=>{if(!Li(e))throw Error("node is not a ListNode");!function(e){const t=e.getNextSibling();Li(t)&&e.getListType()===t.getListType()&&bi(e,t)}(e),function(e){const t="check"!==e.getListType();let n=e.getStart();for(const r of e.getChildren())Ni(r)&&(r.getValue()!==n&&r.setValue(n),t&&null!=r.getChecked()&&r.setChecked(void 0),Li(r.getFirstChild())||n++)}(e)}}static importDOM(){return{ol:e=>({conversion:Fi,priority:0}),ul:e=>({conversion:Fi,priority:0})}}static importJSON(e){const t=Pi(e.listType,e.start);return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportDOM(e){const{element:t}=super.exportDOM(e);return t&&hn(t)&&(1!==this.__start&&t.setAttribute("start",String(this.__start)),"check"===this.__listType&&t.setAttribute("__lexicalListType","check")),{element:t}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag(),type:"list",version:1}}canBeEmpty(){return!1}canIndent(){return!1}append(...e){for(let t=0;t<e.length;t++){const n=e[t];if(Ni(n))super.append(n);else{const e=Ti();if(Li(n))e.append(n);else if(Js(n)){const t=$r(n.getTextContent());e.append(t)}else e.append(n);super.append(e)}}return this}extractWithChild(e){return Ni(e)}};function Ai(e,t,n){const r=[],s=[],o=t.list;if(void 0!==o){const e=o[`${n.__tag}Depth`]||[],t=ui(n)-1,i=t%e.length,l=e[i],a=o[n.__tag];let c;const u=o.nested,d=o.checklist;if(void 0!==u&&u.list&&(c=u.list),void 0!==a&&r.push(a),void 0!==d&&"check"===n.__listType&&r.push(d),void 0!==l){r.push(...vi(l));for(let t=0;t<e.length;t++)t!==i&&s.push(n.__tag+t)}if(void 0!==c){const e=vi(c);t>1?r.push(...e):s.push(...e)}}s.length>0&&$o(e,...s),r.length>0&&zo(e,...r)}function Oi(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(Ni(r)){t.push(r);const e=r.getChildren();e.length>1&&e.forEach((e=>{Li(e)&&t.push(gi(e))}))}else t.push(gi(r))}return t}function Fi(e){const t=e.nodeName.toLowerCase();let n=null;return"ol"===t?n=Pi("number",e.start):"ul"===t&&(n=hn(e)&&"check"===e.getAttribute("__lexicallisttype")?Pi("check"):Pi("bullet")),{after:Oi,node:n}}const Di={ol:"number",ul:"bullet"};function Pi(e,t=1){return sn(new Ri(e,t))}function Li(e){return e instanceof Ri}const Ii={},Mi={},Bi={},zi={};var $i=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};const Ui=React.createContext(null);function Ki(e,t){let n=null;return null!=e&&(n=e[1]),{getTheme:function(){return null!=t?t:null!=n?n.getTheme():null}}}function Wi(){const e=React.useContext(Ui);return null==e&&$i(8),e}const ji="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;var Hi=ji?React.useLayoutEffect:React.useEffect;const Ji={tag:"history-merge"};function Vi({initialConfig:e,children:t}){const n=React.useMemo((()=>{const{theme:t,namespace:n,editor__DEPRECATED:r,nodes:s,onError:o,editorState:i,html:l}=e,a=Ki(null,t);let c=r||null;if(null===c){const r=co({editable:e.editable,html:l,namespace:n,nodes:s,onError:e=>o(e,r),theme:t});!function(e,t){if(null!==t)if(void 0===t)e.update((()=>{const t=Tt();if(t.isEmpty()){const n=to();t.append(n);const r=ji?document.activeElement:null;(null!==hs()||null!==r&&r===e.getRootElement())&&n.select()}}),Ji);else if(null!==t)switch(typeof t){case"string":{const n=e.parseEditorState(t);e.setEditorState(n,Ji);break}case"object":e.setEditorState(t,Ji);break;case"function":e.update((()=>{Tt().isEmpty()&&t(e)}),Ji)}}(r,i),c=r}return[c,a]}),[]);return Hi((()=>{const t=e.editable,[r]=n;r.setEditable(void 0===t||t)}),[]),React.createElement(Ui.Provider,{value:n},t)}function Yi(e,t){if("undefined"==typeof document||"undefined"==typeof window&&void 0===global.window)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const n=document.createElement("div"),r=Tt().getChildren();for(let s=0;s<r.length;s++)Zi(e,r[s],n,t);return n.innerHTML}function Zi(e,t,n,r=null){let s=null===r||t.isSelected(r);const o=Js(t)&&t.excludeFromCopy("html");let i=t;if(null!==r){let e=bo(t);e=Ur(e)&&null!==r?wo(r,e):e,i=e}const l=Js(i)?i.getChildren():[],a=e._nodes.get(i.getType());let c;c=a&&void 0!==a.exportDOM?a.exportDOM(e,i):i.exportDOM(e);const{element:u,after:d}=c;if(!u)return!1;const h=document.createDocumentFragment();for(let f=0;f<l.length;f++){const n=l[f],o=Zi(e,n,h,r);!s&&Js(t)&&o&&t.extractWithChild(n,r,"html")&&(s=!0)}if(s&&!o){if(hn(u)&&u.append(h),n.append(u),d){const e=d.call(i,u);e&&u.replaceWith(e)}}else n.append(h);return s}const Xi=new Set(["STYLE","SCRIPT"]);function qi(e,t,n=new Map,r){let s=[];if(Xi.has(e.nodeName))return s;let o=null;const i=function(e,t){const{nodeName:n}=e,r=t._htmlConversions.get(n.toLowerCase());let s=null;if(void 0!==r)for(const o of r){const t=o(e);null!==t&&(null===s||(s.priority||0)<(t.priority||0))&&(s=t)}return null!==s?s.conversion:null}(e,t),l=i?i(e):null;let a=null;if(null!==l){a=l.after;const t=l.node;if(o=Array.isArray(t)?t[t.length-1]:t,null!==o){for(const[,e]of n)if(o=e(o,r),!o)break;o&&s.push(...Array.isArray(t)?t:[o])}null!=l.forChild&&n.set(e.nodeName,l.forChild)}const c=e.childNodes;let u=[];for(let d=0;d<c.length;d++)u.push(...qi(c[d],t,new Map(n),o));return null!=a&&(u=a(u)),null==o?s=s.concat(u):Js(o)&&o.append(...u),s}var Gi=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};const Qi="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,el=e=>Qi?(e||window).getSelection():null;function tl(e){const t=hs();if(null==t)throw Error("Expected valid LexicalSelection");return Gr(t)&&t.isCollapsed()||0===t.getNodes().length?"":Yi(e,t)}function nl(e){const t=hs();if(null==t)throw Error("Expected valid LexicalSelection");return Gr(t)&&t.isCollapsed()||0===t.getNodes().length?null:JSON.stringify(function(e,t){const n=[],r=Tt().getChildren();for(let s=0;s<r.length;s++)il(e,t,r[s],n);return{namespace:e._config.namespace,nodes:n}}(e,t))}function rl(e,t){const n=e.getData("text/plain")||e.getData("text/uri-list");null!=n&&t.insertRawText(n)}function sl(e,t,n){const r=e.getData("application/x-lexical-editor");if(r)try{const e=JSON.parse(r);if(e.namespace===n._config.namespace&&Array.isArray(e.nodes))return ol(n,function(e){const t=[];for(let n=0;n<e.length;n++){const r=Ps(e[n]);Ur(r)&&So(r),t.push(r)}return t}(e.nodes),t)}catch(i){}const s=e.getData("text/html");if(s)try{return ol(n,function(e,t){const n=t.body?t.body.childNodes:[];let r=[];for(let s=0;s<n.length;s++){const t=n[s];if(!Xi.has(t.nodeName)){const n=qi(t,e);null!==n&&(r=r.concat(n))}}return r}(n,(new DOMParser).parseFromString(s,"text/html")),t)}catch(i){}const o=e.getData("text/plain")||e.getData("text/uri-list");if(null!=o)if(Gr(t)){const e=o.split(/(\r?\n|\t)/);""===e[e.length-1]&&e.pop();for(let n=0;n<e.length;n++){const r=e[n];"\n"===r||"\r\n"===r?t.insertParagraph():"\t"===r?t.insertNodes([Wr()]):t.insertText(r)}}else t.insertRawText(o)}function ol(e,t,n){e.dispatchCommand(f,{nodes:t,selection:n})||n.insertNodes(t)}function il(e,t,n,r=[]){let s=null===t||n.isSelected(t);const o=Js(n)&&n.excludeFromCopy("html");let i=n;if(null!==t){let e=bo(n);e=Ur(e)&&null!==t?wo(t,e):e,i=e}const l=Js(i)?i.getChildren():[],a=function(e){const t=e.exportJSON(),n=e.constructor;if(t.type!==n.getType()&&Gi(58,n.name),Js(e)){const e=t.children;Array.isArray(e)||Gi(59,n.name)}return t}(i);if(Ur(i)){const e=i.__text;e.length>0?a.text=e:s=!1}for(let c=0;c<l.length;c++){const r=l[c],o=il(e,t,r,a.children);!s&&Js(n)&&o&&n.extractWithChild(r,t,"clone")&&(s=!0)}if(s&&!o)r.push(a);else if(Array.isArray(a.children))for(let c=0;c<a.children.length;c++){const e=a.children[c];r.push(e)}return s}let ll=null;async function al(e,t){if(null!==ll)return!1;if(null!==t)return new Promise(((n,r)=>{e.update((()=>{n(cl(e,t))}))}));const n=e.getRootElement(),r=null==e._window?window.document:e._window.document,s=el(e._window);if(null===n||null===s)return!1;const o=r.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(r.createTextNode("#")),n.append(o);const i=new Range;return i.setStart(o,0),i.setEnd(o,1),s.removeAllRanges(),s.addRange(i),new Promise(((t,n)=>{const s=e.registerCommand(V,(n=>(Xo(n,ClipboardEvent)&&(s(),null!==ll&&(window.clearTimeout(ll),ll=null),t(cl(e,n))),!0)),lo);ll=window.setTimeout((()=>{s(),ll=null,t(!1)}),50),r.execCommand("copy"),o.remove()}))}function cl(e,t){const n=el(e._window);if(!n)return!1;const r=n.anchorNode,s=n.focusNode;if(null!==r&&null!==s&&!ut(e,r,s))return!1;t.preventDefault();const o=t.clipboardData,i=hs();if(null===o||null===i)return!1;const l=tl(e),a=nl(e);let c="";return null!==i&&(c=i.getTextContent()),null!==l&&o.setData("text/html",l),null!==a&&o.setData("application/x-lexical-editor",a),o.setData("text/plain",c),!0}function ul(e,t){if(void 0!==document.caretRangeFromPoint){const n=document.caretRangeFromPoint(e,t);return null===n?null:{node:n.startContainer,offset:n.startOffset}}if("undefined"!==document.caretPositionFromPoint){const n=document.caretPositionFromPoint(e,t);return null===n?null:{node:n.offsetNode,offset:n.offset}}return null}const dl="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,hl=dl&&"documentMode"in document?document.documentMode:null,fl=!(!dl||!("InputEvent"in window)||hl)&&"getTargetRanges"in new window.InputEvent("input"),gl=dl&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),pl=dl&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,ml=dl&&/^(?=.*Chrome).*/i.test(navigator.userAgent),_l=dl&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!ml,yl={};let bl=class e extends Hs{static getType(){return"quote"}static clone(t){return new e(t.__key)}constructor(e){super(e)}createDOM(e){const t=document.createElement("blockquote");return zo(t,e.theme.quote),t}updateDOM(e,t){return!1}static importDOM(){return{blockquote:e=>({conversion:kl,priority:0})}}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&hn(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();n&&(t.dir=n)}return{element:t}}static importJSON(e){const t=wl();return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{...super.exportJSON(),type:"quote"}}insertNewAfter(e,t){const n=to(),r=this.getDirection();return n.setDirection(r),this.insertAfter(n,t),n}collapseAtStart(){const e=to();return this.getChildren().forEach((t=>e.append(t))),this.replace(e),!0}};function wl(){return sn(new bl)}function xl(e){return e instanceof bl}let vl=class e extends Hs{static getType(){return"heading"}static clone(t){return new e(t.__tag,t.__key)}constructor(e,t){super(t),this.__tag=e}getTag(){return this.__tag}createDOM(e){const t=this.__tag,n=document.createElement(t),r=e.theme.heading;if(void 0!==r){zo(n,r[t])}return n}updateDOM(e,t){return!1}static importDOM(){return{h1:e=>({conversion:Cl,priority:0}),h2:e=>({conversion:Cl,priority:0}),h3:e=>({conversion:Cl,priority:0}),h4:e=>({conversion:Cl,priority:0}),h5:e=>({conversion:Cl,priority:0}),h6:e=>({conversion:Cl,priority:0}),p:e=>{const t=e.firstChild;return null!==t&&Sl(t)?{conversion:()=>({node:null}),priority:3}:null},span:e=>Sl(e)?{conversion:e=>({node:El("h1")}),priority:3}:null}}exportDOM(e){const{element:t}=super.exportDOM(e);if(t&&hn(t)){this.isEmpty()&&t.append(document.createElement("br"));const e=this.getFormatType();t.style.textAlign=e;const n=this.getDirection();n&&(t.dir=n)}return{element:t}}static importJSON(e){const t=El(e.tag);return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{...super.exportJSON(),tag:this.getTag(),type:"heading",version:1}}insertNewAfter(e,t=!0){const n=e?e.anchor.offset:0,r=n!==this.getTextContentSize()&&e?El(this.getTag()):to(),s=this.getDirection();if(r.setDirection(s),this.insertAfter(r,t),0===n&&!this.isEmpty()&&e){const e=to();e.select(),this.replace(e,!0)}return r}collapseAtStart(){const e=this.isEmpty()?to():El(this.getTag());return this.getChildren().forEach((t=>e.append(t))),this.replace(e),!0}extractWithChild(){return!0}};function Sl(e){return"span"===e.nodeName.toLowerCase()&&"26pt"===e.style.fontSize}function Cl(e){const t=e.nodeName.toLowerCase();let n=null;return"h1"!==t&&"h2"!==t&&"h3"!==t&&"h4"!==t&&"h5"!==t&&"h6"!==t||(n=El(t),null!==e.style&&n.setFormat(e.style.textAlign)),{node:n}}function kl(e){const t=wl();return null!==e.style&&t.setFormat(e.style.textAlign),{node:t}}function El(e){return sn(new vl(e))}function Tl(e){return e instanceof vl}function Nl(e){let t=null;if(Xo(e,DragEvent)?t=e.dataTransfer:Xo(e,ClipboardEvent)&&(t=e.clipboardData),null===t)return[!1,[],!1];const n=t.types,r=n.includes("Files"),s=n.includes("text/html")||n.includes("text/plain");return[r,Array.from(t.files),s]}function Rl(e){const t=hs();if(!Gr(t))return!1;const n=new Set,r=t.getNodes();for(let s=0;s<r.length;s++){const t=r[s],o=t.getKey();if(n.has(o))continue;const i=jo(t),l=i.getKey();i.canIndent()&&!n.has(l)&&(n.add(l),e(i))}return n.size>0}function Al(e){return js(Ct(e))}function Ol({defaultSelection:e}){const[t]=Wi();return React.useEffect((()=>{t.focus((()=>{const e=document.activeElement,n=t.getRootElement();null===n||null!==e&&n.contains(e)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}let Fl=class e extends Hs{static getType(){return"overflow"}static clone(t){return new e(t.__key)}static importJSON(e){return Dl()}static importDOM(){return null}constructor(e){super(e),this.__type="overflow"}exportJSON(){return{...super.exportJSON(),type:"overflow"}}createDOM(e){const t=document.createElement("span"),n=e.theme.characterLimit;return"string"==typeof n&&(t.className=n),t}updateDOM(e,t){return!1}insertNewAfter(e,t=!0){return this.getParentOrThrow().insertNewAfter(e,t)}excludeFromCopy(){return!0}};function Dl(){return sn(new Fl)}function Pl(e){return e instanceof Fl}function Ll(){return Tt().getTextContent()}function Il(e,t=!0){if(e)return!1;let n=Ll();return t&&(n=n.trim()),""===n}function Ml(e){return()=>function(e){if(!Il(e,!1))return!1;const t=Tt().getChildren(),n=t.length;if(n>1)return!1;for(let r=0;r<n;r++){const e=t[r];if(js(e))return!1;if(Js(e)){if(!no(e))return!1;if(0!==e.__indent)return!1;const t=e.getChildren(),n=t.length;for(let e=0;e<n;e++)if(!Ur(t[r]))return!1}}return!0}(e)}var Bl=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};function zl(e,t,n=Object.freeze({})){const{strlen:r=(e=>e.length),remainingCharacters:s=(()=>{})}=n;React.useEffect((()=>{e.hasNodes([Fl])||Bl(57)}),[e]),React.useEffect((()=>{let n=e.getEditorState().read(Ll),o=0;return Bo(e.registerTextContentListener((e=>{n=e})),e.registerUpdateListener((({dirtyLeaves:i,dirtyElements:l})=>{const a=e.isComposing(),c=i.size>0||l.size>0;if(a||!c)return;const u=r(n),d=u>t||null!==o&&o>t;if(s(t-u),null===o||d){const s=function(e,t,n){const r=Intl.Segmenter;let s=0,o=0;if("function"==typeof r){const i=(new r).segment(e);for(const{segment:e}of i){const r=o+n(e);if(r>t)break;o=r,s+=e.length}}else{const r=Array.from(e),i=r.length;for(let e=0;e<i;e++){const i=r[e],l=o+n(i);if(l>t)break;o=l,s+=i.length}}return s}(n,t,r);e.update((()=>{!function(e){const t=function(e,t){const n=[],r=Tt().getLatest(),s=Js(r)?r.getLastDescendant():r;let o=r,i=function(e){let t=e,n=0;for(;null!==(t=t.getParent());)n++;return n}(o);for(;null!==o&&!o.is(s);)if(n.push({depth:i,node:o}),Js(o)&&o.getChildrenSize()>0)o=o.getFirstChild(),i++;else{let e=null;for(;null===e&&null!==o;)e=o.getNextSibling(),null===e?(o=o.getParent(),i--):o=e}return null!==o&&o.is(s)&&n.push({depth:i,node:o}),n}(),n=t.length;let r=0;for(let s=0;s<n;s+=1){const{node:n}=t[s];if(Pl(n)){const t=r;if(r+n.getTextContentSize()<=e){const e=n.getParent(),t=n.getPreviousSibling(),r=n.getNextSibling();Ul(n);const s=hs();!Gr(s)||s.anchor.getNode().isAttached()&&s.focus.getNode().isAttached()||(Ur(t)?t.select():Ur(r)?r.select():null!==e&&e.select())}else if(t<e){const r=n.getFirstDescendant(),s=t+(null!==r?r.getTextContentSize():0);(Ur(r)&&r.isSimpleText()||s<=e)&&Ul(n)}}else if(mt(n)){const t=r;if(r+=n.getTextContentSize(),r>e&&!Pl(n.getParent())){const r=hs();let s;if(t<e&&Ur(n)&&n.isSimpleText()){const[,r]=n.splitText(e-t);s=$l(r)}else s=$l(n);null!==r&&Rt(r),Kl(s)}}}}(s)}),{tag:"history-merge"})}o=u})))}),[e,t,s,r])}function $l(e){const t=Dl();return e.insertBefore(t),t.append(e),t}function Ul(e){const t=e.getChildren(),n=t.length;for(let r=0;r<n;r++)e.insertBefore(t[r]);return e.remove(),n>0?t[n-1]:null}function Kl(e){const t=e.getPreviousSibling();if(!Pl(t))return;const n=e.getFirstChild(),r=t.getChildren(),s=r.length;if(null===n)e.append(...r);else for(let i=0;i<s;i++)n.insertBefore(r[i]);const o=hs();if(Gr(o)){const n=o.anchor,r=n.getNode(),i=o.focus,l=n.getNode();r.is(t)?n.set(e.getKey(),n.offset,"element"):r.is(e)&&n.set(e.getKey(),s+n.offset,"element"),l.is(t)?i.set(e.getKey(),i.offset,"element"):l.is(e)&&i.set(e.getKey(),s+i.offset,"element")}t.remove()}let Wl=null;function jl({remainingCharacters:e}){return React.createElement("span",{className:"characters-limit "+(e<0?"characters-limit-exceeded":"")},e)}function Hl({charset:e="UTF-16",maxLength:t=5,renderer:n=jl}){const[r]=Wi(),[s,o]=React.useState(t);return zl(r,t,React.useMemo((()=>({remainingCharacters:o,strlen:t=>{if("UTF-8"===e)return function(e){const t=void 0===window.TextEncoder?null:(null===Wl&&(Wl=new window.TextEncoder),Wl);if(null===t){const t=encodeURIComponent(e).match(/%[89ABab]/g);return e.length+(t?t.length:0)}return t.encode(e).length}(t);if("UTF-16"===e)return t.length;throw new Error("Unrecognized charset")}})),[e])),n({remainingCharacters:s})}function Jl(){const[e]=Wi();return React.useEffect((()=>Bo(e.registerCommand(Bi,(()=>(mi(e,"check"),!0)),so),e.registerCommand(F,(t=>ql(t,e,!1)),so),e.registerCommand(O,(t=>ql(t,e,!0)),so),e.registerCommand(I,(t=>{if(null!=Xl()){const t=e.getRootElement();return null!=t&&t.focus(),!0}return!1}),so),e.registerCommand(P,(t=>{const n=Xl();return!(null==n||!e.isEditable()||(e.update((()=>{const e=Ct(n);Ni(e)&&(t.preventDefault(),e.toggleChecked())})),0))}),so),e.registerCommand(R,(t=>e.getEditorState().read((()=>{const n=hs();if(Gr(n)&&n.isCollapsed()){const{anchor:r}=n,s="element"===r.type;if(s||0===r.offset){const n=r.getNode(),o=Ho(n,(e=>Js(e)&&!e.isInline()));if(Ni(o)){const r=o.getParent();if(Li(r)&&"check"===r.getListType()&&(s||o.getFirstDescendant()===n)){const n=e.getElementByKey(o.__key);if(null!=n&&document.activeElement!==n)return n.focus(),t.preventDefault(),!0}}}}return!1}))),so),e.registerRootListener(((e,t)=>{null!==e&&(e.addEventListener("click",Yl),e.addEventListener("pointerdown",Zl)),null!==t&&(t.removeEventListener("click",Yl),t.removeEventListener("pointerdown",Zl))}))))),null}function Vl(e,t){const n=e.target;if(null===n||!hn(n))return;const r=n.firstChild;if(null!=r&&hn(r)&&("UL"===r.tagName||"OL"===r.tagName))return;const s=n.parentNode;if(!s||"check"!==s.__lexicalListType)return;const o=n.getBoundingClientRect(),i=e.pageX/Go(n);("rtl"===n.dir?i<o.right&&i>o.right-20:i>o.left&&i<o.left+20)&&t()}function Yl(e){Vl(e,(()=>{const t=e.target,n=function(e){let t=e;for(;t;){if(t.__lexicalEditor)return t.__lexicalEditor;t=t.parentNode}return null}(t);null!=n&&n.isEditable()&&n.update((()=>{if(e.target){const e=Ct(t);Ni(e)&&(t.focus(),e.toggleChecked())}}))}))}function Zl(e){Vl(e,(()=>{e.preventDefault()}))}function Xl(){const e=document.activeElement;return null!=e&&"LI"===e.tagName&&null!=e.parentNode&&"check"===e.parentNode.__lexicalListType?e:null}function ql(e,t,n){const r=Xl();return null!=r&&t.update((()=>{const s=Ct(r);if(!Ni(s))return;const o=function(e,t){let n=t?e.getPreviousSibling():e.getNextSibling(),r=e;for(;null==n&&Ni(r);)r=r.getParentOrThrow().getParent(),null!=r&&(n=t?r.getPreviousSibling():r.getNextSibling());for(;Ni(n);){const e=t?n.getLastChild():n.getFirstChild();if(!Li(e))return n;n=t?e.getLastChild():e.getFirstChild()}return null}(s,n);if(null!=o){o.selectStart();const n=t.getElementByKey(o.__key);null!=n&&(e.preventDefault(),setTimeout((()=>{n.focus()}),0))}})),!1}var Gl="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function Ql({onClear:e}){const[t]=Wi();return Gl((()=>t.registerCommand(X,(n=>(t.update((()=>{if(null==e){const e=Tt(),t=hs(),n=to();e.clear(),e.append(n),null!==t&&n.select(),Gr(t)&&(t.format=0)}else e()})),!0)),ro)),[t,e]),null}function ea({newTab:e=!0,disabled:t=!1}){const[n]=Wi();return React.useEffect((()=>{const r=r=>{if(t)return void r.preventDefault();const s=r.target;if(!(s instanceof Node))return;const o=dt(s);if(null===o)return;let i=null,l=null;if(o.update((()=>{const e=Ct(s);if(null!==e){const t=Ho(e,Js);if(ri(t))i=t.sanitizeUrl(t.getURL()),l=t.getTarget();else{const e=function(e,t){let n=e;for(;null!=n;){if(t(n))return n;n=n.parentNode}return null}(s,dn);null!==e&&(i=e.href,l=e.target)}}})),null===i||""===i)return;const a=n.getEditorState().read(hs);if(Gr(a)&&!a.isCollapsed())return void r.preventDefault();const c="auxclick"===r.type&&1===r.button;window.open(i,e||c||r.metaKey||r.ctrlKey||"_blank"===l?"_blank":"_self"),r.preventDefault()},s=e=>{t||1!==e.button||r(e)};return n.registerRootListener(((e,t)=>{null!==t&&(t.removeEventListener("click",r),t.removeEventListener("mouseup",s)),null!==e&&(e.addEventListener("click",r),e.addEventListener("mouseup",s))}))}),[n,e,t]),null}const ta=[["Cat","rgb(125, 50, 0)"],["Dog","rgb(100, 0, 0)"],["Rabbit","rgb(150, 0, 0)"],["Frog","rgb(200, 0, 0)"],["Fox","rgb(200, 75, 0)"],["Hedgehog","rgb(0, 75, 0)"],["Pigeon","rgb(0, 125, 0)"],["Squirrel","rgb(75, 100, 0)"],["Bear","rgb(125, 100, 0)"],["Tiger","rgb(0, 0, 150)"],["Leopard","rgb(0, 0, 200)"],["Zebra","rgb(0, 0, 250)"],["Wolf","rgb(0, 100, 150)"],["Owl","rgb(0, 100, 100)"],["Gull","rgb(100, 0, 100)"],["Squid","rgb(150, 0, 150)"]],na=ta[Math.floor(Math.random()*ta.length)],ra=React.createContext({clientID:0,color:na[1],isCollabActive:!1,name:na[0],yjsDocMap:new Map});function sa(e,t){const n=React.useContext(ra);return null!=e&&(n.name=e),null!=t&&(n.color=t),n}const oa=()=>new Map,ia=e=>{const t=oa();return e.forEach(((e,n)=>{t.set(n,e)})),t},la=(e,t,n)=>{let r=e.get(t);return void 0===r&&e.set(t,r=n()),r},aa=()=>new Set,ca=e=>e[e.length-1],ua=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},da=Array.from,ha=Array.isArray;class fa{constructor(){this._observers=oa()}on(e,t){return la(this._observers,e,aa).add(t),t}once(e,t){const n=(...r)=>{this.off(e,n),t(...r)};this.on(e,n)}off(e,t){const n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return da((this._observers.get(e)||oa()).values()).forEach((e=>e(...t)))}destroy(){this._observers=oa()}}class ga{constructor(){this._observers=oa()}on(e,t){la(this._observers,e,aa).add(t)}once(e,t){const n=(...r)=>{this.off(e,n),t(...r)};this.on(e,n)}off(e,t){const n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return da((this._observers.get(e)||oa()).values()).forEach((e=>e(...t)))}destroy(){this._observers=oa()}}const pa=Math.floor,ma=Math.abs,_a=(e,t)=>e<t?e:t,ya=(e,t)=>e>t?e:t,ba=Math.pow,wa=e=>0!==e?e<0:1/e<0,xa=64,va=128,Sa=127,Ca=Number.MAX_SAFE_INTEGER,ka=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&pa(e)===e),Ea=String.fromCharCode,Ta=/^\s*/g,Na=/([A-Z])/g,Ra=(e,t)=>(e=>e.replace(Ta,""))(e.replace(Na,(e=>`${t}${(e=>e.toLowerCase())(e)}`))),Aa="undefined"!=typeof TextEncoder?new TextEncoder:null,Oa=Aa?e=>Aa.encode(e):e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r};let Fa="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Fa&&1===Fa.decode(new Uint8Array).length&&(Fa=null);class Da{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const Pa=()=>new Da,La=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},Ia=e=>{const t=new Uint8Array(La(e));let n=0;for(let r=0;r<e.bufs.length;r++){const s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},Ma=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},Ba=Ma,za=(e,t)=>{for(;t>Sa;)Ma(e,va|Sa&t),t=pa(t/128);Ma(e,Sa&t)},$a=(e,t)=>{const n=wa(t);for(n&&(t=-t),Ma(e,(t>63?va:0)|(n?xa:0)|63&t),t=pa(t/64);t>0;)Ma(e,(t>Sa?va:0)|Sa&t),t=pa(t/128)},Ua=new Uint8Array(3e4),Ka=Ua.length/3,Wa=Aa&&Aa.encodeInto?(e,t)=>{if(t.length<Ka){const n=Aa.encodeInto(t,Ua).written||0;za(e,n);for(let t=0;t<n;t++)Ma(e,Ua[t])}else Ha(e,Oa(t))}:(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;za(e,r);for(let s=0;s<r;s++)Ma(e,n.codePointAt(s))},ja=(e,t)=>{const n=e.cbuf.length,r=e.cpos,s=_a(n-r,t.length),o=t.length-s;e.cbuf.set(t.subarray(0,s),r),e.cpos+=s,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(ya(2*n,o)),e.cbuf.set(t.subarray(s)),e.cpos=o)},Ha=(e,t)=>{za(e,t.byteLength),ja(e,t)},Ja=(e,t)=>{((e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*ya(n,t)),e.cpos=0)})(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},Va=new DataView(new ArrayBuffer(4)),Ya=(e,t)=>{switch(typeof t){case"string":Ma(e,119),Wa(e,t);break;case"number":ka(t)&&ma(t)<=2147483647?(Ma(e,125),$a(e,t)):(n=t,Va.setFloat32(0,n),Va.getFloat32(0)===n?(Ma(e,124),((e,t)=>{Ja(e,4).setFloat32(0,t,!1)})(e,t)):(Ma(e,123),((e,t)=>{Ja(e,8).setFloat64(0,t,!1)})(e,t)));break;case"bigint":Ma(e,122),((e,t)=>{Ja(e,8).setBigInt64(0,t,!1)})(e,t);break;case"object":if(null===t)Ma(e,126);else if(ha(t)){Ma(e,117),za(e,t.length);for(let n=0;n<t.length;n++)Ya(e,t[n])}else if(t instanceof Uint8Array)Ma(e,116),Ha(e,t);else{Ma(e,118);const n=Object.keys(t);za(e,n.length);for(let r=0;r<n.length;r++){const s=n[r];Wa(e,s),Ya(e,t[s])}}break;case"boolean":Ma(e,t?120:121);break;default:Ma(e,127)}var n};class Za extends Da{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&za(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const Xa=e=>{e.count>0&&($a(e.encoder,1===e.count?e.s:-e.s),e.count>1&&za(e.encoder,e.count-2))};class qa{constructor(){this.encoder=new Da,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Xa(this),this.count=1,this.s=e)}toUint8Array(){return Xa(this),Ia(this.encoder)}}const Ga=e=>{if(e.count>0){const t=2*e.diff+(1===e.count?0:1);$a(e.encoder,t),e.count>1&&za(e.encoder,e.count-2)}};class Qa{constructor(){this.encoder=new Da,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Ga(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Ga(this),Ia(this.encoder)}}class ec{constructor(){this.sarr=[],this.s="",this.lensE=new qa}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Da;return this.sarr.push(this.s),this.s="",Wa(e,this.sarr.join("")),ja(e,this.lensE.toUint8Array()),Ia(e)}}const tc=e=>new Error(e),nc=()=>{throw tc("Method unimplemented")},rc=()=>{throw tc("Unexpected case")},sc=tc("Unexpected end of array"),oc=tc("Integer out of Range");class ic{constructor(e){this.arr=e,this.pos=0}}const lc=e=>new ic(e),ac=e=>((e,t)=>{const n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n})(e,uc(e)),cc=e=>e.arr[e.pos++],uc=e=>{let t=0,n=1;const r=e.arr.length;for(;e.pos<r;){const r=e.arr[e.pos++];if(t+=(r&Sa)*n,n*=128,r<va)return t;if(t>Ca)throw oc}throw sc},dc=e=>{let t=e.arr[e.pos++],n=63&t,r=64;const s=(t&xa)>0?-1:1;if(!(t&va))return s*n;const o=e.arr.length;for(;e.pos<o;){if(t=e.arr[e.pos++],n+=(t&Sa)*r,r*=128,t<va)return s*n;if(n>Ca)throw oc}throw sc},hc=Fa?e=>Fa.decode(ac(e)):e=>{let t=uc(e);if(0===t)return"";{let n=String.fromCodePoint(cc(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(cc(e));else for(;t>0;){const r=t<1e4?t:1e4,s=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,s),t-=r}return decodeURIComponent(escape(n))}},fc=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},gc=[e=>{},e=>null,dc,e=>fc(e,4).getFloat32(0,!1),e=>fc(e,8).getFloat64(0,!1),e=>fc(e,8).getBigInt64(0,!1),e=>!1,e=>!0,hc,e=>{const t=uc(e),n={};for(let r=0;r<t;r++){n[hc(e)]=pc(e)}return n},e=>{const t=uc(e),n=[];for(let r=0;r<t;r++)n.push(pc(e));return n},ac],pc=e=>gc[127-cc(e)](e);class mc extends ic{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){var e;return 0===this.count&&(this.s=this.reader(this),(e=this).pos!==e.arr.length?this.count=uc(this)+1:this.count=-1),this.count--,this.s}}class _c extends ic{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=dc(this);const e=wa(this.s);this.count=1,e&&(this.s=-this.s,this.count=uc(this)+2)}return this.count--,this.s}}class yc extends ic{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const e=dc(this),t=1&e;this.diff=pa(e/2),this.count=1,t&&(this.count=uc(this)+2)}return this.s+=this.diff,this.count--,this.s}}class bc{constructor(e){this.decoder=new _c(e),this.str=hc(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const wc=crypto.getRandomValues.bind(crypto),xc=()=>wc(new Uint32Array(1))[0],vc="10000000-1000-4000-8000-100000000000",Sc=()=>vc.replace(/[018]/g,(e=>(e^xc()&15>>e/4).toString(16))),Cc=Date.now,kc=e=>new Promise(e);Promise.all.bind(Promise);const Ec=e=>void 0===e?null:e;let Tc=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},Nc=!0;try{"undefined"!=typeof localStorage&&localStorage&&(Tc=localStorage,Nc=!1)}catch(mw){}const Rc=Tc,Ac=Object.assign,Oc=Object.keys,Fc=e=>Oc(e).length,Dc=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),Pc=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&Pc(e,t,n+1)}},Lc=e=>e,Ic=(e,t)=>{if(null==e||null==t)return((e,t)=>e===t)(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break;case Map:if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!Ic(e.get(n),t.get(n)))return!1;break;case Object:if(Fc(e)!==Fc(t))return!1;for(const n in e)if(!Dc(e,n)||!Ic(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!Ic(e[n],t[n]))return!1;break;default:return!1}return!0};var Mc={};const Bc="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),zc="undefined"!=typeof window&&"undefined"!=typeof document&&!Bc;let $c;const Uc=e=>(()=>{if(void 0===$c)if(Bc){$c=oa();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];"-"===r[0]?(null!==t&&$c.set(t,""),t=r):null!==t&&($c.set(t,r),t=null)}null!==t&&$c.set(t,"")}else"object"==typeof location?($c=oa(),(location.search||"?").slice(1).split("&").forEach((e=>{if(0!==e.length){const[t,n]=e.split("=");$c.set(`--${Ra(t,"-")}`,n),$c.set(`-${Ra(t,"-")}`,n)}}))):$c=oa();return $c})().has(e),Kc=e=>Ec(Bc?Mc[e.toUpperCase().replaceAll("-","_")]:Rc.getItem(e));var Wc;Uc("--"+(Wc="production"))||Kc(Wc);const jc=Bc&&["true","1","2"].includes(Mc.FORCE_COLOR);const Hc=!Uc("no-colors")&&(!Bc||process.stdout.isTTY||jc)&&(!Bc||Uc("color")||jc||null!==Kc("COLORTERM")||(Kc("TERM")||"").includes("color")),Jc=e=>new Uint8Array(e),Vc=zc?e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Ea(e[n]);return btoa(t)}:e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),Yc=zc?e=>{const t=atob(e),n=Jc(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}:e=>{const t=Buffer.from(e,"base64");return n=t.buffer,r=t.byteOffset,s=t.byteLength,new Uint8Array(n,r,s);var n,r,s};class Zc{constructor(e,t){this.left=e,this.right=t}}const Xc=(e,t)=>new Zc(e,t);"undefined"!=typeof DOMParser&&new DOMParser;const qc=Symbol,Gc=qc(),Qc=qc(),eu=qc(),tu=qc(),nu=qc(),ru=qc(),su=qc(),ou=qc(),iu=qc(),lu={[Gc]:Xc("font-weight","bold"),[Qc]:Xc("font-weight","normal"),[eu]:Xc("color","blue"),[nu]:Xc("color","green"),[tu]:Xc("color","grey"),[ru]:Xc("color","red"),[su]:Xc("color","purple"),[ou]:Xc("color","orange"),[iu]:Xc("color","black")},au=Hc?e=>{var t;1===e.length&&(null==(t=e[0])?void 0:t.constructor)===Function&&(e=e[0]());const n=[],r=[],s=oa();let o=[],i=0;for(;i<e.length;i++){const t=e[i],o=lu[t];if(void 0!==o)s.set(o.left,o.right);else{if(void 0===t)break;if(t.constructor!==String&&t.constructor!==Number)break;{const e=((e,t)=>{const n=[];for(const[r,s]of e)n.push(t(s,r));return n})(s,((e,t)=>`${t}:${e};`)).join("");i>0||e.length>0?(n.push("%c"+t),r.push(e)):n.push(t)}}}for(i>0&&(o=r,o.unshift(n.join("")));i<e.length;i++){const t=e[i];t instanceof Symbol||o.push(t)}return o}:e=>{var t;1===e.length&&(null==(t=e[0])?void 0:t.constructor)===Function&&(e=e[0]());const n=[];let r=0;for(;r<e.length;r++){const t=e[r];void 0===t||t.constructor===String||t.constructor===Number||t.constructor===Object&&n.push(JSON.stringify(t))}return n},cu=aa(),uu=e=>({[Symbol.iterator](){return this},next:e}),du=(e,t)=>uu((()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}}));class hu{constructor(e,t){this.clock=e,this.len=t}}class fu{constructor(){this.clients=new Map}}const gu=(e,t,n)=>t.clients.forEach(((t,r)=>{const s=e.doc.store.clients.get(r);for(let o=0;o<t.length;o++){const r=t[o];fd(e,s,r.clock,r.len,n)}})),pu=(e,t)=>{const n=e.clients.get(t.client);return void 0!==n&&null!==((e,t)=>{let n=0,r=e.length-1;for(;n<=r;){const s=pa((n+r)/2),o=e[s],i=o.clock;if(i<=t){if(t<i+o.len)return s;n=s+1}else r=s-1}return null})(n,t.clock)},mu=e=>{e.clients.forEach((e=>{let t,n;for(e.sort(((e,t)=>e.clock-t.clock)),t=1,n=1;t<e.length;t++){const r=e[n-1],s=e[t];r.clock+r.len>=s.clock?r.len=ya(r.len,s.clock+s.len-r.clock):(n<t&&(e[n]=s),n++)}e.length=n}))},_u=e=>{const t=new fu;for(let n=0;n<e.length;n++)e[n].clients.forEach(((r,s)=>{if(!t.clients.has(s)){const o=r.slice();for(let t=n+1;t<e.length;t++)ua(o,e[t].clients.get(s)||[]);t.clients.set(s,o)}}));return mu(t),t},yu=(e,t,n,r)=>{la(e.clients,t,(()=>[])).push(new hu(n,r))},bu=e=>{const t=new fu;return e.clients.forEach(((e,n)=>{const r=[];for(let t=0;t<e.length;t++){const n=e[t];if(n.deleted){const s=n.id.clock;let o=n.length;if(t+1<e.length)for(let n=e[t+1];t+1<e.length&&n.deleted;n=e[1+ ++t])o+=n.length;r.push(new hu(s,o))}}r.length>0&&t.clients.set(n,r)})),t},wu=(e,t)=>{za(e.restEncoder,t.clients.size),da(t.clients.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([t,n])=>{e.resetDsCurVal(),za(e.restEncoder,t);const r=n.length;za(e.restEncoder,r);for(let s=0;s<r;s++){const t=n[s];e.writeDsClock(t.clock),e.writeDsLen(t.len)}}))},xu=e=>{const t=new fu,n=uc(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const n=uc(e.restDecoder),r=uc(e.restDecoder);if(r>0){const s=la(t.clients,n,(()=>[]));for(let t=0;t<r;t++)s.push(new hu(e.readDsClock(),e.readDsLen()))}}return t},vu=(e,t,n)=>{const r=new fu,s=uc(e.restDecoder);for(let o=0;o<s;o++){e.resetDsCurVal();const s=uc(e.restDecoder),o=uc(e.restDecoder),i=n.clients.get(s)||[],l=id(n,s);for(let n=0;n<o;n++){const n=e.readDsClock(),o=n+e.readDsLen();if(n<l){l<o&&yu(r,s,l,o-l);let e=ad(i,n),a=i[e];for(!a.deleted&&a.id.clock<n&&(i.splice(e+1,0,ef(t,a,n-a.id.clock)),e++);e<i.length&&(a=i[e++],a.id.clock<o);)a.deleted||(o<a.id.clock+a.length&&i.splice(e,0,ef(t,a,o-a.id.clock)),a.delete(t))}else yu(r,s,n,o-n)}}if(r.clients.size>0){const e=new Fu;return za(e.restEncoder,0),wu(e,r),e.toUint8Array()}return null},Su=xc;class Cu extends fa{constructor({guid:e=Sc(),collectionid:t=null,gc:n=!0,gcFilter:r=(()=>!0),meta:s=null,autoLoad:o=!1,shouldLoad:i=!0}={}){super(),this.gc=n,this.gcFilter=r,this.clientID=Su(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new sd,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=i,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=kc((e=>{this.on("load",(()=>{this.isLoaded=!0,e(this)}))}));const l=()=>kc((e=>{const t=n=>{void 0!==n&&!0!==n||(this.off("sync",t),e())};this.on("sync",t)}));this.on("sync",(e=>{!1===e&&this.isSynced&&(this.whenSynced=l()),this.isSynced=void 0===e||!0===e,this.isSynced&&!this.isLoaded&&this.emit("load",[this])})),this.whenSynced=l()}load(){const e=this._item;null===e||this.shouldLoad||bd(e.parent.doc,(e=>{e.subdocsLoaded.add(this)}),null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(da(this.subdocs).map((e=>e.guid)))}transact(e,t=null){return bd(this,e,t)}get(e,t=Wd){const n=la(this.share,e,(()=>{const e=new t;return e._integrate(this,null),e})),r=n.constructor;if(t!==Wd&&r!==t){if(r===Wd){const r=new t;r._map=n._map,n._map.forEach((e=>{for(;null!==e;e=e.left)e.parent=r})),r._start=n._start;for(let e=r._start;null!==e;e=e.right)e.parent=r;return r._length=n._length,this.share.set(e,r),r._integrate(this,null),r}throw new Error(`Type with the name ${e} has already been defined with a different constructor`)}return n}getArray(e=""){return this.get(e,lh)}getText(e=""){return this.get(e,kh)}getMap(e=""){return this.get(e,ch)}getXmlElement(e=""){return this.get(e,Nh)}getXmlFragment(e=""){return this.get(e,Th)}toJSON(){const e={};return this.share.forEach(((t,n)=>{e[n]=t.toJSON()})),e}destroy(){da(this.subdocs).forEach((e=>e.destroy()));const e=this._item;if(null!==e){this._item=null;const t=e.content;t.doc=new Cu({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,bd(e.parent.doc,(n=>{const r=t.doc;e.deleted||n.subdocsAdded.add(r),n.subdocsRemoved.add(this)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class ku{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return uc(this.restDecoder)}readDsLen(){return uc(this.restDecoder)}}class Eu extends ku{readLeftID(){return Vu(uc(this.restDecoder),uc(this.restDecoder))}readRightID(){return Vu(uc(this.restDecoder),uc(this.restDecoder))}readClient(){return uc(this.restDecoder)}readInfo(){return cc(this.restDecoder)}readString(){return hc(this.restDecoder)}readParentInfo(){return 1===uc(this.restDecoder)}readTypeRef(){return uc(this.restDecoder)}readLen(){return uc(this.restDecoder)}readAny(){return pc(this.restDecoder)}readBuf(){return(e=>{const t=Jc(e.byteLength);return t.set(e),t})(ac(this.restDecoder))}readJSON(){return JSON.parse(hc(this.restDecoder))}readKey(){return hc(this.restDecoder)}}class Tu{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=uc(this.restDecoder),this.dsCurrVal}readDsLen(){const e=uc(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Nu extends Tu{constructor(e){super(e),this.keys=[],uc(e),this.keyClockDecoder=new yc(ac(e)),this.clientDecoder=new _c(ac(e)),this.leftClockDecoder=new yc(ac(e)),this.rightClockDecoder=new yc(ac(e)),this.infoDecoder=new mc(ac(e),cc),this.stringDecoder=new bc(ac(e)),this.parentInfoDecoder=new mc(ac(e),cc),this.typeRefDecoder=new _c(ac(e)),this.lenDecoder=new _c(ac(e))}readLeftID(){return new Hu(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Hu(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return pc(this.restDecoder)}readBuf(){return ac(this.restDecoder)}readJSON(){return pc(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class Ru{constructor(){this.restEncoder=Pa()}toUint8Array(){return Ia(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){za(this.restEncoder,e)}writeDsLen(e){za(this.restEncoder,e)}}class Au extends Ru{writeLeftID(e){za(this.restEncoder,e.client),za(this.restEncoder,e.clock)}writeRightID(e){za(this.restEncoder,e.client),za(this.restEncoder,e.clock)}writeClient(e){za(this.restEncoder,e)}writeInfo(e){Ba(this.restEncoder,e)}writeString(e){Wa(this.restEncoder,e)}writeParentInfo(e){za(this.restEncoder,e?1:0)}writeTypeRef(e){za(this.restEncoder,e)}writeLen(e){za(this.restEncoder,e)}writeAny(e){Ya(this.restEncoder,e)}writeBuf(e){Ha(this.restEncoder,e)}writeJSON(e){Wa(this.restEncoder,JSON.stringify(e))}writeKey(e){Wa(this.restEncoder,e)}}class Ou{constructor(){this.restEncoder=Pa(),this.dsCurrVal=0}toUint8Array(){return Ia(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,za(this.restEncoder,t)}writeDsLen(e){0===e&&rc(),za(this.restEncoder,e-1),this.dsCurrVal+=e}}class Fu extends Ou{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new Qa,this.clientEncoder=new qa,this.leftClockEncoder=new Qa,this.rightClockEncoder=new Qa,this.infoEncoder=new Za(Ba),this.stringEncoder=new ec,this.parentInfoEncoder=new Za(Ba),this.typeRefEncoder=new qa,this.lenEncoder=new qa}toUint8Array(){const e=Pa();return za(e,0),Ha(e,this.keyClockEncoder.toUint8Array()),Ha(e,this.clientEncoder.toUint8Array()),Ha(e,this.leftClockEncoder.toUint8Array()),Ha(e,this.rightClockEncoder.toUint8Array()),Ha(e,Ia(this.infoEncoder)),Ha(e,this.stringEncoder.toUint8Array()),Ha(e,Ia(this.parentInfoEncoder)),Ha(e,this.typeRefEncoder.toUint8Array()),Ha(e,this.lenEncoder.toUint8Array()),ja(e,Ia(this.restEncoder)),Ia(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Ya(this.restEncoder,e)}writeBuf(e){Ha(this.restEncoder,e)}writeJSON(e){Ya(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const Du=(e,t,n)=>{const r=new Map;n.forEach(((e,n)=>{id(t,n)>e&&r.set(n,e)})),od(t).forEach(((e,t)=>{n.has(t)||r.set(t,0)})),za(e.restEncoder,r.size),da(r.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([n,r])=>{((e,t,n,r)=>{r=ya(r,t[0].id.clock);const s=ad(t,r);za(e.restEncoder,t.length-s),e.writeClient(n),za(e.restEncoder,r);const o=t[s];o.write(e,r-o.id.clock);for(let i=s+1;i<t.length;i++)t[i].write(e,0)})(e,t.clients.get(n),n,r)}))},Pu=(e,t,n,r=new Nu(e))=>bd(t,(e=>{e.local=!1;let t=!1;const n=e.doc,s=n.store,o=((e,t)=>{const n=oa(),r=uc(e.restDecoder);for(let s=0;s<r;s++){const r=uc(e.restDecoder),s=new Array(r),o=e.readClient();let i=uc(e.restDecoder);n.set(o,{i:0,refs:s});for(let n=0;n<r;n++){const r=e.readInfo();switch(31&r){case 0:{const t=e.readLen();s[n]=new Dh(Vu(o,i),t),i+=t;break}case 10:{const t=uc(e.restDecoder);s[n]=new lf(Vu(o,i),t),i+=t;break}default:{const l=!(192&r),a=new rf(Vu(o,i),null,(r&va)===va?e.readLeftID():null,null,(r&xa)===xa?e.readRightID():null,l?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,!l||32&~r?null:e.readString(),sf(e,r));s[n]=a,i+=a.length}}}}return n})(r,n),i=((e,t,n)=>{const r=[];let s=da(n.keys()).sort(((e,t)=>e-t));if(0===s.length)return null;const o=()=>{if(0===s.length)return null;let e=n.get(s[s.length-1]);for(;e.refs.length===e.i;){if(s.pop(),!(s.length>0))return null;e=n.get(s[s.length-1])}return e};let i=o();if(null===i)return null;const l=new sd,a=new Map,c=(e,t)=>{const n=a.get(e);(null==n||n>t)&&a.set(e,t)};let u=i.refs[i.i++];const d=new Map,h=()=>{for(const e of r){const t=e.id.client,r=n.get(t);r?(r.i--,l.clients.set(t,r.refs.slice(r.i)),n.delete(t),r.i=0,r.refs=[]):l.clients.set(t,[e]),s=s.filter((e=>e!==t))}r.length=0};for(;;){if(u.constructor!==lf){const s=la(d,u.id.client,(()=>id(t,u.id.client)))-u.id.clock;if(s<0)r.push(u),c(u.id.client,u.id.clock-1),h();else{const o=u.getMissing(e,t);if(null!==o){r.push(u);const e=n.get(o)||{refs:[],i:0};if(e.refs.length!==e.i){u=e.refs[e.i++];continue}c(o,id(t,o)),h()}else(0===s||s<u.length)&&(u.integrate(e,s),d.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(null!==i&&i.i<i.refs.length)u=i.refs[i.i++];else{if(i=o(),null===i)break;u=i.refs[i.i++]}}if(l.clients.size>0){const e=new Fu;return Du(e,l,new Map),za(e.restEncoder,0),{missing:a,update:e.toUint8Array()}}return null})(e,s,o),l=s.pendingStructs;if(l){for(const[e,n]of l.missing)if(n<id(s,e)){t=!0;break}if(i){for(const[e,t]of i.missing){const n=l.missing.get(e);(null==n||n>t)&&l.missing.set(e,t)}l.update=Nd([l.update,i.update])}}else s.pendingStructs=i;const a=vu(r,e,s);if(s.pendingDs){const t=new Nu(lc(s.pendingDs));uc(t.restDecoder);const n=vu(t,e,s);s.pendingDs=a&&n?Nd([a,n]):a||n}else s.pendingDs=a;if(t){const t=s.pendingStructs.update;s.pendingStructs=null,Lu(e.doc,t)}}),n,!1),Lu=(e,t,n,r=Nu)=>{const s=lc(t);Pu(s,e,n,new r(s))},Iu=(e,t=new Uint8Array([0]),n=new Fu)=>{((e,t,n=new Map)=>{Du(e,t.store,n),wu(e,bu(t.store))})(n,e,Mu(t));const r=[n.toUint8Array()];if(e.store.pendingDs&&r.push(e.store.pendingDs),e.store.pendingStructs&&r.push(Rd(e.store.pendingStructs.update,t)),r.length>1){if(n.constructor===Au)return Ed(r.map(((e,t)=>0===t?e:Dd(e))));if(n.constructor===Fu)return Nd(r)}return r[0]},Mu=e=>(e=>{const t=new Map,n=uc(e.restDecoder);for(let r=0;r<n;r++){const n=uc(e.restDecoder),r=uc(e.restDecoder);t.set(n,r)}return t})(new ku(lc(e))),Bu=(e,t)=>(za(e.restEncoder,t.size),da(t.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([t,n])=>{za(e.restEncoder,t),za(e.restEncoder,n)})),e),zu=(e,t=new Ou)=>(e instanceof Map?Bu(t,e):((e,t)=>{Bu(e,od(t.store))})(t,e),t.toUint8Array());class $u{constructor(){this.l=[]}}const Uu=()=>new $u,Ku=(e,t)=>e.l.push(t),Wu=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter((e=>t!==e)),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},ju=(e,t,n)=>Pc(e.l,[t,n]);class Hu{constructor(e,t){this.client=e,this.clock=t}}const Ju=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,Vu=(e,t)=>new Hu(e,t),Yu=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw rc()},Zu=(e,t)=>{for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1};class Xu{constructor(e,t,n,r=0){this.type=e,this.tname=t,this.item=n,this.assoc=r}}class qu{constructor(e,t,n=0){this.type=e,this.index=t,this.assoc=n}}const Gu=(e,t,n)=>{let r=null,s=null;return null===e._item?s=Yu(e):r=Vu(e._item.id.client,e._item.id.clock),new Xu(r,s,t,n)},Qu=(e,t,n=0)=>{let r=e._start;if(n<0){if(0===t)return Gu(e,null,n);t--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>t)return Gu(e,Vu(r.id.client,r.id.clock+t),n);t-=r.length}if(null===r.right&&n<0)return Gu(e,r.lastId,n);r=r.right}return Gu(e,null,n)},ed=(e,t,n=!0)=>{const r=t.store,s=e.item,o=e.type,i=e.tname,l=e.assoc;let a=null,c=0;if(null!==s){if(id(r,s.client)<=s.clock)return null;const e=n?Gh(r,s):{item:cd(r,s),diff:0},t=e.item;if(!(t instanceof rf))return null;if(a=t.parent,null===a._item||!a._item.deleted){c=t.deleted||!t.countable?0:e.diff+(l>=0?0:1);let n=t.left;for(;null!==n;)!n.deleted&&n.countable&&(c+=n.length),n=n.left}}else{if(null!==i)a=t.get(i);else{if(null===o)throw rc();{if(id(r,o.client)<=o.clock)return null;const{item:e}=n?Gh(r,o):{item:cd(r,o)};if(!(e instanceof rf&&e.content instanceof qh))return null;a=e.content.type}}c=l>=0?a._length:0}return((e,t,n=0)=>new qu(e,t,n))(a,c,e.assoc)},td=(e,t)=>e===t||null!==e&&null!==t&&e.tname===t.tname&&Ju(e.item,t.item)&&Ju(e.type,t.type)&&e.assoc===t.assoc,nd=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!pu(t.ds,e.id),rd=(e,t)=>{const n=la(e.meta,rd,aa),r=e.doc.store;n.has(t)||(t.sv.forEach(((t,n)=>{t<id(r,n)&&dd(e,Vu(n,t))})),gu(e,t.ds,(e=>{})),n.add(t))};class sd{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const od=e=>{const t=new Map;return e.clients.forEach(((e,n)=>{const r=e[e.length-1];t.set(n,r.id.clock+r.length)})),t},id=(e,t)=>{const n=e.clients.get(t);if(void 0===n)return 0;const r=n[n.length-1];return r.id.clock+r.length},ld=(e,t)=>{let n=e.clients.get(t.id.client);if(void 0===n)n=[],e.clients.set(t.id.client,n);else{const e=n[n.length-1];if(e.id.clock+e.length!==t.id.clock)throw rc()}n.push(t)},ad=(e,t)=>{let n=0,r=e.length-1,s=e[r],o=s.id.clock;if(o===t)return r;let i=pa(t/(o+s.length-1)*r);for(;n<=r;){if(s=e[i],o=s.id.clock,o<=t){if(t<o+s.length)return i;n=i+1}else r=i-1;i=pa((n+r)/2)}throw rc()},cd=(e,t)=>{const n=e.clients.get(t.client);return n[ad(n,t.clock)]},ud=(e,t,n)=>{const r=ad(t,n),s=t[r];return s.id.clock<n&&s instanceof rf?(t.splice(r+1,0,ef(e,s,n-s.id.clock)),r+1):r},dd=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[ud(e,n,t.clock)]},hd=(e,t,n)=>{const r=t.clients.get(n.client),s=ad(r,n.clock),o=r[s];return n.clock!==o.id.clock+o.length-1&&o.constructor!==Dh&&r.splice(s+1,0,ef(e,o,n.clock-o.id.clock+1)),o},fd=(e,t,n,r,s)=>{if(0===r)return;const o=n+r;let i,l=ud(e,t,n);do{i=t[l++],o<i.id.clock+i.length&&ud(e,t,o),s(i)}while(l<t.length&&t[l].id.clock<o)};class gd{constructor(e,t,n){this.doc=e,this.deleteSet=new fu,this.beforeState=od(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const pd=(e,t)=>!(0===t.deleteSet.clients.size&&!((e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1})(t.afterState,((e,n)=>t.beforeState.get(n)!==e)))&&(mu(t.deleteSet),((e,t)=>{Du(e,t.doc.store,t.beforeState)})(e,t),wu(e,t.deleteSet),!0),md=(e,t,n)=>{const r=t._item;(null===r||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&la(e.changed,t,aa).add(n)},_d=(e,t)=>{let n=e[t],r=e[t-1],s=t;for(;s>0&&(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n));n=r,r=e[--s-1])n instanceof rf&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);const o=t-s;return o&&e.splice(t+1-o,o),o},yd=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,s=r.store,o=n.deleteSet,i=n._mergeStructs;try{mu(o),n.afterState=od(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const e=[];n.changed.forEach(((t,r)=>e.push((()=>{null!==r._item&&r._item.deleted||r._callObserver(n,t)})))),e.push((()=>{n.changedParentTypes.forEach(((e,t)=>{t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter((e=>null===e.target._item||!e.target._item.deleted))).forEach((e=>{e.currentTarget=t,e._path=null})),e.sort(((e,t)=>e.path.length-t.path.length)),ju(t._dEH,e,n))}))})),e.push((()=>r.emit("afterTransaction",[n,r]))),Pc(e,[]),n._needFormattingCleanup&&vh(n)}finally{r.gc&&((e,t,n)=>{for(const[r,s]of e.clients.entries()){const e=t.clients.get(r);for(let r=s.length-1;r>=0;r--){const o=s[r],i=o.clock+o.len;for(let r=ad(e,o.clock),s=e[r];r<e.length&&s.id.clock<i;s=e[++r]){const s=e[r];if(o.clock+o.len<=s.id.clock)break;s instanceof rf&&s.deleted&&!s.keep&&n(s)&&s.gc(t,!1)}}}})(o,s,r.gcFilter),((e,t)=>{e.clients.forEach(((e,n)=>{const r=t.clients.get(n);for(let t=e.length-1;t>=0;t--){const n=e[t];for(let e=_a(r.length-1,1+ad(r,n.clock+n.len-1)),t=r[e];e>0&&t.id.clock>=n.clock;t=r[e])e-=1+_d(r,e)}}))})(o,s),n.afterState.forEach(((e,t)=>{const r=n.beforeState.get(t)||0;if(r!==e){const e=s.clients.get(t),n=ya(ad(e,r),1);for(let t=e.length-1;t>=n;)t-=1+_d(e,t)}}));for(let e=i.length-1;e>=0;e--){const{client:t,clock:n}=i[e].id,r=s.clients.get(t),o=ad(r,n);o+1<r.length&&_d(r,o+1)>1||o>0&&_d(r,o)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(((...e)=>{console.log(...au(e)),cu.forEach((t=>t.print(e)))})(ou,Gc,"[yjs] ",Qc,ru,"Changed the client-id because another client seems to be using it."),r.clientID=Su()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const e=new Au;pd(e,n)&&r.emit("update",[e.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const e=new Fu;pd(e,n)&&r.emit("updateV2",[e.toUint8Array(),n.origin,r,n])}const{subdocsAdded:l,subdocsLoaded:a,subdocsRemoved:c}=n;(l.size>0||c.size>0||a.size>0)&&(l.forEach((e=>{e.clientID=r.clientID,null==e.collectionid&&(e.collectionid=r.collectionid),r.subdocs.add(e)})),c.forEach((e=>r.subdocs.delete(e))),r.emit("subdocs",[{loaded:a,added:l,removed:c},r,n]),c.forEach((e=>e.destroy()))),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):yd(e,t+1)}}},bd=(e,t,n=null,r=!0)=>{const s=e._transactionCleanups;let o=!1,i=null;null===e._transaction&&(o=!0,e._transaction=new gd(e,n,r),s.push(e._transaction),1===s.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{i=t(e._transaction)}finally{if(o){const t=e._transaction===s[0];e._transaction=null,t&&yd(s,0)}}return i};class wd{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const xd=(e,t,n)=>{gu(e,n.deletions,(e=>{e instanceof rf&&t.scope.some((t=>Zu(t,e)))&&Qh(e,!1)}))},vd=(e,t,n)=>{let r=null;const s=e.doc,o=e.scope;if(bd(s,(n=>{for(;t.length>0&&null===e.currStackItem;){const r=s.store,i=t.pop(),l=new Set,a=[];let c=!1;gu(n,i.insertions,(e=>{if(e instanceof rf){if(null!==e.redone){let{item:t,diff:s}=Gh(r,e.id);s>0&&(t=dd(n,Vu(t.id.client,t.id.clock+s))),e=t}!e.deleted&&o.some((t=>Zu(t,e)))&&a.push(e)}})),gu(n,i.deletions,(e=>{e instanceof rf&&o.some((t=>Zu(t,e)))&&!pu(i.insertions,e.id)&&l.add(e)})),l.forEach((t=>{c=null!==nf(n,t,l,i.insertions,e.ignoreRemoteMapChanges,e)||c}));for(let t=a.length-1;t>=0;t--){const r=a[t];e.deleteFilter(r)&&(r.delete(n),c=!0)}e.currStackItem=c?i:null}n.changed.forEach(((e,t)=>{e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)})),r=n}),e),null!=e.currStackItem){const t=r.changedParentTypes;e.emit("stack-item-popped",[{stackItem:e.currStackItem,type:n,changedParentTypes:t,origin:e},e]),e.currStackItem=null}return e.currStackItem};class Sd extends fa{constructor(e,{captureTimeout:t=500,captureTransaction:n=(e=>!0),deleteFilter:r=(()=>!0),trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:i=(ha(e)?e[0].doc:e.doc)}={}){super(),this.scope=[],this.doc=i,this.addToScope(e),this.deleteFilter=r,s.add(this),this.trackedOrigins=s,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=t,this.afterTransactionHandler=e=>{if(!(this.captureTransaction(e)&&this.scope.some((t=>e.changedParentTypes.has(t)))&&(this.trackedOrigins.has(e.origin)||e.origin&&this.trackedOrigins.has(e.origin.constructor))))return;const t=this.undoing,n=this.redoing,r=t?this.redoStack:this.undoStack;t?this.stopCapturing():n||this.clear(!1,!0);const s=new fu;e.afterState.forEach(((t,n)=>{const r=e.beforeState.get(n)||0,o=t-r;o>0&&yu(s,n,r,o)}));const o=Cc();let i=!1;if(this.lastChange>0&&o-this.lastChange<this.captureTimeout&&r.length>0&&!t&&!n){const t=r[r.length-1];t.deletions=_u([t.deletions,e.deleteSet]),t.insertions=_u([t.insertions,s])}else r.push(new wd(e.deleteSet,s)),i=!0;t||n||(this.lastChange=o),gu(e,e.deleteSet,(e=>{e instanceof rf&&this.scope.some((t=>Zu(t,e)))&&Qh(e,!0)}));const l=[{stackItem:r[r.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},this];i?this.emit("stack-item-added",l):this.emit("stack-item-updated",l)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",(()=>{this.destroy()}))}addToScope(e){(e=ha(e)?e:[e]).forEach((e=>{this.scope.every((t=>t!==e))&&(e.doc!==this.doc&&((...e)=>{console.warn(...au(e)),e.unshift(ou),cu.forEach((t=>t.print(e)))})("[yjs#509] Not same Y.Doc"),this.scope.push(e))}))}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact((n=>{e&&(this.undoStack.forEach((e=>xd(n,this,e))),this.undoStack=[]),t&&(this.redoStack.forEach((e=>xd(n,this,e))),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])}))}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=vd(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=vd(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class Cd{constructor(e,t){this.gen=function*(e){const t=uc(e.restDecoder);for(let n=0;n<t;n++){const t=uc(e.restDecoder),n=e.readClient();let r=uc(e.restDecoder);for(let s=0;s<t;s++){const t=e.readInfo();if(10===t){const t=uc(e.restDecoder);yield new lf(Vu(n,r),t),r+=t}else if(31&t){const s=!(192&t),o=new rf(Vu(n,r),null,(t&va)===va?e.readLeftID():null,null,(t&xa)===xa?e.readRightID():null,s?e.readParentInfo()?e.readString():e.readLeftID():null,!s||32&~t?null:e.readString(),sf(e,t));yield o,r+=o.length}else{const t=e.readLen();yield new Dh(Vu(n,r),t),r+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===lf);return this.curr}}class kd{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const Ed=e=>Nd(e,Eu,Au),Td=(e,t)=>{if(e.constructor===Dh){const{client:n,clock:r}=e.id;return new Dh(Vu(n,r+t),e.length-t)}if(e.constructor===lf){const{client:n,clock:r}=e.id;return new lf(Vu(n,r+t),e.length-t)}{const n=e,{client:r,clock:s}=n.id;return new rf(Vu(r,s+t),null,Vu(r,s+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},Nd=(e,t=Nu,n=Fu)=>{if(1===e.length)return e[0];const r=e.map((e=>new t(lc(e))));let s=r.map((e=>new Cd(e,!0))),o=null;const i=new n,l=new kd(i);for(;s=s.filter((e=>null!==e.curr)),s.sort(((e,t)=>{if(e.curr.id.client===t.curr.id.client){const n=e.curr.id.clock-t.curr.id.clock;return 0===n?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===lf?1:-1:n}return t.curr.id.client-e.curr.id.client})),0!==s.length;){const e=s[0],t=e.curr.id.client;if(null!==o){let n=e.curr,r=!1;for(;null!==n&&n.id.clock+n.length<=o.struct.id.clock+o.struct.length&&n.id.client>=o.struct.id.client;)n=e.next(),r=!0;if(null===n||n.id.client!==t||r&&n.id.clock>o.struct.id.clock+o.struct.length)continue;if(t!==o.struct.id.client)Od(l,o.struct,o.offset),o={struct:n,offset:0},e.next();else if(o.struct.id.clock+o.struct.length<n.id.clock)if(o.struct.constructor===lf)o.struct.length=n.id.clock+n.length-o.struct.id.clock;else{Od(l,o.struct,o.offset);const e=n.id.clock-o.struct.id.clock-o.struct.length;o={struct:new lf(Vu(t,o.struct.id.clock+o.struct.length),e),offset:0}}else{const t=o.struct.id.clock+o.struct.length-n.id.clock;t>0&&(o.struct.constructor===lf?o.struct.length-=t:n=Td(n,t)),o.struct.mergeWith(n)||(Od(l,o.struct,o.offset),o={struct:n,offset:0},e.next())}}else o={struct:e.curr,offset:0},e.next();for(let n=e.curr;null!==n&&n.id.client===t&&n.id.clock===o.struct.id.clock+o.struct.length&&n.constructor!==lf;n=e.next())Od(l,o.struct,o.offset),o={struct:n,offset:0}}null!==o&&(Od(l,o.struct,o.offset),o=null),Fd(l);const a=r.map((e=>xu(e))),c=_u(a);return wu(i,c),i.toUint8Array()},Rd=(e,t,n=Nu,r=Fu)=>{const s=Mu(t),o=new r,i=new kd(o),l=new n(lc(e)),a=new Cd(l,!1);for(;a.curr;){const e=a.curr,t=e.id.client,n=s.get(t)||0;if(a.curr.constructor!==lf)if(e.id.clock+e.length>n)for(Od(i,e,ya(n-e.id.clock,0)),a.next();a.curr&&a.curr.id.client===t;)Od(i,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===t&&a.curr.id.clock+a.curr.length<=n;)a.next();else a.next()}Fd(i);const c=xu(l);return wu(o,c),o.toUint8Array()},Ad=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Ia(e.encoder.restEncoder)}),e.encoder.restEncoder=Pa(),e.written=0)},Od=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Ad(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),za(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Fd=e=>{Ad(e);const t=e.encoder.restEncoder;za(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];za(t,r.written),ja(t,r.restEncoder)}},Dd=e=>((e,t,n,r)=>{const s=new n(lc(e)),o=new Cd(s,!1),i=new r,l=new kd(i);for(let c=o.curr;null!==c;c=o.next())Od(l,t(c),0);Fd(l);const a=xu(s);return wu(i,a),i.toUint8Array()})(e,Lc,Nu,Au),Pd="You must not compute changes after the event-handler fired.";class Ld{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Id(this.currentTarget,this.target))}deletes(e){return pu(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw tc(Pd);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach((n=>{if(null!==n){const r=t._map.get(n);let s,o;if(this.adds(r)){let e=r.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(r)){if(null===e||!this.deletes(e))return;s="delete",o=ca(e.content.getContent())}else null!==e&&this.deletes(e)?(s="update",o=ca(e.content.getContent())):(s="add",o=void 0)}else{if(!this.deletes(r))return;s="delete",o=ca(r.content.getContent())}e.set(n,{action:s,oldValue:o})}})),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw tc(Pd);const t=this.target,n=aa(),r=aa(),s=[];e={added:n,deleted:r,delta:s,keys:this.keys};if(this.transaction.changed.get(t).has(null)){let e=null;const o=()=>{e&&s.push(e)};for(let s=t._start;null!==s;s=s.right)s.deleted?this.deletes(s)&&!this.adds(s)&&(null!==e&&void 0!==e.delete||(o(),e={delete:0}),e.delete+=s.length,r.add(s)):this.adds(s)?(null!==e&&void 0!==e.insert||(o(),e={insert:[]}),e.insert=e.insert.concat(s.content.getContent()),n.add(s)):(null!==e&&void 0!==e.retain||(o(),e={retain:0}),e.retain+=s.length);null!==e&&void 0===e.retain&&o()}this._changes=e}return e}}const Id=(e,t)=>{const n=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)n.unshift(t._item.parentSub);else{let e=0,r=t._item.parent._start;for(;r!==t._item&&null!==r;)r.deleted||e++,r=r.right;n.unshift(e)}t=t._item.parent}return n};let Md=0;class Bd{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Md++}}const zd=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Md++},$d=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;const n=0===e._searchMarker.length?null:e._searchMarker.reduce(((e,n)=>ma(t-e.index)<ma(t-n.index)?e:n));let r=e._start,s=0;for(null!==n&&(r=n.p,s=n.index,(e=>{e.timestamp=Md++})(n));null!==r.right&&s<t;){if(!r.deleted&&r.countable){if(t<s+r.length)break;s+=r.length}r=r.right}for(;null!==r.left&&s>t;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return null!==n&&ma(n.index-s)<r.parent.length/80?(zd(n,r,s),n):((e,t,n)=>{if(e.length>=80){const r=e.reduce(((e,t)=>e.timestamp<t.timestamp?e:t));return zd(r,t,n),r}{const r=new Bd(t,n);return e.push(r),r}})(e._searchMarker,r,s)},Ud=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const s=e[r];if(n>0){let t=s.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)t=t.left,t&&!t.deleted&&t.countable&&(s.index-=t.length);if(null===t||!0===t.marker){e.splice(r,1);continue}s.p=t,t.marker=!0}(t<s.index||n>0&&t===s.index)&&(s.index=ya(t,s.index+n))}},Kd=(e,t,n)=>{const r=e,s=t.changedParentTypes;for(;la(s,e,(()=>[])).push(n),null!==e._item;)e=e._item.parent;ju(r._eH,n,t)};class Wd{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Uu(),this._dEH=Uu(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw nc()}clone(){throw nc()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Ku(this._eH,e)}observeDeep(e){Ku(this._dEH,e)}unobserve(e){Wu(this._eH,e)}unobserveDeep(e){Wu(this._dEH,e)}toJSON(){}}const jd=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const s=[];let o=e._start;for(;null!==o&&r>0;){if(o.countable&&!o.deleted){const e=o.content.getContent();if(e.length<=t)t-=e.length;else{for(let n=t;n<e.length&&r>0;n++)s.push(e[n]),r--;t=0}}o=o.right}return s},Hd=e=>{const t=[];let n=e._start;for(;null!==n;){if(n.countable&&!n.deleted){const e=n.content.getContent();for(let n=0;n<e.length;n++)t.push(e[n])}n=n.right}return t},Jd=(e,t)=>{let n=0,r=e._start;for(;null!==r;){if(r.countable&&!r.deleted){const s=r.content.getContent();for(let r=0;r<s.length;r++)t(s[r],n++,e)}r=r.right}},Vd=(e,t)=>{const n=[];return Jd(e,((r,s)=>{n.push(t(r,s,e))})),n},Yd=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const e=n[r++];return n.length<=r&&(n=null),{done:!1,value:e}}}},Zd=(e,t)=>{const n=$d(e,t);let r=e._start;for(null!==n&&(r=n.p,t-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Xd=(e,t,n,r)=>{let s=n;const o=e.doc,i=o.clientID,l=o.store,a=null===n?t._start:n.right;let c=[];const u=()=>{c.length>0&&(s=new rf(Vu(i,id(l,i)),s,s&&s.lastId,a,a&&a.id,t,null,new Uh(c)),s.integrate(e,0),c=[])};r.forEach((n=>{if(null===n)c.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(n);break;default:switch(u(),n.constructor){case Uint8Array:case ArrayBuffer:s=new rf(Vu(i,id(l,i)),s,s&&s.lastId,a,a&&a.id,t,null,new Ph(new Uint8Array(n))),s.integrate(e,0);break;case Cu:s=new rf(Vu(i,id(l,i)),s,s&&s.lastId,a,a&&a.id,t,null,new Mh(n)),s.integrate(e,0);break;default:if(!(n instanceof Wd))throw new Error("Unexpected content type in insert operation");s=new rf(Vu(i,id(l,i)),s,s&&s.lastId,a,a&&a.id,t,null,new qh(n)),s.integrate(e,0)}}})),u()},qd=()=>tc("Length exceeded!"),Gd=(e,t,n,r)=>{if(n>t._length)throw qd();if(0===n)return t._searchMarker&&Ud(t._searchMarker,n,r.length),Xd(e,t,null,r);const s=n,o=$d(t,n);let i=t._start;for(null!==o&&(i=o.p,0===(n-=o.index)&&(i=i.prev,n+=i&&i.countable&&!i.deleted?i.length:0));null!==i;i=i.right)if(!i.deleted&&i.countable){if(n<=i.length){n<i.length&&dd(e,Vu(i.id.client,i.id.clock+n));break}n-=i.length}return t._searchMarker&&Ud(t._searchMarker,s,r.length),Xd(e,t,i,r)},Qd=(e,t,n,r)=>{if(0===r)return;const s=n,o=r,i=$d(t,n);let l=t._start;for(null!==i&&(l=i.p,n-=i.index);null!==l&&n>0;l=l.right)!l.deleted&&l.countable&&(n<l.length&&dd(e,Vu(l.id.client,l.id.clock+n)),n-=l.length);for(;r>0&&null!==l;)l.deleted||(r<l.length&&dd(e,Vu(l.id.client,l.id.clock+r)),l.delete(e),r-=l.length),l=l.right;if(r>0)throw qd();t._searchMarker&&Ud(t._searchMarker,s,-o+r)},eh=(e,t,n)=>{const r=t._map.get(n);void 0!==r&&r.delete(e)},th=(e,t,n,r)=>{const s=t._map.get(n)||null,o=e.doc,i=o.clientID;let l;if(null==r)l=new Uh([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:l=new Uh([r]);break;case Uint8Array:l=new Ph(r);break;case Cu:l=new Mh(r);break;default:if(!(r instanceof Wd))throw new Error("Unexpected content type");l=new qh(r)}new rf(Vu(i,id(o.store,i)),s,s&&s.lastId,null,null,t,n,l).integrate(e,0)},nh=(e,t)=>{const n=e._map.get(t);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},rh=e=>{const t={};return e._map.forEach(((e,n)=>{e.deleted||(t[n]=e.content.getContent()[e.length-1])})),t},sh=(e,t)=>{const n=e._map.get(t);return void 0!==n&&!n.deleted},oh=e=>{return t=e.entries(),n=e=>!e[1].deleted,uu((()=>{let e;do{e=t.next()}while(!e.done&&!n(e.value));return e}));var t,n};class ih extends Ld{constructor(e,t){super(e,t),this._transaction=t}}class lh extends Wd{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new lh;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new lh}clone(){const e=new lh;return e.insert(0,this.toArray().map((e=>e instanceof Wd?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),Kd(this,e,new ih(this,e))}insert(e,t){null!==this.doc?bd(this.doc,(n=>{Gd(n,this,e,t)})):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?bd(this.doc,(t=>{((e,t,n)=>{let r=(t._searchMarker||[]).reduce(((e,t)=>t.index>e.index?t:e),{index:0,p:t._start}).p;if(r)for(;r.right;)r=r.right;Xd(e,t,r,n)})(t,this,e)})):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?bd(this.doc,(n=>{Qd(n,this,e,t)})):this._prelimContent.splice(e,t)}get(e){return Zd(this,e)}toArray(){return Hd(this)}slice(e=0,t=this.length){return jd(this,e,t)}toJSON(){return this.map((e=>e instanceof Wd?e.toJSON():e))}map(e){return Vd(this,e)}forEach(e){Jd(this,e)}[Symbol.iterator](){return Yd(this)}_write(e){e.writeTypeRef(jh)}}class ah extends Ld{constructor(e,t,n){super(e,t),this.keysChanged=n}}class ch extends Wd{constructor(e){super(),this._prelimContent=null,this._prelimContent=void 0===e?new Map:new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach(((e,t)=>{this.set(t,e)})),this._prelimContent=null}_copy(){return new ch}clone(){const e=new ch;return this.forEach(((t,n)=>{e.set(n,t instanceof Wd?t.clone():t)})),e}_callObserver(e,t){Kd(this,e,new ah(this,e,t))}toJSON(){const e={};return this._map.forEach(((t,n)=>{if(!t.deleted){const r=t.content.getContent()[t.length-1];e[n]=r instanceof Wd?r.toJSON():r}})),e}get size(){return[...oh(this._map)].length}keys(){return du(oh(this._map),(e=>e[0]))}values(){return du(oh(this._map),(e=>e[1].content.getContent()[e[1].length-1]))}entries(){return du(oh(this._map),(e=>[e[0],e[1].content.getContent()[e[1].length-1]]))}forEach(e){this._map.forEach(((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)}))}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?bd(this.doc,(t=>{eh(t,this,e)})):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?bd(this.doc,(n=>{th(n,this,e,t)})):this._prelimContent.set(e,t),t}get(e){return nh(this,e)}has(e){return sh(this,e)}clear(){null!==this.doc?bd(this.doc,(e=>{this.forEach((function(t,n,r){eh(e,r,n)}))})):this._prelimContent.clear()}_write(e){e.writeTypeRef(Hh)}}const uh=(e,t)=>e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&((e,t)=>e===t||Fc(e)===Fc(t)&&((e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0})(e,((e,n)=>(void 0!==e||Dc(t,n))&&t[n]===e)))(e,t);class dh{constructor(e,t,n,r){this.left=e,this.right=t,this.index=n,this.currentAttributes=r}forward(){if(null===this.right&&rc(),this.right.content.constructor===zh)this.right.deleted||ph(this.currentAttributes,this.right.content);else this.right.deleted||(this.index+=this.right.length);this.left=this.right,this.right=this.right.right}}const hh=(e,t,n)=>{for(;null!==t.right&&n>0;){if(t.right.content.constructor===zh)t.right.deleted||ph(t.currentAttributes,t.right.content);else t.right.deleted||(n<t.right.length&&dd(e,Vu(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);t.left=t.right,t.right=t.right.right}return t},fh=(e,t,n,r)=>{const s=new Map,o=r?$d(t,n):null;if(o){const t=new dh(o.p.left,o.p,o.index,s);return hh(e,t,n-o.index)}{const r=new dh(null,t._start,0,s);return hh(e,r,n)}},gh=(e,t,n,r)=>{for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===zh&&uh(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const s=e.doc,o=s.clientID;r.forEach(((r,i)=>{const l=n.left,a=n.right,c=new rf(Vu(o,id(s.store,o)),l,l&&l.lastId,a,a&&a.id,t,null,new zh(i,r));c.integrate(e,0),n.right=c,n.forward()}))},ph=(e,t)=>{const{key:n,value:r}=t;null===r?e.delete(n):e.set(n,r)},mh=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===zh&&uh(t[e.right.content.key]??null,e.right.content.value));)e.forward()},_h=(e,t,n,r)=>{const s=e.doc,o=s.clientID,i=new Map;for(const l in r){const a=r[l],c=n.currentAttributes.get(l)??null;if(!uh(c,a)){i.set(l,c);const{left:r,right:u}=n;n.right=new rf(Vu(o,id(s.store,o)),r,r&&r.lastId,u,u&&u.id,t,null,new zh(l,a)),n.right.integrate(e,0),n.forward()}}return i},yh=(e,t,n,r,s)=>{n.currentAttributes.forEach(((e,t)=>{void 0===s[t]&&(s[t]=null)}));const o=e.doc,i=o.clientID;mh(n,s);const l=_h(e,t,n,s),a=r.constructor===String?new Kh(r):r instanceof Wd?new qh(r):new Bh(r);let{left:c,right:u,index:d}=n;t._searchMarker&&Ud(t._searchMarker,n.index,a.getLength()),u=new rf(Vu(i,id(o.store,i)),c,c&&c.lastId,u,u&&u.id,t,null,a),u.integrate(e,0),n.right=u,n.index=d,n.forward(),gh(e,t,n,l)},bh=(e,t,n,r,s)=>{const o=e.doc,i=o.clientID;mh(n,s);const l=_h(e,t,n,s);e:for(;null!==n.right&&(r>0||l.size>0&&(n.right.deleted||n.right.content.constructor===zh));){if(!n.right.deleted)switch(n.right.content.constructor){case zh:{const{key:t,value:o}=n.right.content,i=s[t];if(void 0!==i){if(uh(i,o))l.delete(t);else{if(0===r)break e;l.set(t,o)}n.right.delete(e)}else n.currentAttributes.set(t,o);break}default:r<n.right.length&&dd(e,Vu(n.right.id.client,n.right.id.clock+r)),r-=n.right.length}n.forward()}if(r>0){let s="";for(;r>0;r--)s+="\n";n.right=new rf(Vu(i,id(o.store,i)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new Kh(s)),n.right.integrate(e,0),n.forward()}gh(e,t,n,l)},wh=(e,t,n,r,s)=>{let o=t;const i=oa();for(;o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===zh){const e=o.content;i.set(e.key,e)}o=o.right}let l=0,a=!1;for(;t!==o;){if(n===t&&(a=!0),!t.deleted){const n=t.content;switch(n.constructor){case zh:{const{key:o,value:c}=n,u=r.get(o)??null;i.get(o)===n&&u!==c||(t.delete(e),l++,a||(s.get(o)??null)!==c||u===c||(null===u?s.delete(o):s.set(o,u))),a||t.deleted||ph(s,n);break}}}t=t.right}return l},xh=e=>{let t=0;return bd(e.doc,(n=>{let r=e._start,s=e._start,o=oa();const i=ia(o);for(;s;){if(!1===s.deleted)if(s.content.constructor===zh)ph(i,s.content);else t+=wh(n,r,s,o,i),o=ia(i),r=s;s=s.right}})),t},vh=e=>{const t=new Set,n=e.doc;for(const[r,s]of e.afterState.entries()){const o=e.beforeState.get(r)||0;s!==o&&fd(e,n.store.clients.get(r),o,s,(e=>{e.deleted||e.content.constructor!==zh||e.constructor===Dh||t.add(e.parent)}))}bd(n,(n=>{gu(e,e.deleteSet,(e=>{if(e instanceof Dh||!e.parent._hasFormatting||t.has(e.parent))return;const r=e.parent;e.content.constructor===zh?t.add(r):((e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const n=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===zh){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}})(n,e)}));for(const e of t)xh(e)}))},Sh=(e,t,n)=>{const r=n,s=ia(t.currentAttributes),o=t.right;for(;n>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case qh:case Bh:case Kh:n<t.right.length&&dd(e,Vu(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e)}t.forward()}o&&wh(e,o,t.right,s,t.currentAttributes);const i=(t.left||t.right).parent;return i._searchMarker&&Ud(i._searchMarker,t.index,-r+n),t};class Ch extends Ld{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach((e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)}))}get changes(){if(null===this._changes){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){const e=this.target.doc,t=[];bd(e,(e=>{const n=new Map,r=new Map;let s=this.target._start,o=null;const i={};let l="",a=0,c=0;const u=()=>{if(null!==o){let e=null;switch(o){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"==typeof l||l.length>0)&&(e={insert:l},n.size>0&&(e.attributes={},n.forEach(((t,n)=>{null!==t&&(e.attributes[n]=t)})))),l="";break;case"retain":a>0&&(e={retain:a},(e=>{for(const t in e)return!1;return!0})(i)||(e.attributes=Ac({},i))),a=0}e&&t.push(e),o=null}};for(;null!==s;){switch(s.content.constructor){case qh:case Bh:this.adds(s)?this.deletes(s)||(u(),o="insert",l=s.content.getContent()[0],u()):this.deletes(s)?("delete"!==o&&(u(),o="delete"),c+=1):s.deleted||("retain"!==o&&(u(),o="retain"),a+=1);break;case Kh:this.adds(s)?this.deletes(s)||("insert"!==o&&(u(),o="insert"),l+=s.content.str):this.deletes(s)?("delete"!==o&&(u(),o="delete"),c+=s.length):s.deleted||("retain"!==o&&(u(),o="retain"),a+=s.length);break;case zh:{const{key:t,value:l}=s.content;if(this.adds(s)){if(!this.deletes(s)){const a=n.get(t)??null;uh(a,l)?null!==l&&s.delete(e):("retain"===o&&u(),uh(l,r.get(t)??null)?delete i[t]:i[t]=l)}}else if(this.deletes(s)){r.set(t,l);const e=n.get(t)??null;uh(e,l)||("retain"===o&&u(),i[t]=e)}else if(!s.deleted){r.set(t,l);const n=i[t];void 0!==n&&(uh(n,l)?null!==n&&s.delete(e):("retain"===o&&u(),null===l?delete i[t]:i[t]=l))}s.deleted||("insert"===o&&u(),ph(n,s.content));break}}s=s.right}for(u();t.length>0;){const e=t[t.length-1];if(void 0===e.retain||void 0!==e.attributes)break;t.pop()}})),this._delta=t}return this._delta}}class kh extends Wd{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach((e=>e()))}catch(mw){console.error(mw)}this._pending=null}_copy(){return new kh}clone(){const e=new kh;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const n=new Ch(this,e,t);Kd(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===Kh&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?bd(this.doc,(n=>{const r=new dh(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const o=e[s];if(void 0!==o.insert){const i=t||"string"!=typeof o.insert||s!==e.length-1||null!==r.right||"\n"!==o.insert.slice(-1)?o.insert:o.insert.slice(0,-1);("string"!=typeof i||i.length>0)&&yh(n,this,r,i,o.attributes||{})}else void 0!==o.retain?bh(n,this,r,o.retain,o.attributes||{}):void 0!==o.delete&&Sh(n,r,o.delete)}})):this._pending.push((()=>this.applyDelta(e)))}toDelta(e,t,n){const r=[],s=new Map,o=this.doc;let i="",l=this._start;function a(){if(i.length>0){const e={};let t=!1;s.forEach(((n,r)=>{t=!0,e[r]=n}));const n={insert:i};t&&(n.attributes=e),r.push(n),i=""}}const c=()=>{for(;null!==l;){if(nd(l,e)||void 0!==t&&nd(l,t))switch(l.content.constructor){case Kh:{const r=s.get("ychange");void 0===e||nd(l,e)?void 0===t||nd(l,t)?void 0!==r&&(a(),s.delete("ychange")):void 0!==r&&r.user===l.id.client&&"added"===r.type||(a(),s.set("ychange",n?n("added",l.id):{type:"added"})):void 0!==r&&r.user===l.id.client&&"removed"===r.type||(a(),s.set("ychange",n?n("removed",l.id):{type:"removed"})),i+=l.content.str;break}case qh:case Bh:{a();const e={insert:l.content.getContent()[0]};if(s.size>0){const t={};e.attributes=t,s.forEach(((e,n)=>{t[n]=e}))}r.push(e);break}case zh:nd(l,e)&&(a(),ph(s,l.content))}l=l.right}a()};return e||t?bd(o,(n=>{e&&rd(n,e),t&&rd(n,t),c()}),"cleanup"):c(),r}insert(e,t,n){if(t.length<=0)return;const r=this.doc;null!==r?bd(r,(r=>{const s=fh(r,this,e,!n);n||(n={},s.currentAttributes.forEach(((e,t)=>{n[t]=e}))),yh(r,this,s,t,n)})):this._pending.push((()=>this.insert(e,t,n)))}insertEmbed(e,t,n){const r=this.doc;null!==r?bd(r,(r=>{const s=fh(r,this,e,!n);yh(r,this,s,t,n||{})})):this._pending.push((()=>this.insertEmbed(e,t,n||{})))}delete(e,t){if(0===t)return;const n=this.doc;null!==n?bd(n,(n=>{Sh(n,fh(n,this,e,!0),t)})):this._pending.push((()=>this.delete(e,t)))}format(e,t,n){if(0===t)return;const r=this.doc;null!==r?bd(r,(r=>{const s=fh(r,this,e,!1);null!==s.right&&bh(r,this,s,t,n)})):this._pending.push((()=>this.format(e,t,n)))}removeAttribute(e){null!==this.doc?bd(this.doc,(t=>{eh(t,this,e)})):this._pending.push((()=>this.removeAttribute(e)))}setAttribute(e,t){null!==this.doc?bd(this.doc,(n=>{th(n,this,e,t)})):this._pending.push((()=>this.setAttribute(e,t)))}getAttribute(e){return nh(this,e)}getAttributes(){return rh(this)}_write(e){e.writeTypeRef(Jh)}}class Eh{constructor(e,t=(()=>!0)){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==Nh&&t.constructor!==Th||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Th extends Wd{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Th}clone(){const e=new Th;return e.insert(0,this.toArray().map((e=>e instanceof Wd?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new Eh(this,e)}querySelector(e){e=e.toUpperCase();const t=new Eh(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),da(new Eh(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)))}_callObserver(e,t){Kd(this,e,new Rh(this,t,e))}toString(){return Vd(this,(e=>e.toString())).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},n){const r=e.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),Jd(this,(s=>{r.insertBefore(s.toDOM(e,t,n),null)})),r}insert(e,t){null!==this.doc?bd(this.doc,(n=>{Gd(n,this,e,t)})):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)bd(this.doc,(n=>{const r=e&&e instanceof Wd?e._item:e;Xd(n,this,r,t)}));else{const n=this._prelimContent,r=null===e?0:n.findIndex((t=>t===e))+1;if(0===r&&null!==e)throw tc("Reference item not found");n.splice(r,0,...t)}}delete(e,t=1){null!==this.doc?bd(this.doc,(n=>{Qd(n,this,e,t)})):this._prelimContent.splice(e,t)}toArray(){return Hd(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Zd(this,e)}slice(e=0,t=this.length){return jd(this,e,t)}forEach(e){Jd(this,e)}_write(e){e.writeTypeRef(Yh)}}class Nh extends Th{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach(((e,t)=>{this.setAttribute(t,e)})),this._prelimAttrs=null}_copy(){return new Nh(this.nodeName)}clone(){const e=new Nh(this.nodeName);return((e,t)=>{for(const n in e)t(e[n],n)})(this.getAttributes(),((t,n)=>{"string"==typeof t&&e.setAttribute(n,t)})),e.insert(0,this.toArray().map((e=>e instanceof Wd?e.clone():e))),e}toString(){const e=this.getAttributes(),t=[],n=[];for(const o in e)n.push(o);n.sort();const r=n.length;for(let o=0;o<r;o++){const r=n[o];t.push(r+'="'+e[r]+'"')}const s=this.nodeName.toLocaleLowerCase();return`<${s}${t.length>0?" "+t.join(" "):""}>${super.toString()}</${s}>`}removeAttribute(e){null!==this.doc?bd(this.doc,(t=>{eh(t,this,e)})):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?bd(this.doc,(n=>{th(n,this,e,t)})):this._prelimAttrs.set(e,t)}getAttribute(e){return nh(this,e)}hasAttribute(e){return sh(this,e)}getAttributes(e){return e?((e,t)=>{const n={};return e._map.forEach(((e,r)=>{let s=e;for(;null!==s&&(!t.sv.has(s.id.client)||s.id.clock>=(t.sv.get(s.id.client)||0));)s=s.left;null!==s&&nd(s,t)&&(n[r]=s.content.getContent()[s.length-1])})),n})(this,e):rh(this)}toDOM(e=document,t={},n){const r=e.createElement(this.nodeName),s=this.getAttributes();for(const o in s){const e=s[o];"string"==typeof e&&r.setAttribute(o,e)}return Jd(this,(s=>{r.appendChild(s.toDOM(e,t,n))})),void 0!==n&&n._createAssociation(r,this),r}_write(e){e.writeTypeRef(Vh),e.writeKey(this.nodeName)}}class Rh extends Ld{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach((e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)}))}}class Ah extends ch{constructor(e){super(),this.hookName=e}_copy(){return new Ah(this.hookName)}clone(){const e=new Ah(this.hookName);return this.forEach(((t,n)=>{e.set(n,t)})),e}toDOM(e=document,t={},n){const r=t[this.hookName];let s;return s=void 0!==r?r.createDom(this):document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(s,this),s}_write(e){e.writeTypeRef(Zh),e.writeKey(this.hookName)}}class Oh extends kh{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Oh}clone(){const e=new Oh;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,n){const r=e.createTextNode(this.toString());return void 0!==n&&n._createAssociation(r,this),r}toString(){return this.toDelta().map((e=>{const t=[];for(const r in e.attributes){const n=[];for(const t in e.attributes[r])n.push({key:t,value:e.attributes[r][t]});n.sort(((e,t)=>e.key<t.key?-1:1)),t.push({nodeName:r,attrs:n})}t.sort(((e,t)=>e.nodeName<t.nodeName?-1:1));let n="";for(let r=0;r<t.length;r++){const e=t[r];n+=`<${e.nodeName}`;for(let t=0;t<e.attrs.length;t++){const r=e.attrs[t];n+=` ${r.key}="${r.value}"`}n+=">"}n+=e.insert;for(let r=t.length-1;r>=0;r--)n+=`</${t[r].nodeName}>`;return n})).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Xh)}}class Fh{constructor(e,t){this.id=e,this.length=t}get deleted(){throw nc()}mergeWith(e){return!1}write(e,t,n){throw nc()}integrate(e,t){throw nc()}}class Dh extends Fh{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),ld(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class Ph{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Ph(this.content)}splice(e){throw nc()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class Lh{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Lh(this.len)}splice(e){const t=new Lh(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){yu(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const Ih=(e,t)=>new Cu({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Mh{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Mh(Ih(this.doc.guid,this.opts))}splice(e){throw nc()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class Bh{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Bh(this.embed)}splice(e){throw nc()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class zh{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new zh(this.key,this.value)}splice(e){throw nc()}mergeWith(e){return!1}integrate(e,t){const n=t.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class $h{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new $h(this.arr)}splice(e){const t=new $h(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let r=t;r<n;r++){const t=this.arr[r];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}class Uh{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Uh(this.arr)}splice(e){const t=new Uh(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let r=t;r<n;r++){const t=this.arr[r];e.writeAny(t)}}getRef(){return 8}}class Kh{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Kh(this.str)}splice(e){const t=new Kh(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"�",t.str="�"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}const Wh=[e=>new lh,e=>new ch,e=>new kh,e=>new Nh(e.readKey()),e=>new Th,e=>new Ah(e.readKey()),e=>new Oh],jh=0,Hh=1,Jh=2,Vh=3,Yh=4,Zh=5,Xh=6;class qh{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new qh(this.type._copy())}splice(e){throw nc()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach((t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)})),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach((t=>{for(;null!==t;)t.gc(e,!0),t=t.left})),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const Gh=(e,t)=>{let n,r=t,s=0;do{s>0&&(r=Vu(r.client,r.clock+s)),n=cd(e,r),s=r.clock-n.id.clock,r=n.redone}while(null!==r&&n instanceof rf);return{item:n,diff:s}},Qh=(e,t)=>{for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},ef=(e,t,n)=>{const{client:r,clock:s}=t.id,o=new rf(Vu(r,s+n),t,Vu(r,s+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&o.markDeleted(),t.keep&&(o.keep=!0),null!==t.redone&&(o.redone=Vu(t.redone.client,t.redone.clock+n)),t.right=o,null!==o.right&&(o.right.left=o),e._mergeStructs.push(o),null!==o.parentSub&&null===o.right&&o.parent._map.set(o.parentSub,o),t.length=n,o},tf=(e,t)=>((e,t)=>{for(let n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1})(e,(e=>pu(e.deletions,t))),nf=(e,t,n,r,s,o)=>{const i=e.doc,l=i.store,a=i.clientID,c=t.redone;if(null!==c)return dd(e,c);let u,d=t.parent._item,h=null;if(null!==d&&!0===d.deleted){if(null===d.redone&&(!n.has(d)||null===nf(e,d,n,r,s,o)))return null;for(;null!==d.redone;)d=dd(e,d.redone)}const f=null===d?t.parent:d.content.type;if(null===t.parentSub){for(h=t.left,u=t;null!==h;){let t=h;for(;null!==t&&t.parent._item!==d;)t=null===t.redone?null:dd(e,t.redone);if(null!==t&&t.parent._item===d){h=t;break}h=h.left}for(;null!==u;){let t=u;for(;null!==t&&t.parent._item!==d;)t=null===t.redone?null:dd(e,t.redone);if(null!==t&&t.parent._item===d){u=t;break}u=u.right}}else if(u=null,t.right&&!s){for(h=t;null!==h&&null!==h.right&&(h.right.redone||pu(r,h.right.id)||tf(o.undoStack,h.right.id)||tf(o.redoStack,h.right.id));)for(h=h.right;h.redone;)h=dd(e,h.redone);if(h&&null!==h.right)return null}else h=f._map.get(t.parentSub)||null;const g=id(l,a),p=Vu(a,g),m=new rf(p,h,h&&h.lastId,u,u&&u.id,f,t.parentSub,t.content.copy());return t.redone=p,Qh(m,!0),m.integrate(e,0),m};class rf extends Fh{constructor(e,t,n,r,s,o,i,l){super(e,l.getLength()),this.origin=n,this.left=t,this.right=r,this.rightOrigin=s,this.parent=o,this.parentSub=i,this.redone=null,this.content=l,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=id(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=id(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Hu&&this.id.client!==this.parent.client&&this.parent.clock>=id(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=hd(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=dd(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Dh||this.right&&this.right.constructor===Dh)this.parent=null;else if(this.parent){if(this.parent.constructor===Hu){const e=cd(t,this.parent);e.constructor===Dh?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===rf&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===rf&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=hd(e,e.doc.store,Vu(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,n=this.left;if(null!==n)t=n.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;const r=new Set,s=new Set;for(;null!==t&&t!==this.right;){if(s.add(t),r.add(t),Ju(this.origin,t.origin)){if(t.id.client<this.id.client)n=t,r.clear();else if(Ju(this.rightOrigin,t.rightOrigin))break}else{if(null===t.origin||!s.has(cd(e.doc.store,t.origin)))break;r.has(cd(e.doc.store,t.origin))||(n=t,r.clear())}t=t.right}this.left=n}if(null!==this.left){const e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),ld(e.doc.store,this),this.content.integrate(e,this),md(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new Dh(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:Vu(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&Ju(e.origin,this.lastId)&&this.right===e&&Ju(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach((t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))})),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),yu(e.deleteSet,this.id.client,this.id.clock,this.length),md(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw rc();this.content.gc(e),t?((e,t,n)=>{const r=e.clients.get(t.id.client);r[ad(r,t.id.clock)]=n})(e,this,new Dh(this.id,this.length)):this.content=new Lh(this.length)}write(e,t){const n=t>0?Vu(this.id.client,this.id.clock+t-1):this.origin,r=this.rightOrigin,s=this.parentSub,o=31&this.content.getRef()|(null===n?0:va)|(null===r?0:xa)|(null===s?0:32);if(e.writeInfo(o),null!==n&&e.writeLeftID(n),null!==r&&e.writeRightID(r),null===n&&null===r){const t=this.parent;if(void 0!==t._item){const n=t._item;if(null===n){const n=Yu(t);e.writeParentInfo(!0),e.writeString(n)}else e.writeParentInfo(!1),e.writeLeftID(n.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===Hu?(e.writeParentInfo(!1),e.writeLeftID(t)):rc();null!==s&&e.writeString(s)}this.content.write(e,t)}}const sf=(e,t)=>of[31&t](e),of=[()=>{rc()},e=>new Lh(e.readLen()),e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const t=e.readString();"undefined"===t?n.push(void 0):n.push(JSON.parse(t))}return new $h(n)},e=>new Ph(e.readBuf()),e=>new Kh(e.readString()),e=>new Bh(e.readJSON()),e=>new zh(e.readKey(),e.readJSON()),e=>new qh(Wh[e.readTypeRef()](e)),e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new Uh(n)},e=>new Mh(Ih(e.readString(),e.readAny())),()=>{rc()}];class lf extends Fh{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){rc()}write(e,t){e.writeInfo(10),za(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const af="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},cf="__ $YJS$ __";!0===af[cf]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),af[cf]=!0;var uf=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};let df=class{constructor(e,t,n=1){this._offsetMap=e,this._firstNode=t,this._blockOffsetSize=n}createSelectionFromOffsets(e,t,n){const r=this._firstNode;if(null===r)return null;let s=e,o=t,i=ff(r,s,this._blockOffsetSize),l=ff(r,o,this._blockOffsetSize);if(void 0!==n&&(s=hf(s,i,n,this,this._blockOffsetSize),i=ff(r,s,this._blockOffsetSize),o=hf(o,l,n,this,this._blockOffsetSize),l=ff(r,o,this._blockOffsetSize)),null===i||null===l)return null;let a=i.key,c=l.key;const u=vt(a),d=vt(c);if(null===u||null===d)return null;let h=0,f=0,g="element",p="element";if("text"===i.type){h=s-i.start,g="text";const e=u.getNextSibling();s!==o&&h===u.getTextContentSize()&&Ur(e)&&(h=0,a=e.__key)}else"inline"===i.type&&(a=u.getParentOrThrow().getKey(),h=o>i.start?i.end:i.start);"text"===l.type?(f=o-l.start,p="text"):"inline"===l.type&&(c=d.getParentOrThrow().getKey(),f=o>l.start?l.end:l.start);const m=cs();return null===m?null:(m.anchor.set(a,h,g),m.focus.set(c,f,p),m)}getOffsetsFromSelection(e){const t=e.anchor,n=e.focus,r=this._offsetMap,s=t.offset,o=n.offset;let i=-1,l=-1;if("text"===t.type){const e=r.get(t.key);void 0!==e&&(i=e.start+s)}else{const e=t.getNode().getDescendantByIndex(s);if(null!==e){const t=r.get(e.getKey());void 0!==t&&(i=e.getIndexWithinParent()!==s?t.end:t.start)}}if("text"===n.type){const e=r.get(n.key);void 0!==e&&(l=e.start+n.offset)}else{const e=n.getNode().getDescendantByIndex(o);if(null!==e){const t=r.get(e.getKey());void 0!==t&&(l=e.getIndexWithinParent()!==o?t.end:t.start)}}return[i,l]}};function hf(e,t,n,r,s){const o=n._offsetMap,i=r._offsetMap,l=new Set;let a=e,c=t;for(;null!==c;){const e=c.key,t=o.get(e),n=c.end-c.start;if(l.add(e),void 0===t)a+=n;else{const e=t.end-t.start;e!==n&&(a+=n-e)}const r=c.prev;if(null!==r){c=r;continue}let s=c.parent;for(;null!==s;){let e=s.prev;if(null!==e){const t=e.key,n=o.get(t),r=e.end-e.start;if(l.add(t),void 0===n)a+=r;else{const e=n.end-n.start;e!==r&&(a+=r-e)}e=e.prev}s=s.parent}break}const u=n._firstNode;if(null!==u){c=ff(u,e,s);let t=!1;for(;null!==c;){if(!l.has(c.key)){t=!0;break}c=c.parent}if(!t)for(;null!==c;){const e=c.key;if(!l.has(e)){const t=i.get(e),n=c.end-c.start;if(void 0===t)a-=n;else{const e=t.end-t.start;n!==e&&(a+=e-n)}}c=c.prev}}return a}function ff(e,t,n){let r=e;for(;null!==r;){if(t<r.end+("element"!==r.type||0===n?1:0)){const e=r.child;if(null!==e){r=e;continue}return r}const e=r.next;if(null===e)break;r=e}return null}function gf(e,t,n,r,s,o){return{child:e,end:r,key:s,next:null,parent:o,prev:null,start:n,type:t}}function pf(e,t,n,r,s,o){const i=r.get(t);void 0===i&&uf(3);const l=e.offset;if(Js(i)){const a=_f(i,r),c=0===a.length,u=c?null:mf(e,a,null,r,s,o);e.prevIsBlock&&!c||(e.prevIsBlock=!0,e.offset+=o);const d=gf(u,"element",l,l,t,n);null!==u&&(u.parent=d);const h=e.offset;return d.end=h,s.set(t,d),d}e.prevIsBlock=!1;const a=Ur(i),c=a?i.__text.length:1,u=gf(null,a?"text":"inline",l,e.offset+=c,t,n);return s.set(t,u),u}function mf(e,t,n,r,s,o){let i=null,l=null;const a=t.length;for(let c=0;c<a;c++){const a=pf(e,t[c],n,r,s,o);null===l?i=a:(a.prev=l,l.next=a),l=a}return i}function _f(e,t){const n=[];let r=e.__first;for(;null!==r;){const e=null===t?vt(r):t.get(r);null==e&&uf(101),n.push(r),r=e.__next}return n}function yf(e,t=1,n){const r=(n||e._pendingEditorState||e._editorState)._nodeMap,s=r.get("root"),o=new Map,i=mf({offset:0,prevIsBlock:!1},_f(s,r),null,r,o,t);return new df(o,i,t)}var bf=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};let wf=class{constructor(e,t){this._key="",this._map=e,this._parent=t,this._type="linebreak"}getNode(){const e=vt(this._key);return vr(e)?e:null}getKey(){return this._key}getSharedType(){return this._map}getType(){return this._type}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}destroy(e){e.collabNodeMap.delete(this._key)}};function xf(e,t){const n=new wf(e,t);return e._collabNode=n,n}let vf=class{constructor(e,t,n,r){this._key="",this._map=e,this._parent=n,this._text=t,this._type=r,this._normalized=!1}getPrevNode(e){if(null===e)return null;const t=e.get(this._key);return Ur(t)?t:null}getNode(){const e=vt(this._key);return Ur(e)?e:null}getSharedType(){return this._map}getType(){return this._type}getKey(){return this._key}getSize(){return this._text.length+(this._normalized?0:1)}getOffset(){return this._parent.getChildOffset(this)}spliceText(e,t,n){const r=this._parent._xmlText,s=this.getOffset()+1+e;0!==t&&r.delete(s,t),""!==n&&r.insert(s,n)}syncPropertiesAndTextFromLexical(e,t,n){const r=this.getPrevNode(n),s=t.__text;if(Pf(e,this._map,r,t),null!==r){const e=r.__text;e!==s&&(!function(e,t,n,r){const s=hs();let o=r.length;if(Gr(s)&&s.isCollapsed()){const e=s.anchor;e.key===t&&(o=e.offset)}const i=function(e,t,n){const r=e.length,s=t.length;let o=0,i=0;for(;o<r&&o<s&&e[o]===t[o]&&o<n;)o++;for(;i+o<r&&i+o<s&&e[r-i-1]===t[s-i-1];)i++;for(;i+o<r&&i+o<s&&e[o]===t[o];)o++;return{index:o,insert:t.slice(o,s-i),remove:r-o-i}}(n,r,o);e.spliceText(i.index,i.remove,i.insert)}(this,t.__key,e,s),this._text=s)}}syncPropertiesAndTextFromYjs(e,t){const n=this.getNode();null===n&&bf(84),Df(e,this._map,n,t);const r=this._text;n.__text!==r&&(n.getWritable().__text=r)}destroy(e){e.collabNodeMap.delete(this._key)}};function Sf(e,t,n,r){const s=new vf(e,t,n,r);return e._collabNode=s,s}const Cf=new Set(["__key","__parent","__next","__prev"]),kf=new Set(["__first","__last","__size"]),Ef=new Set(["__cachedText"]),Tf=new Set(["__text"]);function Nf(e,t,n){if(Cf.has(e))return!0;if(Ur(t)){if(Tf.has(e))return!0}else if(Js(t)&&(kf.has(e)||Zs(t)&&Ef.has(e)))return!0;const r=t.constructor,s=n.excludedProperties.get(r);return null!=s&&s.has(e)}function Rf(e){const t=vt(e);return null===t&&bf(85),t}function Af(e,t,n){const r=t.__type;let s;if(Js(t))s=Wf(new Oh,n,r),s.syncPropertiesFromLexical(e,t,null),s.syncChildrenFromLexical(e,t,null,null,null);else if(Ur(t))s=Sf(new ch,t.__text,n,r),s.syncPropertiesAndTextFromLexical(e,t,null);else if(vr(t)){const e=new ch;e.set("__type","linebreak"),s=xf(e,n)}else js(t)?(s=Uf(new Nh,n,r),s.syncPropertiesFromLexical(e,t,null)):bf(86);return s._key=t.__key,s}function Of(e,t,n){const r=t._collabNode;if(void 0===r){const r=e.editor._nodes,s=function(e){const t=e instanceof ch?e.get("__type"):e.getAttribute("__type");return null==t&&bf(87),t}(t);void 0===r.get(s)&&bf(88,s);const o=t.parent,i=void 0===n&&null!==o?Of(e,o):n||null;if(i instanceof Kf||bf(89),t instanceof Oh)return Wf(t,i,s);if(t instanceof ch)return"linebreak"===s?xf(t,i):Sf(t,"",i,s);if(t instanceof Nh)return Uf(t,i,s)}return r}function Ff(e,t,n){const r=t.getType(),s=e.editor._nodes.get(r);void 0===s&&bf(88,r);const o=new s.klass;if(o.__parent=n,t._key=o.__key,t instanceof Kf){const n=t._xmlText;t.syncPropertiesFromYjs(e,null),t.applyChildrenYjsDelta(e,n.toDelta()),t.syncChildrenFromYjs(e)}else t instanceof vf?t.syncPropertiesAndTextFromYjs(e,null):t instanceof $f&&t.syncPropertiesFromYjs(e,null);return e.collabNodeMap.set(o.__key,t),o}function Df(e,t,n,r){const s=null===r?t instanceof ch?Array.from(t.keys()):Object.keys(t.getAttributes()):Array.from(r);let o;for(let i=0;i<s.length;i++){const r=s[i];if(Nf(r,n,e))continue;const l=n[r];let a=t instanceof ch?t.get(r):t.getAttribute(r);if(l!==a){if(a instanceof Cu){const t=e.docMap;l instanceof Cu&&t.delete(l.guid);const n=co(),r=a.guid;n._key=r,t.set(r,a),a=n}void 0===o&&(o=n.getWritable()),o[r]=a}}}function Pf(e,t,n,r){const s=r.__type,o=e.nodeProperties;let i=o.get(s);void 0===i&&(i=Object.keys(r).filter((t=>!Nf(t,r,e))),o.set(s,i));const l=e.editor.constructor;for(let a=0;a<i.length;a++){const s=i[a],o=null===n?void 0:n[s];let c=r[s];if(o!==c){if(c instanceof l){const t=e.docMap;let n;if(o instanceof l){const e=o._key;n=t.get(e),t.delete(e)}const s=n||new Cu,i=s.guid;c._key=i,t.set(i,s),c=s,e.editor.update((()=>{r.markDirty()}))}t instanceof ch?t.set(s,c):t.setAttribute(s,c)}}}function Lf(e,t,n,r){return e.slice(0,t)+r+e.slice(t+n)}function If(e,t,n){let r=0,s=0;const o=e._children,i=o.length;for(;s<i;s++){const e=o[s],l=r;if(r+=e.getSize(),(n?r>=t:r>t)&&e instanceof vf){let n=t-l-1;return n<0&&(n=0),{length:r-t,node:e,nodeIndex:s,offset:n}}if(r>t)return{length:0,node:e,nodeIndex:s,offset:l};if(s===i-1)return{length:0,node:null,nodeIndex:s+1,offset:l+1}}return{length:0,node:null,nodeIndex:0,offset:0}}function Mf(e){const t=e.anchor,n=e.focus;let r=!1;try{const e=t.getNode(),s=n.getNode();(!e.isAttached()||!s.isAttached()||Ur(e)&&t.offset>e.getTextContentSize()||Ur(s)&&n.offset>s.getTextContentSize())&&(r=!0)}catch(s){r=!0}return r}function Bf(e,t){const n=[];let r=e.__first;for(;null!==r;){const e=null===t?vt(r):t.get(r);null==e&&bf(101),n.push(r),r=e.__next}return n}function zf(e){const t=e.getParent();if(null!==t){const n=e.getWritable(),r=t.getWritable(),s=e.getPreviousSibling(),o=e.getNextSibling();if(null===s)if(null!==o){const e=o.getWritable();r.__first=o.__key,e.__prev=null}else r.__first=null;else{const e=s.getWritable();if(null!==o){const t=o.getWritable();t.__prev=e.__key,e.__next=t.__key}else e.__next=null;n.__prev=null}if(null===o)if(null!==s){const e=s.getWritable();r.__last=s.__key,e.__next=null}else r.__last=null;else{const e=o.getWritable();if(null!==s){const t=s.getWritable();t.__next=e.__key,e.__prev=t.__key}else e.__prev=null;n.__next=null}r.__size--,n.__parent=null}}let $f=class{constructor(e,t,n){this._key="",this._xmlElem=e,this._parent=t,this._type=n}getPrevNode(e){if(null===e)return null;const t=e.get(this._key);return js(t)?t:null}getNode(){const e=vt(this._key);return js(e)?e:null}getSharedType(){return this._xmlElem}getType(){return this._type}getKey(){return this._key}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}syncPropertiesFromLexical(e,t,n){const r=this.getPrevNode(n);Pf(e,this._xmlElem,r,t)}syncPropertiesFromYjs(e,t){const n=this.getNode();null===n&&bf(83),Df(e,this._xmlElem,n,t)}destroy(e){e.collabNodeMap.delete(this._key)}};function Uf(e,t,n){const r=new $f(e,t,n);return e._collabNode=r,r}let Kf=class e{constructor(e,t,n){this._key="",this._children=[],this._xmlText=e,this._type=n,this._parent=t}getPrevNode(e){if(null===e)return null;const t=e.get(this._key);return Js(t)?t:null}getNode(){const e=vt(this._key);return Js(e)?e:null}getSharedType(){return this._xmlText}getType(){return this._type}getKey(){return this._key}isEmpty(){return 0===this._children.length}getSize(){return 1}getOffset(){const e=this._parent;return null===e&&bf(90),e.getChildOffset(this)}syncPropertiesFromYjs(e,t){const n=this.getNode();null===n&&bf(91),Df(e,this._xmlText,n,t)}applyChildrenYjsDelta(t,n){const r=this._children;let s=0;for(let o=0;o<n.length;o++){const i=n[o],l=i.insert,a=i.delete;if(null!=i.retain)s+=i.retain;else if("number"==typeof a){let t=a;for(;t>0;){const{node:n,nodeIndex:o,offset:i,length:l}=If(this,s,!1);if(n instanceof e||n instanceof wf||n instanceof $f)r.splice(o,1),t-=1;else{if(!(n instanceof vf))break;{const e=Math.min(t,l),s=0!==o?r[o-1]:null,a=n.getSize();0===i&&1===e&&o>0&&s instanceof vf&&l===a&&0===Array.from(n._map.keys()).length?(s._text+=n._text,r.splice(o,1)):0===i&&e===a?r.splice(o,1):n._text=Lf(n._text,i,e,""),t-=e}}}}else{if(null==l)throw new Error("Unexpected delta format");if("string"==typeof l){const{node:e,offset:t}=If(this,s,!0);e instanceof vf?e._text=Lf(e._text,t,0,l):this._xmlText.delete(t,l.length),s+=l.length}else{const e=l,{nodeIndex:n}=If(this,s,!1),o=Of(t,e,this);r.splice(n,0,o),s+=1}}}}syncChildrenFromYjs(t){const n=this.getNode();null===n&&bf(92);const r=n.__key,s=Bf(n,null),o=s.length,i=this._children,l=i.length,a=t.collabNodeMap,c=new Set;let u,d,h=0,f=null;l!==o&&(d=n.getWritable());for(let g=0;g<l;g++){const o=s[h],p=i[g],m=p.getNode(),_=p._key;if(null!==m&&o===_){const n=Ur(m);if(c.add(o),n)if(p._key=o,p instanceof e){const e=p._xmlText;p.syncPropertiesFromYjs(t,null),p.applyChildrenYjsDelta(t,e.toDelta()),p.syncChildrenFromYjs(t)}else p instanceof vf?p.syncPropertiesAndTextFromYjs(t,null):p instanceof $f?p.syncPropertiesFromYjs(t,null):p instanceof wf||bf(93);f=m,h++}else{if(void 0===u){u=new Set;for(let e=0;e<l;e++){const t=i[e]._key;""!==t&&u.add(t)}}if(null!==m&&void 0!==o&&!u.has(o)){zf(Rf(o)),g--,h++;continue}d=n.getWritable();const e=Ff(t,p,r),s=e.__key;if(a.set(s,p),null===f){const t=d.getFirstChild();if(d.__first=s,null!==t){const n=t.getWritable();n.__prev=s,e.__next=n.__key}}else{const t=f.getWritable(),n=f.getNextSibling();if(t.__next=s,e.__prev=f.__key,null!==n){const t=n.getWritable();t.__prev=s,e.__next=t.__key}}g===l-1&&(d.__last=s),d.__size++,f=e}}for(let e=0;e<o;e++){const n=s[e];if(!c.has(n)){const e=Rf(n),r=t.collabNodeMap.get(n);void 0!==r&&r.destroy(t),zf(e)}}}syncPropertiesFromLexical(e,t,n){Pf(e,this._xmlText,this.getPrevNode(n),t)}_syncChildFromLexical(t,n,r,s,o,i){const l=this._children[n],a=Rf(r);l instanceof e&&Js(a)?(l.syncPropertiesFromLexical(t,a,s),l.syncChildrenFromLexical(t,a,s,o,i)):l instanceof vf&&Ur(a)?l.syncPropertiesAndTextFromLexical(t,a,s):l instanceof $f&&js(a)&&l.syncPropertiesFromLexical(t,a,s)}syncChildrenFromLexical(e,t,n,r,s){const o=this.getPrevNode(n),i=null===o?[]:Bf(o,n),l=Bf(t,null),a=i.length-1,c=l.length-1,u=e.collabNodeMap;let d,h,f=0,g=0;for(;f<=a&&g<=c;){const t=i[f],o=l[g];if(t===o)this._syncChildFromLexical(e,g,o,n,r,s),f++,g++;else{void 0===d&&(d=new Set(i)),void 0===h&&(h=new Set(l));const n=h.has(t),r=d.has(o);if(n){const t=Af(e,Rf(o),this);u.set(o,t),r?(this.splice(e,g,1,t),f++,g++):(this.splice(e,g,0,t),g++)}else this.splice(e,g,1),f++}}const p=f>a,m=g>c;if(p&&!m)for(;g<=c;++g){const t=l[g],n=Af(e,Rf(t),this);this.append(n),u.set(t,n)}else if(m&&!p)for(let _=this._children.length-1;_>=g;_--)this.splice(e,_,1)}append(t){const n=this._xmlText,r=this._children,s=r[r.length-1],o=void 0!==s?s.getOffset()+s.getSize():0;if(t instanceof e)n.insertEmbed(o,t._xmlText);else if(t instanceof vf){const e=t._map;null===e.parent&&n.insertEmbed(o,e),n.insert(o+1,t._text)}else t instanceof wf?n.insertEmbed(o,t._map):t instanceof $f&&n.insertEmbed(o,t._xmlElem);this._children.push(t)}splice(t,n,r,s){const o=this._children,i=o[n];if(void 0===i)return void 0===s&&bf(94),void this.append(s);const l=i.getOffset();-1===l&&bf(95);const a=this._xmlText;if(0!==r&&a.delete(l,i.getSize()),s instanceof e)a.insertEmbed(l,s._xmlText);else if(s instanceof vf){const e=s._map;null===e.parent&&a.insertEmbed(l,e),a.insert(l+1,s._text)}else s instanceof wf?a.insertEmbed(l,s._map):s instanceof $f&&a.insertEmbed(l,s._xmlElem);if(0!==r){const e=o.slice(n,n+r);for(let n=0;n<e.length;n++)e[n].destroy(t)}void 0!==s?o.splice(n,r,s):o.splice(n,r)}getChildOffset(e){let t=0;const n=this._children;for(let r=0;r<n.length;r++){const s=n[r];if(s===e)return t;t+=s.getSize()}return-1}destroy(e){const t=e.collabNodeMap,n=this._children;for(let r=0;r<n.length;r++)n[r].destroy(e);t.delete(this._key)}};function Wf(e,t,n){const r=new Kf(e,t,n);return e._collabNode=r,r}function jf(e,t){const n=t.collabNodeMap.get(e.key);if(void 0===n)return null;let r=e.offset,s=n.getSharedType();if(n instanceof vf){s=n._parent._xmlText;const e=n.getOffset();if(-1===e)return null;r=e+1+r}else if(n instanceof Kf&&"element"===e.type){const t=e.getNode();if(!Js(t))throw Error("Element point must be an element node");let n=0,s=0,o=t.getFirstChild();for(;null!==o&&s++<r;)Ur(o)?n+=o.getTextContentSize()+1:n++,o=o.getNextSibling();r=n}return Qu(s,r)}function Hf(e,t){return ed(e,t.doc)}function Jf(e,t){if(null==e){if(null!=t)return!0}else if(null==t||!td(e,t))return!0;return!1}function Vf(e,t){return{color:t,name:e,selection:null}}function Yf(e,t){const n=e.cursorsContainer;if(null!==n){const e=t.selections,r=e.length;for(let t=0;t<r;t++)n.removeChild(e[t])}}function Zf(e,t){const n=t.selection;null!==n&&Yf(e,n)}function Xf(e,t,n,r,s){const o=e.color,i=document.createElement("span");i.style.cssText=`position:absolute;top:0;bottom:0;right:-1px;width:1px;background-color:${o};z-index:10;`;const l=document.createElement("span");return l.textContent=e.name,l.style.cssText=`position:absolute;left:-2px;top:-16px;background-color:${o};color:#fff;line-height:12px;font-size:12px;padding:2px;font-family:Arial;font-weight:bold;white-space:nowrap;`,i.appendChild(l),{anchor:{key:t,offset:n},caret:i,color:o,focus:{key:r,offset:s},name:l,selections:[]}}function qf(e,t,n,r){const s=e.editor,o=s.getRootElement(),i=e.cursorsContainer;if(null===i||null===o)return;const l=i.offsetParent;if(null===l)return;const a=l.getBoundingClientRect(),c=t.selection;if(null===n)return null===c?void 0:(t.selection=null,void Yf(e,c));t.selection=n;const u=n.caret,d=n.color,h=n.selections,f=n.anchor,g=n.focus,p=f.key,m=g.key,_=r.get(p),y=r.get(m);if(null==_||null==y)return;let b;if(_===y&&vr(_))b=[s.getElementByKey(p).getBoundingClientRect()];else{const e=po(s,_,f.offset,y,g.offset);if(null===e)return;b=mo(s,e)}const w=h.length,x=b.length;for(let v=0;v<x;v++){const e=b[v];let t=h[v];if(void 0===t){t=document.createElement("span"),h[v]=t;const e=document.createElement("span");t.appendChild(e),i.appendChild(t)}const n=`position:absolute;top:${e.top-a.top}px;left:${e.left-a.left}px;height:${e.height}px;width:${e.width}px;pointer-events:none;z-index:5;`;t.style.cssText=n,t.firstChild.style.cssText=`${n}left:0;top:0;background-color:${d};opacity:0.3;`,v===x-1&&u.parentNode!==t&&t.appendChild(u)}for(let v=w-1;v>=x;v--){const e=h[v];i.removeChild(e),h.pop()}}function Gf(e,t){const n=t.awareness.getLocalState();if(null===n)return;const r=n.anchorPos,s=n.focusPos;if(null!==r&&null!==s){const t=Hf(r,e),n=Hf(s,e);if(null!==t&&null!==n){const[e,r]=eg(t.type,t.index),[s,o]=eg(n.type,n.index);if(null!==e&&null!==s){const t=e.getKey(),n=s.getKey(),i=hs();if(!Gr(i))return;const l=i.anchor,a=i.focus;Qf(l,t,r),Qf(a,n,o)}}}}function Qf(e,t,n){if(e.key!==t||e.offset!==n){let r=vt(t);if(null!==r&&!Js(r)&&!Ur(r)){const e=r.getParentOrThrow();t=e.getKey(),n=r.getIndexWithinParent(),r=e}e.set(t,n,Js(r)?"element":"text")}}function eg(e,t){const n=e._collabNode;if(void 0===n)return[null,0];if(n instanceof Kf){const{node:e,offset:r}=If(n,t,!0);return null===e?[n,0]:[e,r]}return[null,0]}function tg(e,t){const n=Array.from(t.awareness.getStates()),r=e.clientID,s=e.cursors,o=e.editor._editorState._nodeMap,i=new Set;for(let a=0;a<n.length;a++){const t=n[a],[l,c]=t;if(l!==r){i.add(l);const{anchorPos:t,focusPos:n,name:r,color:a,focusing:u}=c;let d=null,h=s.get(l);if(void 0===h&&(h=Vf(r,a),s.set(l,h)),null!==t&&null!==n&&u){const r=Hf(t,e),s=Hf(n,e);if(null!==r&&null!==s){const[e,t]=eg(r.type,r.index),[n,o]=eg(s.type,s.index);if(null!==e&&null!==n){const r=e.getKey(),s=n.getKey();if(d=h.selection,null===d)d=Xf(h,r,t,s,o);else{const e=d.anchor,n=d.focus;e.key=r,e.offset=t,n.key=s,n.offset=o}}}}qf(e,h,d,o)}}const l=Array.from(s.keys());for(let a=0;a<l.length;a++){const t=l[a];if(!i.has(t)){const n=s.get(t);void 0!==n&&(Zf(e,n),s.delete(t))}}}function ng(e,t,n,r){const s=t.awareness,o=s.getLocalState();if(null===o)return;const{anchorPos:i,focusPos:l,name:a,color:c,focusing:u,awarenessData:d}=o;let h=null,f=null;(null!==r&&(null===i||r.is(n))||null!==n)&&(Gr(r)&&(h=jf(r.anchor,e),f=jf(r.focus,e)),(Jf(i,h)||Jf(l,f))&&s.setLocalState({anchorPos:h,awarenessData:d,color:c,focusPos:f,focusing:u,name:a}))}function rg(e,t){const{target:n}=t,r=Of(e,n);if(r instanceof Kf&&t instanceof Ch){const{keysChanged:n,childListChanged:s,delta:o}=t;n.size>0&&r.syncPropertiesFromYjs(e,n),s&&(r.applyChildrenYjsDelta(e,o),r.syncChildrenFromYjs(e))}else if(r instanceof vf&&t instanceof ah){const{keysChanged:n}=t;n.size>0&&r.syncPropertiesAndTextFromYjs(e,n)}else if(r instanceof $f&&t instanceof Rh){const{attributesChanged:n}=t;n.size>0&&r.syncPropertiesFromYjs(e,n)}else bf(82)}function sg(e,t,n,r,s,o,i,l){var a;(a=e).doc.transact((()=>{r.read((()=>{if(l.has("collaboration")||l.has("historic"))return void(i.size>0&&function(e,t){const n=Array.from(t),r=e.collabNodeMap,s=[];for(let o=0;o<n.length;o++){const e=n[o],t=vt(e),i=r.get(e);if(i instanceof vf)if(Ur(t))s.push([i,t.__text]);else{const t=i.getOffset();if(-1===t)continue;const n=i._parent;i._normalized=!0,n._xmlText.delete(t,1),r.delete(e);const s=n._children,o=s.indexOf(i);s.splice(o,1)}}for(let o=0;o<s.length;o++){const[e,t]=s[o];e instanceof vf&&"string"==typeof t&&(e._text=t)}}(e,i));if(s.has("root")){const t=n._nodeMap,r=Tt(),i=e.root;i.syncPropertiesFromLexical(e,r,t),i.syncChildrenFromLexical(e,r,t,s,o)}const r=hs(),a=n._selection;ng(e,t,a,r)}))}),a)}const og={},ig={};function lg(e,t,n,r,s){const{awareness:o}=e;let i=o.getLocalState();null===i&&(i={anchorPos:null,awarenessData:s,color:n,focusPos:null,focusing:r,name:t}),i.focusing=r,o.setLocalState(i)}function ag(e,t,n,r,s,o,i,l,a,c,u){const d=React.useRef(!1),[h,f]=React.useState(r.get(t)),g=React.useMemo((()=>function(e,t,n,r,s,o){null==r&&bf(81);const i=Wf(r.get("root",Oh),null,"root");return i._key="root",{clientID:r.clientID,collabNodeMap:new Map,cursors:new Map,cursorsContainer:null,doc:r,docMap:s,editor:e,excludedProperties:o||new Map,id:n,nodeProperties:new Map,root:i}}(e,0,t,h,r,c)),[e,n,t,r,h,c]),p=React.useCallback((()=>{n.connect()}),[n]),m=React.useCallback((()=>{try{n.disconnect()}catch(e){}}),[n]);React.useEffect((()=>{const{root:l}=g,{awareness:c}=n,h=({status:t})=>{e.dispatchCommand(og,"connected"===t)},_=t=>{var n,r;i&&t&&l.isEmpty()&&0===l._xmlText._length&&!1===d.current&&(r=a,(n=e).update((()=>{const e=Tt();if(e.isEmpty())if(r)switch(typeof r){case"string":{const e=n.parseEditorState(r);n.setEditorState(e,{tag:"history-merge"});break}case"object":n.setEditorState(r,{tag:"history-merge"});break;case"function":n.update((()=>{Tt().isEmpty()&&r(n)}),{tag:"history-merge"})}else{const t=to();e.append(t);const{activeElement:r}=document;(null!==hs()||null!==r&&r===n.getRootElement())&&t.select()}}),{tag:"history-merge"})),d.current=!1},y=()=>{tg(g,n)},b=(e,t)=>{const r=t.origin;r!==g&&function(e,t,n,r){const s=e.editor,o=s._editorState;n.forEach((e=>e.delta)),s.update((()=>{const r=s._pendingEditorState;for(let t=0;t<n.length;t++){const r=n[t];rg(e,r)}0===Tt().getChildrenSize()&&Tt().append(to());const i=hs();if(Gr(i))if(Mf(i)){const n=o._selection;if(Gr(n)){const l=yf(s,0,o),a=yf(s,0,r),[c,u]=l.getOffsetsFromSelection(n),d=c>=0&&u>=0?a.createSelectionFromOffsets(c,u,l):null;null!==d?Rt(d):(Gf(e,t),Mf(i)&&Tt().selectEnd())}ng(e,t,n,hs())}else Gf(e,t)}),{onUpdate:()=>{tg(e,t)},skipTransforms:!0,tag:r?"historic":"collaboration"})}(g,n,e,r instanceof Sd)};!function(e,t,n,r,s){e.awareness.setLocalState({anchorPos:null,awarenessData:s,color:n,focusPos:null,focusing:r,name:t})}(n,s,o,document.activeElement===e.getRootElement(),u||{});const w=n=>{!function(e,t){if(e.update((()=>{const e=Tt();e.clear(),e.select()}),{tag:"skip-collab"}),null==t.cursors)return;const n=t.cursors;if(null==n)return;const r=t.cursorsContainer;if(null==r)return;const s=Array.from(n.values());for(let o=0;o<s.length;o++){const e=s[o].selection;if(e&&null!=e.selections){const t=e.selections;for(let e=0;e<t.length;e++)r.removeChild(t[o])}}}(e,g),f(n),r.set(t,n),d.current=!0};n.on("reload",w),n.on("status",h),n.on("sync",_),c.on("update",y),l.getSharedType().observeDeep(b);const x=e.registerUpdateListener((({prevEditorState:e,editorState:t,dirtyLeaves:r,dirtyElements:s,normalizedNodes:o,tags:i})=>{!1===i.has("skip-collab")&&sg(g,n,e,t,s,r,o,i)}));return p(),()=>{!1===d.current&&m(),n.off("sync",_),n.off("status",h),n.off("reload",w),c.off("update",y),l.getSharedType().unobserveDeep(b),r.delete(t),x()}}),[g,o,p,m,r,e,t,a,s,n,i,u]);const _=React.useMemo((()=>ReactDOM.createPortal(React.createElement("div",{ref:e=>{g.cursorsContainer=e}}),l&&l.current||document.body)),[g,l]);return React.useEffect((()=>e.registerCommand(ig,(e=>(void 0!==p&&void 0!==m&&(e?(console.log("Collaboration connected!"),p()):(console.log("Collaboration disconnected!"),m())),!0)),ro)),[p,m,e]),[_,g]}function cg(e,t){const n=React.useMemo((()=>function(e,t){return new Sd(t,{trackedOrigins:new Set([e,null])})}(t,t.root.getSharedType())),[t]);React.useEffect((()=>Bo(e.registerCommand(C,(()=>(n.undo(),!0)),ro),e.registerCommand(k,(()=>(n.redo(),!0)),ro))));const r=React.useCallback((()=>{n.clear()}),[n]);return React.useEffect((()=>{const t=()=>{e.dispatchCommand(Q,n.undoStack.length>0),e.dispatchCommand(G,n.redoStack.length>0)};return n.on("stack-item-added",t),n.on("stack-item-popped",t),n.on("stack-cleared",t),()=>{n.off("stack-item-added",t),n.off("stack-item-popped",t),n.off("stack-cleared",t)}}),[e,n]),r}function ug({id:e,providerFactory:t,shouldBootstrap:n,username:r,cursorColor:s,cursorsContainerRef:o,initialEditorState:i,excludedProperties:l,awarenessData:a}){const c=sa(r,s),{yjsDocMap:u,name:d,color:h}=c,[f]=Wi();React.useEffect((()=>(c.isCollabActive=!0,()=>{null==f._parentEditor&&(c.isCollabActive=!1)})),[c,f]);const g=React.useMemo((()=>t(e,u)),[e,t,u]),[p,m]=ag(f,e,g,u,d,h,n,o,i,l,a);return c.clientID=m.clientID,cg(f,m),_=f,y=g,b=d,w=h,x=a,React.useEffect((()=>Bo(_.registerCommand(ee,(()=>(lg(y,b,w,!0,x||{}),!1)),ro),_.registerCommand(te,(()=>(lg(y,b,w,!1,x||{}),!1)),ro))),[w,_,b,y,x]),p;var _,y,b,w,x}function dg(e,t){return(dg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var hg={error:null},fg=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).state=hg,t.resetErrorBoundary=function(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];null==t.props.onReset||(e=t.props).onReset.apply(e,r),t.reset()},t}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,dg(t,n),r.getDerivedStateFromError=function(e){return{error:e}};var s=r.prototype;return s.reset=function(){this.setState(hg)},s.componentDidCatch=function(e,t){var n,r;null==(n=(r=this.props).onError)||n.call(r,e,t)},s.componentDidUpdate=function(e,t){var n,r,s,o,i=this.state.error,l=this.props.resetKeys;null!==i&&null!==t.error&&(void 0===(s=e.resetKeys)&&(s=[]),void 0===(o=l)&&(o=[]),s.length!==o.length||s.some((function(e,t){return!Object.is(e,o[t])})))&&(null==(n=(r=this.props).onResetKeysChange)||n.call(r,e.resetKeys,l),this.reset())},s.render=function(){var e=this.state.error,t=this.props,n=t.fallbackRender,r=t.FallbackComponent,s=t.fallback;if(null!==e){var o={error:e,resetErrorBoundary:this.resetErrorBoundary};if(React.isValidElement(s))return s;if("function"==typeof n)return n(o);if(r)return React.createElement(r,o);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},r}(React.Component);function gg({children:e,onError:t}){return React.createElement(fg,{fallback:React.createElement("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"}},"An error was thrown."),onError:t},e)}let pg=class e extends Ar{static getType(){return"hashtag"}static clone(t){return new e(t.__text,t.__key)}constructor(e,t){super(e,t)}createDOM(e){const t=super.createDOM(e);return zo(t,e.theme.hashtag),t}static importJSON(e){const t=mg(e.text);return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}exportJSON(){return{...super.exportJSON(),type:"hashtag"}}canInsertTextBefore(){return!1}isTextEntity(){return!0}};function mg(e=""){return sn(new pg(e))}function _g(e,t,n){const[r]=Wi();React.useEffect((()=>Bo(...function(e,t,n,r){const s=e=>e instanceof n,o=e=>{const t=$r(e.getTextContent());t.setFormat(e.getFormat()),e.replace(t)};return[e.registerNodeTransform(Ar,(e=>{if(!e.isSimpleText())return;const n=e.getPreviousSibling();let i,l=e.getTextContent(),a=e;if(Ur(n)){const r=n.getTextContent(),i=t(r+l);if(s(n)){if(null===i||0!==n.getLatest().__mode)return void o(n);{const t=i.end-r.length;if(t>0){const s=r+l.slice(0,t);if(n.select(),n.setTextContent(s),t===l.length)e.remove();else{const n=l.slice(t);e.setTextContent(n)}return}}}else if(null===i||i.start<r.length)return}for(;;){i=t(l);let e,c=null===i?"":l.slice(i.end);if(l=c,""===c){const e=a.getNextSibling();if(Ur(e)){c=a.getTextContent()+e.getTextContent();const n=t(c);if(null===n)return void(s(e)?o(e):e.markDirty());if(0!==n.start)return}}else{const e=t(c);if(null!==e&&0===e.start)return}if(null===i)return;if(0===i.start&&Ur(n)&&n.isTextEntity())continue;0===i.start?[e,a]=a.splitText(i.end):[,e,a]=a.splitText(i.start,i.end);const u=r(e);if(u.setFormat(e.getFormat()),e.replace(u),null==a)return}})),e.registerNodeTransform(n,(e=>{const n=e.getTextContent(),r=t(n);if(null===r||0!==r.start)return void o(e);if(n.length>r.end)return void e.splitText(r.end);const i=e.getPreviousSibling();Ur(i)&&i.isTextEntity()&&(o(i),o(e));const l=e.getNextSibling();Ur(l)&&l.isTextEntity()&&(o(l),s(e)&&o(e))}))]}(r,e,t,n))),[n,r,e,t])}const yg=new RegExp(function(){const{alpha:e,alphanumeric:t,hashChars:n}=function(){const e=String.fromCharCode,t="A-Za-zªµºÀ-ÖØ-öø-Ɂɐ-ˁˆ-ˑˠ-ˤˮͺΆΈ-ΊΌΎ-ΡΣ-ώϐ-ϵϷ-ҁҊ-ӎӐ-ӹԀ-ԏԱ-Ֆՙա-ևא-תװ-ײء-غـ-يٮ-ٯٱ-ۓەۥ-ۦۮ-ۯۺ-ۼۿܐܒ-ܯݍ-ݭހ-ޥޱऄ-हऽॐक़-ॡॽঅ-ঌএ-ঐও-নপ-রলশ-হঽৎড়-ঢ়য়-ৡৰ-ৱਅ-ਊਏ-ਐਓ-ਨਪ-ਰਲ-ਲ਼ਵ-ਸ਼ਸ-ਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલ-ળવ-હઽૐૠ-ૡଅ-ଌଏ-ଐଓ-ନପ-ରଲ-ଳଵ-ହଽଡ଼-ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கங-சஜஞ-டண-தந-பம-ஹఅ-ఌఎ-ఐఒ-నప-ళవ-హౠ-ౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠ-ೡഅ-ഌഎ-ഐഒ-നപ-ഹൠ-ൡඅ-ඖක-නඳ-රලව-ෆก-ะา-ำเ-ๆກ-ຂຄງ-ຈຊຍດ-ທນ-ຟມ-ຣລວສ-ຫອ-ະາ-ຳຽເ-ໄໆໜ-ໝༀཀ-ཇཉ-ཪྈ-ྋက-အဣ-ဧဩ-ဪၐ-ၕႠ-Ⴥა-ჺჼᄀ-ᅙᅟ-ᆢᆨ-ᇹሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙶᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦩᧁ-ᧇᨀ-ᨖᴀ-ᶿḀ-ẛẠ-ỹἀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₔℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℱℳ-ℹℼ-ℿⅅ-ⅉⰀ-Ⱞⰰ-ⱞⲀ-ⳤⴀ-ⴥⴰ-ⵥⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〆〱-〵〻-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄬㄱ-ㆎㆠ-ㆷㇰ-ㇿ㐀-䶵一-龻ꀀ-ꒌꠀ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢ가-힣豈-鶴侮-頻並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ̀-ͯ҃-֑҆-ֹֻ-ֽֿׁ-ׂׄ-ׇׅؐ-ًؕ-ٰٞۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ްँ-ः़ा-्॑-॔ॢ-ॣঁ-ঃ়া-ৄে-ৈো-্ৗৢ-ৣਁ-ਃ਼ਾ-ੂੇ-ੈੋ-੍ੰ-ੱઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣଁ-ଃ଼ା-ୃେ-ୈୋ-୍ୖ-ୗஂா-ூெ-ைொ-்ௗఁ-ఃా-ౄె-ైొ-్ౕ-ౖಂ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕ-ೖം-ഃാ-ൃെ-ൈൊ-്ൗං-ඃ්ා-ුූෘ-ෟෲ-ෳัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-༹༙༵༷༾-༿ཱ-྄྆-྇ྐ-ྗྙ-ྼ࿆ာ-ဲံ-္ၖ-ၙ፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳា-៓៝᠋-᠍ᢩᤠ-ᤫᤰ-᤻ᦰ-ᧀᧈ-ᧉᨗ-ᨛ᷀-᷃⃐-⃥⃜⃡-⃫〪-゙〯-゚ꠂ꠆ꠋꠣ-ꠧﬞ︀-️︠-︣À-ÖØ-öø-ÿĀ-ɏɓ-ɔɖ-ɗəɛɣɨɯɲʉʋʻ̀-ͯḀ-ỿЀ-ӿԀ-ԧⷠ-ⷿꙀ-֑ꚟ-ֿׁ-ׂׄ-ׇׅא-תװ-״﬒-ﬨשׁ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﭏؐ-ؚؠ-ٟٮ-ۓە-ۜ۞-۪ۨ-ۯۺ-ۼۿݐ-ݿࢠࢢ-ࢬࣤ-ࣾﭐ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼ‌-‌ก-ฺเ-๎ᄀ-ᇿ㄰-ㆅꥠ-꥿가-힯ힰ-퟿ﾡ-ￜァ-ヺー-ヾｦ-ﾟ０-９Ａ-Ｚａ-ｚぁ-ゖ゙-ゞ㐀-䶿一-鿿"+e(173824)+"-"+e(177983)+e(177984)+"-"+e(178207)+e(194560)+"-"+e(195103)+"〃々〻";return{alpha:t,alphanumeric:t+"0-9٠-٩۰-۹०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉០-៩᠐-᠙᥆-᥏᧐-᧙０-９_",hashChars:"#\\uFF03"}}(),r="["+t+"]";return"(^|$|[^&/"+t+"])(["+n+"])("+r+"*["+e+"]"+r+"*)"}(),"i");function bg(){const[e]=Wi();React.useEffect((()=>{if(!e.hasNodes([pg]))throw new Error("HashtagPlugin: HashtagNode not registered on editor")}),[e]);const t=React.useCallback((e=>mg(e.getTextContent())),[]);return _g(React.useCallback((e=>{const t=yg.exec(e);if(null===t)return null;const n=t[3].length+1,r=t.index+t[1].length;return{end:r+n,start:r}}),[]),pg,t),null}const wg=0,xg=1,vg=2,Sg=0,Cg=1,kg=2,Eg=3,Tg=4;function Ng(e,t){let n=Date.now(),r=Sg;return(s,o,i,l,a,c)=>{const u=Date.now();if(c.has("historic"))return r=Sg,n=u,vg;const d=function(e,t,n,r,s){if(null===e||0===n.size&&0===r.size&&!s)return Sg;const o=t._selection,i=e._selection;if(s)return Cg;if(!(Gr(o)&&Gr(i)&&i.isCollapsed()&&o.isCollapsed()))return Sg;const l=function(e,t,n){const r=e._nodeMap,s=[];for(const o of t){const e=r.get(o);void 0!==e&&s.push(e)}for(const[o,i]of n){if(!i)continue;const e=r.get(o);void 0===e||Zs(e)||s.push(e)}return s}(t,n,r);if(0===l.length)return Sg;if(l.length>1){const n=t._nodeMap,r=n.get(o.anchor.key),s=n.get(i.anchor.key);return r&&s&&!e._nodeMap.has(r.__key)&&Ur(r)&&1===r.__text.length&&1===o.anchor.offset?kg:Sg}const a=l[0],c=e._nodeMap.get(a.__key);if(!Ur(c)||!Ur(a)||c.__mode!==a.__mode)return Sg;const u=c.__text,d=a.__text;if(u===d)return Sg;const h=o.anchor,f=i.anchor;if(h.key!==f.key||"text"!==h.type)return Sg;const g=h.offset,p=f.offset,m=d.length-u.length;return 1===m&&p===g-1?kg:-1===m&&p===g+1?Eg:-1===m&&p===g?Tg:Sg}(s,o,l,a,e.isComposing()),h=(()=>{const h=null===i||i.editor===e,f=c.has("history-push");if(!f&&h&&c.has("history-merge"))return wg;if(null===s)return xg;const g=o._selection;return l.size>0||a.size>0?!1===f&&d!==Sg&&d===r&&u<n+t&&h||1===l.size&&function(e,t,n){const r=t._nodeMap.get(e),s=n._nodeMap.get(e),o=t._selection,i=n._selection;let l=!1;return Gr(o)&&Gr(i)&&(l="element"===o.anchor.type&&"element"===o.focus.type&&"text"===i.anchor.type&&"text"===i.focus.type),!(l||!Ur(r)||!Ur(s))&&r.__type===s.__type&&r.__text===s.__text&&r.__mode===s.__mode&&r.__detail===s.__detail&&r.__style===s.__style&&r.__format===s.__format&&r.__parent===s.__parent}(Array.from(l)[0],s,o)?wg:xg:null!==g?wg:vg})();return n=u,r=d,h}}function Rg(e){e.undoStack=[],e.redoStack=[],e.current=null}function Ag(){return{current:null,redoStack:[],undoStack:[]}}function Og({externalHistoryState:e}){const[t]=Wi();return function(e,t,n=1e3){const r=React.useMemo((()=>t||{current:null,redoStack:[],undoStack:[]}),[t]);React.useEffect((()=>function(e,t,n){const r=Ng(e,n),s=({editorState:n,prevEditorState:s,dirtyLeaves:o,dirtyElements:i,tags:l})=>{const a=t.current,c=t.redoStack,u=t.undoStack,d=null===a?null:a.editorState;if(null!==a&&n===d)return;const h=r(s,n,a,o,i,l);if(h===xg)0!==c.length&&(t.redoStack=[],e.dispatchCommand(G,!1)),null!==a&&(u.push({...a}),e.dispatchCommand(Q,!0));else if(h===vg)return;t.current={editor:e,editorState:n}},o=Bo(e.registerCommand(C,(()=>(function(e,t){const n=t.redoStack,r=t.undoStack;if(0!==r.length){const s=t.current,o=r.pop();null!==s&&(n.push(s),e.dispatchCommand(G,!0)),0===r.length&&e.dispatchCommand(Q,!1),t.current=o||null,o&&o.editor.setEditorState(o.editorState,{tag:"historic"})}}(e,t),!0)),ro),e.registerCommand(k,(()=>(function(e,t){const n=t.redoStack,r=t.undoStack;if(0!==n.length){const s=t.current;null!==s&&(r.push(s),e.dispatchCommand(Q,!0));const o=n.pop();0===n.length&&e.dispatchCommand(G,!1),t.current=o||null,o&&o.editor.setEditorState(o.editorState,{tag:"historic"})}}(e,t),!0)),ro),e.registerCommand(X,(()=>(Rg(t),!1)),ro),e.registerCommand(q,(()=>(Rg(t),e.dispatchCommand(G,!1),e.dispatchCommand(Q,!1),!0)),ro),e.registerUpdateListener(s)),i=e.registerUpdateListener(s);return()=>{o(),i()}}(e,r,n)),[n,e,r])}(t,e),null}function Fg(e,t){return e.getEditorState().read((()=>{const e=vt(t);return null!==e&&e.isSelected()}))}function Dg(e){const[t]=Wi(),[n,r]=React.useState((()=>Fg(t,e)));return React.useEffect((()=>{let n=!0;const s=t.registerUpdateListener((()=>{n&&r(Fg(t,e))}));return()=>{n=!1,s()}}),[t,e]),[n,React.useCallback((n=>{t.update((()=>{let t=hs();es(t)||(t=us(),Rt(t)),es(t)&&(n?t.add(e):t.delete(e))}))}),[t,e]),React.useCallback((()=>{t.update((()=>{const e=hs();es(e)&&e.clear()}))}),[t])]}const Pg={};function Lg({nodeKey:e}){const[t]=Wi(),[n,r,s]=Dg(e),o=React.useCallback((t=>{if(n&&es(hs())){t.preventDefault();const n=vt(e);if(zg(n))return n.remove(),!0}return!1}),[n,e]);return React.useEffect((()=>Bo(t.registerCommand(g,(o=>{const i=t.getElementByKey(e);return o.target===i&&(o.shiftKey||s(),r(!n),!0)}),so),t.registerCommand(M,o,so),t.registerCommand(L,o,so))),[s,t,n,e,o,r]),React.useEffect((()=>{const r=t.getElementByKey(e);null!==r&&(r.className=n?"selected":"")}),[t,n,e]),null}let Ig=class e extends Ws{static getType(){return"horizontalrule"}static clone(t){return new e(t.__key)}static importJSON(e){return Bg()}static importDOM(){return{hr:()=>({conversion:Mg,priority:0})}}exportJSON(){return{type:"horizontalrule",version:1}}exportDOM(){return{element:document.createElement("hr")}}createDOM(){return document.createElement("hr")}getTextContent(){return"\n"}isInline(){return!1}updateDOM(){return!1}decorate(){return React.createElement(Lg,{nodeKey:this.__key})}};function Mg(){return{node:Bg()}}function Bg(){return sn(new Ig)}function zg(e){return e instanceof Ig}function $g(){const[e]=Wi();return React.useEffect((()=>e.registerCommand(Pg,(e=>{const t=hs();if(!Gr(t))return!1;if(null!==t.focus.getNode()){Yo(Bg())}return!0}),ro)),[e]),null}function Ug(){const[e]=Wi();return React.useEffect((()=>{if(!e.hasNodes([Ri,Si]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[e]),t=e,React.useEffect((()=>Bo(t.registerCommand(Mi,(()=>(mi(t,"number"),!0)),so),t.registerCommand(Ii,(()=>(mi(t,"bullet"),!0)),so),t.registerCommand(zi,(()=>(function(e){e.update((()=>{const e=hs();if(Gr(e)){const t=new Set,n=e.getNodes(),r=e.anchor.getNode();if(pi(r,n))t.add(di(r));else for(let e=0;e<n.length;e++){const r=n[e];if(mt(r)){const e=Wo(r,Si);null!=e&&t.add(di(e))}}for(const s of t){let t=s;const n=hi(s);for(const r of n){const n=to();_i(n,r.getChildren()),t.insertAfter(n),t=n,r.__key===e.anchor.key&&e.anchor.set(n.getKey(),0,"element"),r.__key===e.focus.key&&e.focus.set(n.getKey(),0,"element"),r.remove()}s.remove()}}}))}(t),!0)),so),t.registerCommand(_,(()=>!!function(){const e=hs();if(!Gr(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!Ni(t)||0!==t.getChildrenSize())return!1;const n=di(t),r=t.getParent();Li(r)||ci(40);const s=r.getParent();let o;if(rn(s))o=to(),n.insertAfter(o);else{if(!Ni(s))return!1;o=Ti(),s.insertAfter(o)}o.select();const i=t.getNextSiblings();if(i.length>0){const e=Pi(r.getListType());if(no(o))o.insertAfter(e);else{const t=Ti();t.append(e),o.insertAfter(t)}i.forEach((t=>{t.remove(),e.append(t)}))}return function(e){let t=e;for(;null==t.getNextSibling()&&null==t.getPreviousSibling();){const e=t.getParent();if(null==e||!Ni(t)&&!Li(t))break;t=e}t.remove()}(t),!0}()),so))),[t]),null;var t}var Kg="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function Wg(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function jg(){return function(e){const[t]=Wi(),n=React.useMemo((()=>e(t)),[t,e]),r=React.useRef(n.initialValueFn()),[s,o]=React.useState(r.current);return Kg((()=>{const{initialValueFn:e,subscribe:t}=n,s=e();return r.current!==s&&(r.current=s,o(s)),t((e=>{r.current=e,o(e)}))}),[n,e]),s}(Wg)}function Hg(e){const t=window.location.origin,n=n=>{if(n.origin!==t)return;const r=e.getRootElement();if(document.activeElement!==r)return;const s=n.data;if("string"==typeof s){let t;try{t=JSON.parse(s)}catch(mw){return}if(t&&"nuanria_messaging"===t.protocol&&"request"===t.type){const r=t.payload;if(r&&"makeChanges"===r.functionId){const t=r.args;if(t){const[r,s,o,i,l,a]=t;e.update((()=>{const e=hs();if(Gr(e)){const t=e.anchor;let a=t.getNode(),c=0,u=0;if(Ur(a)&&r>=0&&s>=0&&(c=r,u=r+s,e.setTextNodeRange(a,c,a,u)),c===u&&""===o||(e.insertRawText(o),a=t.getNode()),Ur(a)){c=i,u=i+l;const t=a.getTextContentSize();c=c>t?t:c,u=u>t?t:u,e.setTextNodeRange(a,c,a,u)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",n,!0),()=>{window.removeEventListener("message",n,!0)}}const Jg="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Vg=Jg&&"documentMode"in document?document.documentMode:null,Yg=!(!Jg||!("InputEvent"in window)||Vg)&&"getTargetRanges"in new window.InputEvent("input"),Zg=Jg&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Xg=Jg&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,qg=Jg&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Gg=Jg&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!qg;function Qg(e,t){t.update((()=>{if(null!==e){const n=Xo(e,KeyboardEvent)?null:e.clipboardData,r=hs();if(null!==r&&null!=n){e.preventDefault();const s=tl(t);null!==s&&n.setData("text/html",s),n.setData("text/plain",r.getTextContent())}}}))}var ep="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function tp(e){return e.getEditorState().read(Ml(e.isComposing()))}function np({contentEditable:e,placeholder:t,ErrorBoundary:n}){const[r]=Wi(),s=function(e,t){const[n,r]=React.useState((()=>e.getDecorators()));return ep((()=>e.registerDecoratorListener((e=>{ReactDOM.flushSync((()=>{r(e)}))}))),[e]),React.useEffect((()=>{r(e.getDecorators())}),[e]),React.useMemo((()=>{const r=[],s=Object.keys(n);for(let o=0;o<s.length;o++){const i=s[o],l=React.createElement(t,{onError:t=>e._onError(t)},React.createElement(React.Suspense,{fallback:null},n[i])),a=e.getElementByKey(i);null!==a&&r.push(ReactDOM.createPortal(l,a,i))}return r}),[t,n,e])}(r,n);return ep((()=>Bo(function(e){return Bo(e.registerCommand(p,(e=>{const t=hs();return!!Gr(t)&&(t.deleteCharacter(e),!0)}),ro),e.registerCommand(x,(e=>{const t=hs();return!!Gr(t)&&(t.deleteWord(e),!0)}),ro),e.registerCommand(v,(e=>{const t=hs();return!!Gr(t)&&(t.deleteLine(e),!0)}),ro),e.registerCommand(y,(e=>{const t=hs();if(!Gr(t))return!1;if("string"==typeof e)t.insertText(e);else{const n=e.dataTransfer;if(null!=n)rl(n,t);else{const n=e.data;n&&t.insertText(n)}}return!0}),ro),e.registerCommand(w,(()=>{const e=hs();return!!Gr(e)&&(e.removeText(),!0)}),ro),e.registerCommand(m,(e=>{const t=hs();return!!Gr(t)&&(t.insertLineBreak(e),!0)}),ro),e.registerCommand(_,(()=>{const e=hs();return!!Gr(e)&&(e.insertLineBreak(),!0)}),ro),e.registerCommand(R,(e=>{const t=hs();if(!Gr(t))return!1;const n=e,r=n.shiftKey;return!!To(t,!0)&&(n.preventDefault(),Ro(t,r,!0),!0)}),ro),e.registerCommand(T,(e=>{const t=hs();if(!Gr(t))return!1;const n=e,r=n.shiftKey;return!!To(t,!1)&&(n.preventDefault(),Ro(t,r,!1),!0)}),ro),e.registerCommand(L,(t=>!!Gr(hs())&&(t.preventDefault(),e.dispatchCommand(p,!0))),ro),e.registerCommand(M,(t=>!!Gr(hs())&&(t.preventDefault(),e.dispatchCommand(p,!1))),ro),e.registerCommand(D,(t=>{if(!Gr(hs()))return!1;if(null!==t){if((Xg||Zg||Gg)&&Yg)return!1;t.preventDefault()}return e.dispatchCommand(m,!1)}),ro),e.registerCommand(Z,(()=>(Ht(),!0)),ro),e.registerCommand(V,(t=>!!Gr(hs())&&(Qg(t,e),!0)),ro),e.registerCommand(Y,(t=>{return!!Gr(hs())&&(Qg(t,n=e),n.update((()=>{const e=hs();Gr(e)&&e.removeText()})),!0);var n}),ro),e.registerCommand(b,(t=>{return!!Gr(hs())&&(r=e,(n=t).preventDefault(),r.update((()=>{const e=hs(),{clipboardData:t}=n;null!=t&&Gr(e)&&rl(t,e)}),{tag:"paste"}),!0);var n,r}),ro),e.registerCommand(K,(e=>!!Gr(hs())&&(e.preventDefault(),!0)),ro),e.registerCommand(j,(e=>!!Gr(hs())&&(e.preventDefault(),!0)),ro))}(o),Hg(o))),[o=r]),React.createElement(React.Fragment,null,e,React.createElement(rp,{content:t}),s);var o}function rp({content:e}){const[t]=Wi(),n=function(e){const[t,n]=React.useState((()=>tp(e)));return ep((()=>{function t(){const t=tp(e);n(t)}return t(),Bo(e.registerUpdateListener((()=>{t()})),e.registerEditableListener((()=>{t()})))}),[e]),t}(t),r=jg();return n?"function"==typeof e?e(r):e:null}var sp="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function op(e){return e.getEditorState().read(Ml(e.isComposing()))}function ip({contentEditable:e,placeholder:t,ErrorBoundary:n}){const[r]=Wi(),s=function(e,t){const[n,r]=React.useState((()=>e.getDecorators()));return sp((()=>e.registerDecoratorListener((e=>{ReactDOM.flushSync((()=>{r(e)}))}))),[e]),React.useEffect((()=>{r(e.getDecorators())}),[e]),React.useMemo((()=>{const r=[],s=Object.keys(n);for(let o=0;o<s.length;o++){const i=s[o],l=React.createElement(t,{onError:t=>e._onError(t)},React.createElement(React.Suspense,{fallback:null},n[i])),a=e.getElementByKey(i);null!==a&&r.push(ReactDOM.createPortal(l,a,i))}return r}),[t,n,e])}(r,n);return sp((()=>Bo(function(e){return Bo(e.registerCommand(g,(e=>{const t=hs();return!!es(t)&&(t.clear(),!0)}),0),e.registerCommand(p,(e=>{const t=hs();return!!Gr(t)&&(t.deleteCharacter(e),!0)}),ro),e.registerCommand(x,(e=>{const t=hs();return!!Gr(t)&&(t.deleteWord(e),!0)}),ro),e.registerCommand(v,(e=>{const t=hs();return!!Gr(t)&&(t.deleteLine(e),!0)}),ro),e.registerCommand(y,(t=>{const n=hs();if("string"==typeof t)null!==n&&n.insertText(t);else{if(null===n)return!1;const r=t.dataTransfer;if(null!=r)sl(r,n,e);else if(Gr(n)){const e=t.data;return e&&n.insertText(e),!0}}return!0}),ro),e.registerCommand(w,(()=>{const e=hs();return!!Gr(e)&&(e.removeText(),!0)}),ro),e.registerCommand(S,(e=>{const t=hs();return!!Gr(t)&&(t.formatText(e),!0)}),ro),e.registerCommand(W,(e=>{const t=hs();if(!Gr(t)&&!es(t))return!1;const n=t.getNodes();for(const r of n){const t=Ho(r,(e=>Js(e)&&!e.isInline()));null!==t&&t.setFormat(e)}return!0}),ro),e.registerCommand(m,(e=>{const t=hs();return!!Gr(t)&&(t.insertLineBreak(e),!0)}),ro),e.registerCommand(_,(()=>{const e=hs();return!!Gr(e)&&(e.insertParagraph(),!0)}),ro),e.registerCommand(z,(()=>(ys([Wr()]),!0)),ro),e.registerCommand($,(()=>Rl((e=>{const t=e.getIndent();e.setIndent(t+1)}))),ro),e.registerCommand(U,(()=>Rl((e=>{const t=e.getIndent();t>0&&e.setIndent(t-1)}))),ro),e.registerCommand(O,(e=>{const t=hs();if(es(t)&&!Al(e.target)){const e=t.getNodes();if(e.length>0)return e[0].selectPrevious(),!0}else if(Gr(t)){const n=Zt(t.focus,!0);if(!e.shiftKey&&js(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),e.preventDefault(),!0}return!1}),ro),e.registerCommand(F,(e=>{const t=hs();if(es(t)){const e=t.getNodes();if(e.length>0)return e[0].selectNext(0,0),!0}else if(Gr(t)){if(function(e){const t=e.focus;return"root"===t.key&&t.offset===Tt().getChildrenSize()}(t))return e.preventDefault(),!0;const n=Zt(t.focus,!1);if(!e.shiftKey&&js(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),e.preventDefault(),!0}return!1}),ro),e.registerCommand(R,(e=>{const t=hs();if(es(t)){const n=t.getNodes();if(n.length>0)return e.preventDefault(),n[0].selectPrevious(),!0}if(!Gr(t))return!1;if(To(t,!0)){const n=e.shiftKey;return e.preventDefault(),Ro(t,n,!0),!0}return!1}),ro),e.registerCommand(T,(e=>{const t=hs();if(es(t)&&!Al(e.target)){const n=t.getNodes();if(n.length>0)return e.preventDefault(),n[0].selectNext(0,0),!0}if(!Gr(t))return!1;const n=e.shiftKey;return!!To(t,!1)&&(e.preventDefault(),Ro(t,n,!1),!0)}),ro),e.registerCommand(L,(t=>{if(Al(t.target))return!1;const n=hs();if(!Gr(n))return!1;t.preventDefault();const{anchor:r}=n,s=r.getNode();return n.isCollapsed()&&0===r.offset&&!Zs(s)&&jo(s).getIndent()>0?e.dispatchCommand(U,void 0):e.dispatchCommand(p,!0)}),ro),e.registerCommand(M,(t=>!Al(t.target)&&!!Gr(hs())&&(t.preventDefault(),e.dispatchCommand(p,!1))),ro),e.registerCommand(D,(t=>{if(!Gr(hs()))return!1;if(null!==t){if((pl||gl||_l)&&fl)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(m,!1)}return e.dispatchCommand(_,void 0)}),ro),e.registerCommand(I,(()=>!!Gr(hs())&&(e.blur(),!0)),ro),e.registerCommand(K,(t=>{const[,n]=Nl(t);if(n.length>0){const r=ul(t.clientX,t.clientY);if(null!==r){const{offset:t,node:s}=r,o=Ct(s);if(null!==o){const e=cs();if(Ur(o))e.anchor.set(o.getKey(),t,"text"),e.focus.set(o.getKey(),t,"text");else{const t=o.getParentOrThrow().getKey(),n=o.getIndexWithinParent()+1;e.anchor.set(t,n,"element"),e.focus.set(t,n,"element")}Rt(ot(e))}e.dispatchCommand(yl,n)}return t.preventDefault(),!0}return!!Gr(hs())}),ro),e.registerCommand(j,(e=>{const[t]=Nl(e),n=hs();return!(t&&!Gr(n))}),ro),e.registerCommand(H,(e=>{const[t]=Nl(e),n=hs();if(t&&!Gr(n))return!1;const r=ul(e.clientX,e.clientY);return null!==r&&js(Ct(r.node))&&e.preventDefault(),!0}),ro),e.registerCommand(Z,(()=>(Ht(),!0)),ro),e.registerCommand(V,(t=>(al(e,Xo(t,ClipboardEvent)?t:null),!0)),ro),e.registerCommand(Y,(t=>(async function(e,t){await al(t,Xo(e,ClipboardEvent)?e:null),t.update((()=>{const e=hs();Gr(e)?e.removeText():es(e)&&e.getNodes().forEach((e=>e.remove()))}))}(t,e),!0)),ro),e.registerCommand(b,(t=>{const[,n,r]=Nl(t);return n.length>0&&!r?(e.dispatchCommand(yl,n),!0):!ct(t.target)&&null!==hs()&&(o=e,(s=t).preventDefault(),o.update((()=>{const e=hs(),t=Xo(s,InputEvent)||Xo(s,KeyboardEvent)?null:s.clipboardData;null!=t&&null!==e&&sl(t,e,o)}),{tag:"paste"}),!0);var s,o}),ro))}(o),Hg(o))),[o=r]),React.createElement(React.Fragment,null,e,React.createElement(lp,{content:t}),s);var o}function lp({content:e}){const[t]=Wi(),n=function(e){const[t,n]=React.useState((()=>op(e)));return sp((()=>{function t(){const t=op(e);n(t)}return t(),Bo(e.registerUpdateListener((()=>{t()})),e.registerEditableListener((()=>{t()})))}),[e]),t}(t),r=jg();return n?"function"==typeof e?e(r):e:null}function ap(e){return e.registerCommand(B,(t=>{const n=hs();if(!Gr(n))return!1;t.preventDefault();const r=function(e){if(function(e,t){const n=[];for(let r=0;r<e.length;r++){const s=t(e[r]);null!==s&&n.push(s)}return n}(e.getNodes(),(e=>{return Js(t=e)&&!t.isInline()&&e.canIndent()?e:null;var t})).length>0)return!0;const t=e.anchor,n=e.focus,r=n.isBefore(t)?n:t,s=jo(r.getNode());if(s.canIndent()){const e=s.getKey();let t=cs();if(t.anchor.set(e,0,"element"),t.focus.set(e,0,"element"),t=ot(t),t.anchor.is(r))return!0}return!1}(n)?t.shiftKey?U:$:z;return e.dispatchCommand(r,void 0)}),ro)}function cp(){const[e]=Wi();return React.useEffect((()=>ap(e))),null}const up=/^(\d+(?:\.\d+)?)px$/,dp={BOTH:3,COLUMN:2,NO_STATUS:0,ROW:1};let hp=class e extends Hs{static getType(){return"tablecell"}static clone(t){const n=new e(t.__headerState,t.__colSpan,t.__width,t.__key);return n.__rowSpan=t.__rowSpan,n.__backgroundColor=t.__backgroundColor,n}static importDOM(){return{td:e=>({conversion:fp,priority:0}),th:e=>({conversion:fp,priority:0})}}static importJSON(e){const t=e.colSpan||1,n=e.rowSpan||1,r=gp(e.headerState,t,e.width||void 0);return r.__rowSpan=n,r.__backgroundColor=e.backgroundColor||null,r}constructor(e=dp.NO_STATUS,t=1,n,r){super(r),this.__colSpan=t,this.__rowSpan=1,this.__headerState=e,this.__width=n,this.__backgroundColor=null}createDOM(e){const t=document.createElement(this.getTag());return this.__width&&(t.style.width=`${this.__width}px`),this.__colSpan>1&&(t.colSpan=this.__colSpan),this.__rowSpan>1&&(t.rowSpan=this.__rowSpan),null!==this.__backgroundColor&&(t.style.backgroundColor=this.__backgroundColor),zo(t,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),t}exportDOM(e){const{element:t}=super.exportDOM(e);if(t){const e=t,n=700,r=this.getParentOrThrow().getChildrenSize();e.style.border="1px solid black",this.__colSpan>1&&(e.colSpan=this.__colSpan),this.__rowSpan>1&&(e.rowSpan=this.__rowSpan),e.style.width=`${this.getWidth()||Math.max(90,n/r)}px`,e.style.verticalAlign="top",e.style.textAlign="start";const s=this.getBackgroundColor();null!==s?e.style.backgroundColor=s:this.hasHeader()&&(e.style.backgroundColor="#f2f3f5")}return{element:t}}exportJSON(){return{...super.exportJSON(),backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,type:"tablecell",width:this.getWidth()}}getColSpan(){return this.__colSpan}setColSpan(e){return this.getWritable().__colSpan=e,this}getRowSpan(){return this.__rowSpan}setRowSpan(e){return this.getWritable().__rowSpan=e,this}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e){return this.getWritable().__headerState=e,this.__headerState}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){return this.getWritable().__width=e,this.__width}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){this.getWritable().__backgroundColor=e}toggleHeaderStyle(e){const t=this.getWritable();return(t.__headerState&e)===e?t.__headerState-=e:t.__headerState+=e,t}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==dp.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}};function fp(e){const t=e,n=e.nodeName.toLowerCase();let r;up.test(t.style.width)&&(r=parseFloat(t.style.width));const s=gp("th"===n?dp.ROW:dp.NO_STATUS,t.colSpan,r);s.__rowSpan=t.rowSpan;const o=t.style.backgroundColor;""!==o&&(s.__backgroundColor=o);const i=t.style,l="700"===i.fontWeight||"bold"===i.fontWeight,a="line-through"===i.textDecoration,c="italic"===i.fontStyle,u="underline"===i.textDecoration;return{after:e=>(0===e.length&&e.push(to()),e),forChild:(e,t)=>{if(pp(t)&&!Js(e)){const t=to();return vr(e)&&"\n"===e.getTextContent()?null:(Ur(e)&&(l&&e.toggleFormat("bold"),a&&e.toggleFormat("strikethrough"),c&&e.toggleFormat("italic"),u&&e.toggleFormat("underline")),t.append(e),t)}return e},node:s}}function gp(e,t=1,n){return sn(new hp(e,t,n))}function pp(e){return e instanceof hp}const mp={};let _p=class e extends Hs{static getType(){return"tablerow"}static clone(t){return new e(t.__height,t.__key)}static importDOM(){return{tr:e=>({conversion:yp,priority:0})}}static importJSON(e){return bp(e.height)}constructor(e,t){super(t),this.__height=e}exportJSON(){return{...super.exportJSON(),...this.getHeight()&&{height:this.getHeight()},type:"tablerow",version:1}}createDOM(e){const t=document.createElement("tr");return this.__height&&(t.style.height=`${this.__height}px`),zo(t,e.theme.tableRow),t}isShadowRoot(){return!0}setHeight(e){return this.getWritable().__height=e,this.__height}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}};function yp(e){const t=e;let n;return up.test(t.style.height)&&(n=parseFloat(t.style.height)),{node:bp(n)}}function bp(e){return sn(new _p(e))}function wp(e){return e instanceof _p}var xp=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};const vp="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function Sp(e){const t=Ho(e,(e=>pp(e)));return pp(t)?t:null}function Cp(e){const t=Ho(e,(e=>wp(e)));if(wp(t))return t;throw new Error("Expected table cell to be inside of table row.")}function kp(e){const t=Ho(e,(e=>pm(e)));if(pm(t))return t;throw new Error("Expected table cell to be inside of table.")}function Ep(e){const t=Cp(e);return kp(t).getChildren().findIndex((e=>e.is(t)))}function Tp(e){return Cp(e).getChildren().findIndex((t=>t.is(e)))}const Np=(e,t)=>e===dp.BOTH||e===t?t:dp.NO_STATUS;function Rp(e=!0){const t=hs();Gr(t)||$p(t)||xp(118);const n=t.focus.getNode(),[r,,s]=Mp(n),[o,i]=Ip(s,r,r),l=o[0].length,{startRow:a}=i;if(e){const e=a+r.__rowSpan-1,t=o[e],n=bp();for(let r=0;r<l;r++){const{cell:s,startRow:o}=t[r];if(o+s.__rowSpan-1<=e){const e=t[r].cell.__headerState,s=Np(e,dp.COLUMN);n.append(gp(s).append(to()))}else s.setRowSpan(s.__rowSpan+1)}const i=s.getChildAtIndex(e);wp(i)||xp(145),i.insertAfter(n)}else{const e=o[a],t=bp();for(let r=0;r<l;r++){const{cell:n,startRow:s}=e[r];if(s===a){const n=e[r].cell.__headerState,s=Np(n,dp.COLUMN);t.append(gp(s).append(to()))}else n.setRowSpan(n.__rowSpan+1)}const n=s.getChildAtIndex(a);wp(n)||xp(145),n.insertBefore(t)}}function Ap(e=!0){const t=hs();Gr(t)||$p(t)||xp(118);const n=t.anchor.getNode(),r=t.focus.getNode(),[s]=Mp(n),[o,,i]=Mp(r),[l,a,c]=Ip(i,o,s),u=l.length,d=e?Math.max(a.startColumn,c.startColumn):Math.min(a.startColumn,c.startColumn),h=e?d+o.__colSpan-1:d-1,f=i.getFirstChild();wp(f)||xp(120);let g=null;function p(e=dp.NO_STATUS){const t=gp(e).append(to());return null===g&&(g=t),t}let m=f;e:for(let _=0;_<u;_++){if(0!==_){const e=m.getNextSibling();wp(e)||xp(121),m=e}const e=l[_],t=e[h<0?0:h].cell.__headerState,n=Np(t,dp.ROW);if(h<0){Pp(m,p(n));continue}const{cell:r,startColumn:s,startRow:o}=e[h];if(s+r.__colSpan-1<=h){let t=r,s=o,i=h;for(;s!==_&&t.__rowSpan>1;){if(i-=r.__colSpan,!(i>=0)){m.append(p(n));continue e}{const{cell:n,startRow:r}=e[i];t=n,s=r}}t.insertAfter(p(n))}else r.setColSpan(r.__colSpan+1)}null!==g&&Dp(g)}function Op(){const e=hs();Gr(e)||$p(e)||xp(118);const t=e.anchor.getNode(),n=e.focus.getNode(),[r,,s]=Mp(t),[o]=Mp(n),[i,l,a]=Ip(s,r,o),{startRow:c}=l,{startRow:u}=a,d=u+o.__rowSpan-1;if(i.length===d-c+1)return void s.remove();const h=i[0].length,f=i[d+1],g=s.getChildAtIndex(d+1);for(let p=d;p>=c;p--){for(let t=h-1;t>=0;t--){const{cell:e,startRow:n,startColumn:r}=i[p][t];if(r===t&&(p===c&&n<c&&e.setRowSpan(e.__rowSpan-(n-c)),n>=c&&n+e.__rowSpan-1>d))if(e.setRowSpan(e.__rowSpan-(d-n+1)),null===g&&xp(122),0===t)Pp(g,e);else{const{cell:n}=f[t-1];n.insertAfter(e)}}const e=s.getChildAtIndex(p);wp(e)||xp(123,String(p)),e.remove()}if(void 0!==f){const{cell:e}=f[0];Dp(e)}else{const e=i[c-1],{cell:t}=e[0];Dp(t)}}function Fp(){const e=hs();Gr(e)||$p(e)||xp(118);const t=e.anchor.getNode(),n=e.focus.getNode(),[r,,s]=Mp(t),[o]=Mp(n),[i,l,a]=Ip(s,r,o),{startColumn:c}=l,{startRow:u,startColumn:d}=a,h=Math.min(c,d),f=Math.max(c+r.__colSpan-1,d+o.__colSpan-1),g=f-h+1;if(i[0].length===f-h+1)return s.selectPrevious(),void s.remove();const p=i.length;for(let y=0;y<p;y++)for(let e=h;e<=f;e++){const{cell:t,startColumn:n}=i[y][e];if(n<h){if(e===h){const e=h-n;t.setColSpan(t.__colSpan-Math.min(g,t.__colSpan-e))}}else if(n+t.__colSpan-1>f){if(e===f){const e=f-n+1;t.setColSpan(t.__colSpan-e)}}else t.remove()}const m=i[u],_=m[d+o.__colSpan];if(void 0!==_){const{cell:e}=_;Dp(e)}else{const e=m[d-1],{cell:t}=e;Dp(t)}}function Dp(e){const t=e.getFirstDescendant();null==t?e.selectStart():t.getParentOrThrow().selectStart()}function Pp(e,t){const n=e.getFirstChild();null!==n?n.insertBefore(t):e.append(t)}function Lp(){const e=hs();Gr(e)||$p(e)||xp(118);const t=e.anchor.getNode(),[n,r,s]=Mp(t),o=n.__colSpan,i=n.__rowSpan;if(o>1){for(let e=1;e<o;e++)n.insertAfter(gp(dp.NO_STATUS));n.setColSpan(1)}if(i>1){const[e,t]=Ip(s,n,n),{startColumn:l,startRow:a}=t;let c;for(let n=1;n<i;n++){const t=a+n,s=e[t];c=(c||r).getNextSibling(),wp(c)||xp(125);let i=null;for(let e=0;e<l;e++){const n=s[e],r=n.cell;n.startRow===t&&(i=r),r.__colSpan>1&&(e+=r.__colSpan-1)}if(null===i)for(let e=0;e<o;e++)Pp(c,gp(dp.NO_STATUS));else for(let e=0;e<o;e++)i.insertAfter(gp(dp.NO_STATUS))}n.setRowSpan(1)}}function Ip(e,t,n){const r=[];let s=null,o=null;function i(e,i,l){const a={cell:l,startColumn:i,startRow:e},c=l.__rowSpan,u=l.__colSpan;for(let t=0;t<c;t++){void 0===r[e+t]&&(r[e+t]=[]);for(let n=0;n<u;n++)r[e+t][i+n]=a}t.is(l)&&(s=a),n.is(l)&&(o=a)}function l(e,t){return void 0===r[e]||void 0===r[e][t]}const a=e.getChildren();for(let c=0;c<a.length;c++){const e=a[c];wp(e)||xp(146);const t=e.getChildren();let n=0;for(const r of t){for(pp(r)||xp(147);!l(c,n);)n++;i(c,n,r),n+=r.__colSpan}}return null===s&&xp(110),null===o&&xp(111),[r,s,o]}function Mp(e){let t;if(e instanceof hp)t=e;else if("__type"in e){const n=Ho(e,pp);pp(n)||xp(148),t=n}else{const n=Ho(e.getNode(),pp);pp(n)||xp(148),t=n}const n=t.getParent();wp(n)||xp(149);const r=n.getParent();return pm(r)||xp(150),[t,n,r]}function Bp(e){const[t,,n]=Mp(e),r=n.getChildren(),s=r.length,o=r[0].getChildren().length,i=new Array(s);for(let l=0;l<s;l++)i[l]=new Array(o);for(let l=0;l<s;l++){const e=r[l].getChildren();let n=0;for(let r=0;r<e.length;r++){for(;i[l][n];)n++;const s=e[r],o=s.__rowSpan||1,a=s.__colSpan||1;for(let e=0;e<o;e++)for(let t=0;t<a;t++)i[l+e][n+t]=s;if(t===s)return{colSpan:a,columnIndex:n,rowIndex:l,rowSpan:o};n+=a}}return null}class zp{constructor(e,t,n){this.anchor=t,this.focus=n,t._selection=this,n._selection=this,this._cachedNodes=null,this.dirty=!1,this.tableKey=e}getStartEndPoints(){return[this.anchor,this.focus]}isBackward(){return this.focus.isBefore(this.anchor)}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!$p(e)&&this.tableKey===e.tableKey&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)}set(e,t,n){this.dirty=!0,this.tableKey=e,this.anchor.key=t,this.focus.key=n,this._cachedNodes=null}clone(){return new zp(this.tableKey,this.anchor,this.focus)}isCollapsed(){return!1}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const t=this.focus.getNode();Js(t)||xp(151),ot(t.select(0,t.getChildrenSize())).insertNodes(e)}getShape(){const e=vt(this.anchor.key);pp(e)||xp(152);const t=Bp(e);null===t&&xp(153);const n=vt(this.focus.key);pp(n)||xp(154);const r=Bp(n);null===r&&xp(155);const s=Math.min(t.columnIndex,r.columnIndex),o=Math.max(t.columnIndex,r.columnIndex),i=Math.min(t.rowIndex,r.rowIndex),l=Math.max(t.rowIndex,r.rowIndex);return{fromX:Math.min(s,o),fromY:Math.min(i,l),toX:Math.max(s,o),toY:Math.max(i,l)}}getNodes(){const e=this._cachedNodes;if(null!==e)return e;const t=this.anchor.getNode(),n=this.focus.getNode(),r=Ho(t,pp),s=Ho(n,pp);pp(r)||xp(152),pp(s)||xp(154);const o=r.getParent();wp(o)||xp(156);const i=o.getParent();pm(i)||xp(157);const l=s.getParents()[1];if(l!==i){if(i.isParentOf(s)){const e=l.getParent();null==e&&xp(159),this.set(this.tableKey,s.getKey(),e.getKey())}else{const e=i.getParent();null==e&&xp(158),this.set(this.tableKey,e.getKey(),s.getKey())}return this.getNodes()}const[a,c,u]=Ip(i,r,s);let d=Math.min(c.startColumn,u.startColumn),h=Math.min(c.startRow,u.startRow),f=Math.max(c.startColumn+c.cell.__colSpan-1,u.startColumn+u.cell.__colSpan-1),g=Math.max(c.startRow+c.cell.__rowSpan-1,u.startRow+u.cell.__rowSpan-1),p=d,m=h,_=d,y=h;function b(e){const{cell:t,startColumn:n,startRow:r}=e;d=Math.min(d,n),h=Math.min(h,r),f=Math.max(f,n+t.__colSpan-1),g=Math.max(g,r+t.__rowSpan-1)}for(;d<p||h<m||f>_||g>y;){if(d<p){const e=y-m,t=p-1;for(let n=0;n<=e;n++)b(a[m+n][t]);p=t}if(h<m){const e=_-p,t=m-1;for(let n=0;n<=e;n++)b(a[t][p+n]);m=t}if(f>_){const e=y-m,t=_+1;for(let n=0;n<=e;n++)b(a[m+n][t]);_=t}if(g>y){const e=_-p,t=y+1;for(let n=0;n<=e;n++)b(a[t][p+n]);y=t}}const w=[i];let x=null;for(let v=h;v<=g;v++)for(let e=d;e<=f;e++){const{cell:t}=a[v][e],n=t.getParent();wp(n)||xp(160),n!==x&&w.push(n),w.push(t,...Kp(t)),x=n}return Ts()||(this._cachedNodes=w),w}getTextContent(){const e=this.getNodes();let t="";for(let n=0;n<e.length;n++)t+=e[n].getTextContent();return t}}function $p(e){return e instanceof zp}function Up(){const e=Jr("root",0,"element"),t=Jr("root",0,"element");return new zp("root",e,t)}function Kp(e){const t=[],n=[e];for(;n.length>0;){const r=n.pop();void 0===r&&xp(112),Js(r)&&n.unshift(...r.getChildren()),r!==e&&t.push(r)}return t}class Wp{constructor(e,t){this.isHighlightingCells=!1,this.anchorX=-1,this.anchorY=-1,this.focusX=-1,this.focusY=-1,this.listenersToRemove=new Set,this.tableNodeKey=t,this.editor=e,this.table={columns:0,domRows:[],rows:0},this.tableSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.trackTable(),this.isSelecting=!1}getTable(){return this.table}removeListeners(){Array.from(this.listenersToRemove).forEach((e=>e()))}trackTable(){const e=new MutationObserver((e=>{this.editor.update((()=>{let t=!1;for(let r=0;r<e.length;r++){const n=e[r].target.nodeName;if("TABLE"===n||"TR"===n){t=!0;break}}if(!t)return;const n=this.editor.getElementByKey(this.tableNodeKey);if(!n)throw new Error("Expected to find TableElement in DOM");this.table=Zp(n)}))}));this.editor.update((()=>{const t=this.editor.getElementByKey(this.tableNodeKey);if(!t)throw new Error("Expected to find TableElement in DOM");this.table=Zp(t),e.observe(t,{childList:!0,subtree:!0})}))}clearHighlight(){const e=this.editor;this.isHighlightingCells=!1,this.anchorX=-1,this.anchorY=-1,this.focusX=-1,this.focusY=-1,this.tableSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.enableHighlightStyle(),e.update((()=>{if(!pm(vt(this.tableNodeKey)))throw new Error("Expected TableNode.");const t=e.getElementByKey(this.tableNodeKey);if(!t)throw new Error("Expected to find TableElement in DOM");const n=Zp(t);Xp(e,n,null),Rt(null),e.dispatchCommand(h,void 0)}))}enableHighlightStyle(){const e=this.editor;e.update((()=>{const t=e.getElementByKey(this.tableNodeKey);if(!t)throw new Error("Expected to find TableElement in DOM");$o(t,e._config.theme.tableSelection),t.classList.remove("disable-selection"),this.hasHijackedSelectionStyles=!1}))}disableHighlightStyle(){const e=this.editor;e.update((()=>{const t=e.getElementByKey(this.tableNodeKey);if(!t)throw new Error("Expected to find TableElement in DOM");zo(t,e._config.theme.tableSelection),this.hasHijackedSelectionStyles=!0}))}updateTableTableSelection(e){if(null!==e&&e.tableKey===this.tableNodeKey){const t=this.editor;this.tableSelection=e,this.isHighlightingCells=!0,this.disableHighlightStyle(),Xp(t,this.table,this.tableSelection)}else null==e?this.clearHighlight():(this.tableNodeKey=e.tableKey,this.updateTableTableSelection(e))}setFocusCellForSelection(e,t=!1){const n=this.editor;n.update((()=>{const r=vt(this.tableNodeKey);if(!pm(r))throw new Error("Expected TableNode.");if(!n.getElementByKey(this.tableNodeKey))throw new Error("Expected to find TableElement in DOM");const s=e.x,o=e.y;if(this.focusCell=e,null!==this.anchorCell){const e=Hp(n._window);e&&e.setBaseAndExtent(this.anchorCell.elem,0,this.focusCell.elem,0)}if(this.isHighlightingCells||this.anchorX===s&&this.anchorY===o&&!t){if(s===this.focusX&&o===this.focusY)return}else this.isHighlightingCells=!0,this.disableHighlightStyle();if(this.focusX=s,this.focusY=o,this.isHighlightingCells){const t=Ct(e.elem);if(null!=this.tableSelection&&null!=this.anchorCellNodeKey&&pp(t)&&r.is(lm(t))){const e=t.getKey();this.tableSelection=this.tableSelection.clone()||Up(),this.focusCellNodeKey=e,this.tableSelection.set(this.tableNodeKey,this.anchorCellNodeKey,this.focusCellNodeKey),Rt(this.tableSelection),n.dispatchCommand(h,void 0),Xp(n,this.table,this.tableSelection)}}}))}setAnchorCellForSelection(e){this.isHighlightingCells=!1,this.anchorCell=e,this.anchorX=e.x,this.anchorY=e.y,this.editor.update((()=>{const t=Ct(e.elem);if(pp(t)){const e=t.getKey();this.tableSelection=null!=this.tableSelection?this.tableSelection.clone():Up(),this.anchorCellNodeKey=e}}))}formatCells(e){this.editor.update((()=>{const t=hs();$p(t)||xp(11);const n=cs(),r=n.anchor,s=n.focus;t.getNodes().forEach((t=>{pp(t)&&0!==t.getTextContentSize()&&(r.set(t.getKey(),0,"element"),s.set(t.getKey(),t.getChildrenSize(),"element"),n.formatText(e))})),Rt(t),this.editor.dispatchCommand(h,void 0)}))}clearText(){const e=this.editor;e.update((()=>{const t=vt(this.tableNodeKey);if(!pm(t))throw new Error("Expected TableNode.");const n=hs();$p(n)||xp(11);const r=n.getNodes().filter(pp);r.length!==this.table.columns*this.table.rows?(r.forEach((e=>{if(Js(e)){const t=to(),n=$r();t.append(n),e.append(t),e.getChildren().forEach((e=>{e!==t&&e.remove()}))}})),Xp(e,this.table,null),Rt(null),e.dispatchCommand(h,void 0)):(t.selectPrevious(),t.remove(),Tt().selectStart())}))}}const jp="__lexicalTableSelection",Hp=e=>vp?(e||window).getSelection():null;function Jp(e,t,n,r){const s=n.getRootElement();if(null===s)throw new Error("No root element.");const o=new Wp(n,e.getKey()),i=n._window||window;var l;l=o,t[jp]=l;const a=()=>{const e=()=>{o.isSelecting=!1,i.removeEventListener("mouseup",e),i.removeEventListener("mousemove",t)},t=e=>{const t=Yp(e.target);null===t||o.anchorX===t.x&&o.anchorY===t.y||(e.preventDefault(),o.setFocusCellForSelection(t))};return{onMouseMove:t,onMouseUp:e}};t.addEventListener("mousedown",(e=>{setTimeout((()=>{if(0!==e.button)return;if(!i)return;const t=Yp(e.target);null!==t&&(cm(e),o.setAnchorCellForSelection(t));const{onMouseUp:n,onMouseMove:r}=a();o.isSelecting=!0,i.addEventListener("mouseup",n),i.addEventListener("mousemove",r)}),0)}));const c=e=>{0===e.button&&n.update((()=>{const t=hs(),n=e.target;$p(t)&&t.tableKey===o.tableNodeKey&&s.contains(n)&&o.clearHighlight()}))};i.addEventListener("mousedown",c),o.listenersToRemove.add((()=>i.removeEventListener("mousedown",c))),o.listenersToRemove.add(n.registerCommand(F,(t=>am(n,t,"down",e,o)),io)),o.listenersToRemove.add(n.registerCommand(O,(t=>am(n,t,"up",e,o)),io)),o.listenersToRemove.add(n.registerCommand(R,(t=>am(n,t,"backward",e,o)),io)),o.listenersToRemove.add(n.registerCommand(T,(t=>am(n,t,"forward",e,o)),io)),o.listenersToRemove.add(n.registerCommand(I,(e=>{const t=hs();if($p(t)){const n=Ho(t.focus.getNode(),pp);if(pp(n))return cm(e),n.selectEnd(),!0}return!1}),io)),[x,v,p].forEach((t=>{o.listenersToRemove.add(n.registerCommand(t,(t=>()=>{const n=hs();if(!tm(n,e))return!1;if($p(n))return o.clearText(),!0;if(Gr(n)){const r=Ho(n.anchor.getNode(),(e=>pp(e)));if(!pp(r))return!1;const s=n.anchor.getNode(),i=n.focus.getNode(),l=e.isParentOf(s),a=e.isParentOf(i);if(l&&!a||a&&!l)return o.clearText(),!0;const c=Ho(n.anchor.getNode(),(e=>Js(e))),u=c&&Ho(c,(e=>Js(e)&&pp(e.getParent())));if(!Js(u)||!Js(c))return!1;if(t===v&&null===u.getPreviousSibling())return!0}return!1})(t),lo))}));const u=t=>{const n=hs();if(!tm(n,e))return!1;if($p(n))return t.preventDefault(),t.stopPropagation(),o.clearText(),!0;if(Gr(n)){const e=Ho(n.anchor.getNode(),(e=>pp(e)));if(!pp(e))return!1}return!1};function d(t){const n=e.getCordsFromCellNode(t,o.table);return e.getDOMCellFromCordsOrThrow(n.x,n.y,o.table)}return o.listenersToRemove.add(n.registerCommand(L,u,lo)),o.listenersToRemove.add(n.registerCommand(M,u,lo)),o.listenersToRemove.add(n.registerCommand(S,(t=>{const n=hs();if(!tm(n,e))return!1;if($p(n))return o.formatCells(t),!0;if(Gr(n)){const e=Ho(n.anchor.getNode(),(e=>pp(e)));if(!pp(e))return!1}return!1}),lo)),o.listenersToRemove.add(n.registerCommand(W,(t=>{const n=hs();if(!$p(n)||!tm(n,e))return!1;const r=n.anchor.getNode(),s=n.focus.getNode();if(!pp(r)||!pp(s))return!1;const[o,i,l]=Ip(e,r,s),a=Math.max(i.startRow,l.startRow),c=Math.max(i.startColumn,l.startColumn),u=Math.min(i.startRow,l.startRow),d=Math.min(i.startColumn,l.startColumn);for(let e=u;e<=a;e++)for(let n=d;n<=c;n++){const r=o[e][n].cell;r.setFormat(t);const s=r.getChildren();for(let e=0;e<s.length;e++){const n=s[e];Js(n)&&!n.isInline()&&n.setFormat(t)}}return!0}),lo)),o.listenersToRemove.add(n.registerCommand(y,(t=>{const r=hs();if(!tm(r,e))return!1;if($p(r))return o.clearHighlight(),!1;if(Gr(r)){const s=Ho(r.anchor.getNode(),(e=>pp(e)));if(!pp(s))return!1;if("string"==typeof t){const s=dm(n,r,e);if(s)return um(s,e,[$r(t)]),!0}}return!1}),lo)),r&&o.listenersToRemove.add(n.registerCommand(B,(t=>{const n=hs();if(!Gr(n)||!n.isCollapsed()||!tm(n,e))return!1;const r=im(n.anchor.getNode());if(null===r)return!1;cm(t);const s=e.getCordsFromCellNode(r,o.table);return Qp(o,e,s.x,s.y,t.shiftKey?"backward":"forward"),!0}),lo)),o.listenersToRemove.add(n.registerCommand(ee,(t=>e.isSelected()),io)),o.listenersToRemove.add(n.registerCommand(f,(e=>{const{nodes:t,selection:n}=e,r=n.getStartEndPoints(),s=$p(n),o=Gr(n)&&null!==Ho(n.anchor.getNode(),(e=>pp(e)))&&null!==Ho(n.focus.getNode(),(e=>pp(e)))||s;if(1!==t.length||!pm(t[0])||!o||null===r)return!1;const[i]=r,l=t[0],a=l.getChildren(),c=l.getFirstChildOrThrow().getChildrenSize(),u=l.getChildrenSize(),d=Ho(i.getNode(),(e=>pp(e))),h=d&&Ho(d,(e=>wp(e))),f=h&&Ho(h,(e=>pm(e)));if(!pp(d)||!wp(h)||!pm(f))return!1;const g=h.getIndexWithinParent(),p=Math.min(f.getChildrenSize()-1,g+u-1),m=d.getIndexWithinParent(),_=Math.min(h.getChildrenSize()-1,m+c-1),y=Math.min(m,_),b=Math.min(g,p),w=Math.max(m,_),x=Math.max(g,p),v=f.getChildren();let S,C,k=0;for(let E=b;E<=x;E++){const e=v[E];if(!wp(e))return!1;const t=a[k];if(!wp(t))return!1;const n=e.getChildren(),r=t.getChildren();let s=0;for(let o=y;o<=w;o++){const e=n[o];if(!pp(e))return!1;const t=r[s];if(!pp(t))return!1;E===b&&o===y?S=e.getKey():E===x&&o===w&&(C=e.getKey());const i=e.getChildren();t.getChildren().forEach((t=>{Ur(t)?(to().append(t),e.append(t)):e.append(t)})),i.forEach((e=>e.remove())),s++}k++}if(S&&C){const e=Up();e.set(t[0].getKey(),S,C),Rt(e)}return!0}),lo)),o.listenersToRemove.add(n.registerCommand(h,(()=>{const t=hs(),r=fs();if(Gr(t)){const{anchor:r,focus:s}=t,l=r.getNode(),c=s.getNode(),u=im(l),h=im(c),f=!(!u||!e.is(lm(u))),g=!(!h||!e.is(lm(h))),p=f!==g,m=f&&g,_=t.isBackward();if(p){const r=t.clone();g?r.focus.set(e.getParentOrThrow().getKey(),_?e.getIndexWithinParent():e.getIndexWithinParent()+1,"element"):r.anchor.set(e.getParentOrThrow().getKey(),_?e.getIndexWithinParent()+1:e.getIndexWithinParent(),"element"),Rt(r),Gp(n,o)}else m&&(u.is(h)||(o.setAnchorCellForSelection(d(u)),o.setFocusCellForSelection(d(h),!0),o.isSelecting||setTimeout((()=>{const{onMouseUp:e,onMouseMove:t}=a();o.isSelecting=!0,i.addEventListener("mouseup",e),i.addEventListener("mousemove",t)}),0)))}else if(t&&$p(t)&&t.is(r)&&t.tableKey===e.getKey()){const r=Hp(n._window);if(r&&r.anchorNode&&r.focusNode){const s=Ct(r.focusNode),o=s&&!e.is(lm(s)),i=Ct(r.anchorNode),l=i&&e.is(lm(i));if(o&&l&&r.rangeCount>0){const s=function(e,t){return ds(null,e,t,null)}(r,n);s&&(s.anchor.set(e.getKey(),t.isBackward()?e.getChildrenSize():0,"element"),r.removeAllRanges(),Rt(s))}}}return t&&!t.is(r)&&($p(t)||$p(r))&&o.tableSelection&&!o.tableSelection.is(r)?($p(t)&&t.tableKey===o.tableNodeKey?o.updateTableTableSelection(t):!$p(t)&&$p(r)&&r.tableKey===o.tableNodeKey&&o.updateTableTableSelection(null),!1):(o.hasHijackedSelectionStyles&&!e.isSelected()?function(e,t){t.enableHighlightStyle(),qp(t.table,(t=>{const n=t.elem;t.highlighted=!1,om(e,t),n.getAttribute("style")||n.removeAttribute("style")}))}(n,o):!o.hasHijackedSelectionStyles&&e.isSelected()&&Gp(n,o),!1)}),lo)),o.listenersToRemove.add(n.registerCommand(_,(()=>{const t=hs();if(!Gr(t)||!t.isCollapsed()||!tm(t,e))return!1;const r=dm(n,t,e);return!!r&&(um(r,e),!0)}),lo)),o}function Vp(e){return e[jp]}function Yp(e){let t=e;for(;null!=t;){const e=t.nodeName;if("TD"===e||"TH"===e){const e=t._cell;return void 0===e?null:e}t=t.parentNode}return null}function Zp(e){const t=[],n={columns:0,domRows:t,rows:0};let r=e.firstChild,s=0,o=0;for(t.length=0;null!=r;){const e=r.nodeName;if("TD"===e||"TH"===e){const e={elem:r,hasBackgroundColor:""!==r.style.backgroundColor,highlighted:!1,x:s,y:o};r._cell=e;let n=t[o];void 0===n&&(n=t[o]=[]),n[s]=e}else{const e=r.firstChild;if(null!=e){r=e;continue}}const n=r.nextSibling;if(null!=n){s++,r=n;continue}const i=r.parentNode;if(null!=i){const e=i.nextSibling;if(null==e)break;o++,s=0,r=e}}return n.columns=s+1,n.rows=o+1,n}function Xp(e,t,n){const r=new Set(n?n.getNodes():[]);qp(t,((t,n)=>{const s=t.elem;r.has(n)?(t.highlighted=!0,sm(e,t)):(t.highlighted=!1,om(e,t),s.getAttribute("style")||s.removeAttribute("style"))}))}function qp(e,t){const{domRows:n}=e;for(let r=0;r<n.length;r++){const e=n[r];if(e)for(let n=0;n<e.length;n++){const s=e[n];if(!s)continue;const o=Ct(s.elem);null!==o&&t(s,o,{x:n,y:r})}}}function Gp(e,t){t.disableHighlightStyle(),qp(t.table,(t=>{t.highlighted=!0,sm(e,t)}))}const Qp=(e,t,n,r,s)=>{const o="forward"===s;switch(s){case"backward":case"forward":return n!==(o?e.table.columns-1:0)?nm(t.getCellNodeFromCordsOrThrow(n+(o?1:-1),r,e.table),o):r!==(o?e.table.rows-1:0)?nm(t.getCellNodeFromCordsOrThrow(o?0:e.table.columns-1,r+(o?1:-1),e.table),o):o?t.selectNext():t.selectPrevious(),!0;case"up":return 0!==r?nm(t.getCellNodeFromCordsOrThrow(n,r-1,e.table),!1):t.selectPrevious(),!0;case"down":return r!==e.table.rows-1?nm(t.getCellNodeFromCordsOrThrow(n,r+1,e.table),!0):t.selectNext(),!0;default:return!1}},em=(e,t,n,r,s)=>{const o="forward"===s;switch(s){case"backward":case"forward":return n!==(o?e.table.columns-1:0)&&e.setFocusCellForSelection(t.getDOMCellFromCordsOrThrow(n+(o?1:-1),r,e.table)),!0;case"up":return 0!==r&&(e.setFocusCellForSelection(t.getDOMCellFromCordsOrThrow(n,r-1,e.table)),!0);case"down":return r!==e.table.rows-1&&(e.setFocusCellForSelection(t.getDOMCellFromCordsOrThrow(n,r+1,e.table)),!0);default:return!1}};function tm(e,t){if(Gr(e)||$p(e)){const n=t.isParentOf(e.anchor.getNode()),r=t.isParentOf(e.focus.getNode());return n&&r}return!1}function nm(e,t){t?e.selectStart():e.selectEnd()}const rm="172,206,247";function sm(e,t){const n=t.elem,r=Ct(n);pp(r)||xp(131),null===r.getBackgroundColor()?n.style.setProperty("background-color",`rgb(${rm})`):n.style.setProperty("background-image",`linear-gradient(to right, rgba(${rm},0.85), rgba(${rm},0.85))`),n.style.setProperty("caret-color","transparent")}function om(e,t){const n=t.elem,r=Ct(n);pp(r)||xp(131),null===r.getBackgroundColor()&&n.style.removeProperty("background-color"),n.style.removeProperty("background-image"),n.style.removeProperty("caret-color")}function im(e){const t=Ho(e,pp);return pp(t)?t:null}function lm(e){const t=Ho(e,pm);return pm(t)?t:null}function am(e,t,n,r,s){const o=hs();if(!tm(o,r)){if("backward"===n&&Gr(o)&&o.isCollapsed()){const e=o.anchor.type,n=o.anchor.offset;if("element"!==e&&("text"!==e||0!==n))return!1;const r=o.anchor.getNode();if(!r)return!1;const s=Ho(r,(e=>Js(e)&&!e.isInline()));if(!s)return!1;const i=s.getPreviousSibling();return!(!i||!pm(i)||(cm(t),i.selectEnd(),0))}return!1}if(Gr(o)&&o.isCollapsed()){const{anchor:h,focus:f}=o,g=Ho(h.getNode(),pp),p=Ho(f.getNode(),pp);if(!pp(g)||!g.is(p))return!1;const m=lm(g);if(m!==r&&null!=m){const r=e.getElementByKey(m.getKey());if(null!=r)return s.table=Zp(r),am(e,t,n,m,s)}if("backward"===n||"forward"===n){const e=h.type,s=h.offset,o=h.getNode();return!!o&&(l=s,u=a=o,d=c=n,!!("element"===(i=e)&&("backward"===d?null===u.getPreviousSibling():null===u.getNextSibling())||function(e,t,n,r){const s=Ho(n,(e=>Js(e)&&!e.isInline()));if(!s)return!1;const o="backward"===r?0===t:t===n.getTextContentSize();return"text"===e&&o&&("backward"===r?null===s.getPreviousSibling():null===s.getNextSibling())}(i,l,a,c))&&function(e,t,n,r){const s=Ho(t,pp);if(!pp(s))return!1;const[o,i]=Ip(n,s,s);if(!function(e,t,n){const r=e[0][0],s=e[e.length-1][e[0].length-1],{startColumn:o,startRow:i}=t;return"backward"===n?o===r.startColumn&&i===r.startRow:o===s.startColumn&&i===s.startRow}(o,i,r))return!1;const l=function(e,t,n){const r=Ho(e,(e=>Js(e)&&!e.isInline()));if(!r)return;const s="backward"===t?r.getPreviousSibling():r.getNextSibling();return s&&pm(s)?s:"backward"===t?n.getPreviousSibling():n.getNextSibling()}(t,r,n);return!(!l||pm(l))&&(cm(e),"backward"===r?l.selectEnd():l.selectStart(),!0)}(t,o,r,n))}const _=e.getElementByKey(g.__key),y=e.getElementByKey(h.key);if(null==y||null==_)return!1;let b;if("element"===h.type)b=y.getBoundingClientRect();else{const e=window.getSelection();if(null===e||0===e.rangeCount)return!1;b=e.getRangeAt(0).getBoundingClientRect()}const w="up"===n?g.getFirstChild():g.getLastChild();if(null==w)return!1;const x=e.getElementByKey(w.__key);if(null==x)return!1;const v=x.getBoundingClientRect();if("up"===n?v.top>b.top-b.height:b.bottom+b.height>v.bottom){cm(t);const e=r.getCordsFromCellNode(g,s.table);if(!t.shiftKey)return Qp(s,r,e.x,e.y,n);{const t=r.getDOMCellFromCordsOrThrow(e.x,e.y,s.table);s.setAnchorCellForSelection(t),s.setFocusCellForSelection(t,!0)}return!0}}else if($p(o)){const{anchor:i,focus:l}=o,a=Ho(i.getNode(),pp),c=Ho(l.getNode(),pp),[u]=o.getNodes(),d=e.getElementByKey(u.getKey());if(!pp(a)||!pp(c)||!pm(u)||null==d)return!1;s.updateTableTableSelection(o);const h=Zp(d),f=r.getCordsFromCellNode(a,h),g=r.getDOMCellFromCordsOrThrow(f.x,f.y,h);if(s.setAnchorCellForSelection(g),cm(t),t.shiftKey){const e=r.getCordsFromCellNode(c,h);return em(s,u,e.x,e.y,n)}return c.selectEnd(),!0}var i,l,a,c,u,d;return!1}function cm(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation()}function um(e,t,n){const r=to();"first"===e?t.insertBefore(r):t.insertAfter(r),r.append(...n||[]),r.selectEnd()}function dm(e,t,n){const r=window.getSelection();if(!r||r.anchorNode!==e.getRootElement())return;const s=Ho(t.anchor.getNode(),(e=>pp(e)));if(!s)return;const o=Ho(s,(e=>pm(e)));if(!pm(o)||!o.is(n))return;const[i,l]=Ip(n,s,s),a=i[0][0],c=i[i.length-1][i[0].length-1],{startRow:u,startColumn:d}=l,h=u===a.startRow&&d===a.startColumn,f=u===c.startRow&&d===c.startColumn;return h?"first":f?"last":void 0}class hm extends Hs{static getType(){return"table"}static clone(e){return new hm(e.__key)}static importDOM(){return{table:e=>({conversion:fm,priority:1})}}static importJSON(e){return gm()}constructor(e){super(e)}exportJSON(){return{...super.exportJSON(),type:"table",version:1}}createDOM(e,t){const n=document.createElement("table");return zo(n,e.theme.table),n}updateDOM(){return!1}exportDOM(e){return{...super.exportDOM(e),after:e=>{if(e){const t=e.cloneNode(),n=document.createElement("colgroup"),r=document.createElement("tbody");hn(e)&&r.append(...e.children);const s=this.getFirstChildOrThrow();if(!wp(s))throw new Error("Expected to find row node.");const o=s.getChildrenSize();for(let e=0;e<o;e++){const e=document.createElement("col");n.append(e)}return t.replaceChildren(n,r),t}}}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,t){const{rows:n,domRows:r}=t;for(let s=0;s<n;s++){const t=r[s];if(null==t)continue;const n=t.findIndex((t=>{if(!t)return;const{elem:n}=t;return Ct(n)===e}));if(-1!==n)return{x:n,y:s}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,t,n){const{domRows:r}=n,s=r[t];if(null==s)return null;const o=s[e];return null==o?null:o}getDOMCellFromCordsOrThrow(e,t,n){const r=this.getDOMCellFromCords(e,t,n);if(!r)throw new Error("Cell not found at cords.");return r}getCellNodeFromCords(e,t,n){const r=this.getDOMCellFromCords(e,t,n);if(null==r)return null;const s=Ct(r.elem);return pp(s)?s:null}getCellNodeFromCordsOrThrow(e,t,n){const r=this.getCellNodeFromCords(e,t,n);if(!r)throw new Error("Node at cords not TableCellNode.");return r}canSelectBefore(){return!0}canIndent(){return!1}}function fm(e){return{node:gm()}}function gm(){return sn(new hm)}function pm(e){return e instanceof hm}function mm({hasCellMerge:e=!0,hasCellBackgroundColor:t=!0,hasTabHandler:n=!0}){const[r]=Wi();return React.useEffect((()=>(r.hasNodes([hm,hp,_p])||function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(10),r.registerCommand(mp,(({columns:e,rows:t,includeHeaders:n})=>{const r=function(e,t,n=!0){const r=gm();for(let s=0;s<e;s++){const e=bp();for(let r=0;r<t;r++){let t=dp.NO_STATUS;"object"==typeof n?(0===s&&n.rows&&(t|=dp.ROW),0===r&&n.columns&&(t|=dp.COLUMN)):n&&(0===s&&(t|=dp.ROW),0===r&&(t|=dp.COLUMN));const o=gp(t),i=to();i.append($r()),o.append(i),e.append(o)}r.append(e)}return r}(Number(t),Number(e),n);Yo(r);const s=r.getFirstDescendant();return Ur(s)&&s.select(),!0}),ro))),[r]),React.useEffect((()=>{const e=new Map,t=t=>{const s=t.getKey(),o=r.getElementByKey(s);if(o&&!e.has(s)){const i=Jp(t,o,r,n);e.set(s,i)}};r.getEditorState().read((()=>{const e=function(e){const t=As(),n=t._readOnly,r=e.getType(),s=t._nodeMap,o=[];for(const[,i]of s)i instanceof e&&i.__type===r&&(n||i.isAttached())&&o.push(i);return o}(hm);for(const n of e)pm(n)&&t(n)}));const s=r.registerMutationListener(hm,(n=>{for(const[s,o]of n)if("created"===o)r.getEditorState().read((()=>{const e=vt(s);pm(e)&&t(e)}));else if("destroyed"===o){const t=e.get(s);void 0!==t&&(t.removeListeners(),e.delete(s))}}));return()=>{s();for(const[,t]of e)t.removeListeners()}}),[r,n]),React.useEffect((()=>{if(!e)return r.registerNodeTransform(hp,(e=>{if(e.getColSpan()>1||e.getRowSpan()>1){const[,,t]=Mp(e),[n]=Ip(t,e,e),r=n.length,s=n[0].length;let o=t.getFirstChild();if(!wp(o))throw Error("Expected TableNode first child to be a RowNode");const i=[];for(let e=0;e<r;e++){if(0!==e&&(o=o.getNextSibling(),!wp(o)))throw Error("Expected TableNode first child to be a RowNode");let t=null;for(let r=0;r<s;r++){const s=n[e][r],l=s.cell;if(s.startRow===e&&s.startColumn===r)t=l,i.push(l);else if(l.getColSpan()>1||l.getRowSpan()>1){if(!pp(l))throw Error("Expected TableNode cell to be a TableCellNode");const e=gp(l.__headerState);null!==t?t.insertAfter(e):qo(o,e)}}}for(const e of i)e.setColSpan(1),e.setRowSpan(1)}}))}),[r,e]),React.useEffect((()=>{if(!t)return r.registerNodeTransform(hp,(e=>{null!==e.getBackgroundColor()&&e.setBackgroundColor(null)}))}),[r,t,e]),null}const _m=new Map;const ym="undefined"==typeof BroadcastChannel?class{constructor(e){var t;this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:Yc(t.newValue||"")}),t=this._onChange,Nc||addEventListener("storage",t)}postMessage(e){Rc.setItem(this.room,Vc(new Uint8Array(e)))}close(){var e;e=this._onChange,Nc||removeEventListener("storage",e)}}:BroadcastChannel,bm=e=>la(_m,e,(()=>{const t=aa(),n=new ym(e);return n.onmessage=e=>t.forEach((t=>t(e.data,"broadcastchannel"))),{bc:n,subs:t}})),wm=(e,t,n=null)=>{const r=bm(e);r.bc.postMessage(t),r.subs.forEach((e=>e(t,n)))},xm=(e,t)=>{za(e,0);const n=(e=>zu(e,new Ru))(t);Ha(e,n)},vm=(e,t,n)=>{za(e,1),Ha(e,((e,t)=>Iu(e,t,new Au))(t,n))},Sm=(e,t,n)=>{try{((e,t,n)=>{Lu(e,t,n,Eu)})(t,ac(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Cm=Sm,km=(e,t,n,r)=>{const s=uc(e);switch(s){case 0:((e,t,n)=>{vm(t,n,ac(e))})(e,t,n);break;case 1:Sm(e,n,r);break;case 2:Cm(e,n,r);break;default:throw new Error("Unknown message type")}return s},Em=3e4;class Tm extends ga{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const e=Cc();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach(((n,r)=>{r!==this.clientID&&Em<=e-n.lastUpdated&&this.states.has(r)&&t.push(r)})),t.length>0&&Nm(this,t,"timeout")}),pa(3e3)),e.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,n=this.meta.get(t),r=void 0===n?0:n.clock+1,s=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:r,lastUpdated:Cc()});const o=[],i=[],l=[],a=[];null===e?a.push(t):null==s?null!=e&&o.push(t):(i.push(t),Ic(s,e)||l.push(t)),(o.length>0||l.length>0||a.length>0)&&this.emit("change",[{added:o,updated:l,removed:a},"local"]),this.emit("update",[{added:o,updated:i,removed:a},"local"])}setLocalStateField(e,t){const n=this.getLocalState();null!==n&&this.setLocalState({...n,[e]:t})}getStates(){return this.states}}const Nm=(e,t,n)=>{const r=[];for(let s=0;s<t.length;s++){const n=t[s];if(e.states.has(n)){if(e.states.delete(n),n===e.clientID){const t=e.meta.get(n);e.meta.set(n,{clock:t.clock+1,lastUpdated:Cc()})}r.push(n)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},Rm=(e,t,n=e.states)=>{const r=t.length,s=Pa();za(s,r);for(let o=0;o<r;o++){const r=t[o],i=n.get(r)||null,l=e.meta.get(r).clock;za(s,r),za(s,l),Wa(s,JSON.stringify(i))}return Ia(s)},Am=[];Am[0]=(e,t,n,r,s)=>{za(e,0);const o=km(t,e,n.doc,n);r&&1===o&&!n.synced&&(n.synced=!0)},Am[3]=(e,t,n,r,s)=>{za(e,1),Ha(e,Rm(n.awareness,Array.from(n.awareness.getStates().keys())))},Am[1]=(e,t,n,r,s)=>{((e,t,n)=>{const r=lc(t),s=Cc(),o=[],i=[],l=[],a=[],c=uc(r);for(let u=0;u<c;u++){const t=uc(r);let n=uc(r);const c=JSON.parse(hc(r)),u=e.meta.get(t),d=e.states.get(t),h=void 0===u?0:u.clock;(h<n||h===n&&null===c&&e.states.has(t))&&(null===c?t===e.clientID&&null!=e.getLocalState()?n++:e.states.delete(t):e.states.set(t,c),e.meta.set(t,{clock:n,lastUpdated:s}),void 0===u&&null!==c?o.push(t):void 0!==u&&null===c?a.push(t):null!==c&&(Ic(c,d)||l.push(t),i.push(t)))}(o.length>0||l.length>0||a.length>0)&&e.emit("change",[{added:o,updated:l,removed:a},n]),(o.length>0||i.length>0||a.length>0)&&e.emit("update",[{added:o,updated:i,removed:a},n])})(n.awareness,ac(t),n)},Am[2]=(e,t,n,r,s)=>{((e,t,n)=>{0===uc(e)&&n(t,hc(e))})(t,n.doc,((e,t)=>Om(n,t)))};const Om=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),Fm=(e,t,n)=>{const r=lc(t),s=Pa(),o=uc(r),i=e.messageHandlers[o];return i?i(s,r,e,n,o):console.error("Unable to compute message"),s},Dm=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=n=>{e.wsLastMessageReceived=Cc();const r=Fm(e,new Uint8Array(n.data),!0);La(r)>1&&t.send(Ia(r))},t.onerror=t=>{e.emit("connection-error",[t,e])},t.onclose=t=>{e.emit("connection-close",[t,e]),e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,Nm(e.awareness,Array.from(e.awareness.getStates().keys()).filter((t=>t!==e.doc.clientID)),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(Dm,_a(100*ba(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e)},t.onopen=()=>{e.wsLastMessageReceived=Cc(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const n=Pa();if(za(n,0),xm(n,e.doc),t.send(Ia(n)),null!==e.awareness.getLocalState()){const n=Pa();za(n,1),Ha(n,Rm(e.awareness,[e.doc.clientID])),t.send(Ia(n))}},e.emit("status",[{status:"connecting"}])}},Pm=(e,t)=>{const n=e.ws;e.wsconnected&&n&&n.readyState===n.OPEN&&n.send(t),e.bcconnected&&wm(e.bcChannel,t,e)};class Lm extends ga{constructor(e,t,n,{connect:r=!0,awareness:s=new Tm(n),params:o={},WebSocketPolyfill:i=WebSocket,resyncInterval:l=-1,maxBackoffTime:a=2500,disableBc:c=!1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);const u=(e=>((e,t)=>{const n=[];for(const r in e)n.push(t(e[r],r));return n})(e,((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&"))(o);this.maxBackoffTime=a,this.bcChannel=e+"/"+t,this.url=e+"/"+t+(0===u.length?"":"?"+u),this.roomname=t,this.doc=n,this._WS=i,this.awareness=s,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=c,this.wsUnsuccessfulReconnects=0,this.messageHandlers=Am.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=r,this._resyncInterval=0,l>0&&(this._resyncInterval=setInterval((()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const e=Pa();za(e,0),xm(e,n),this.ws.send(Ia(e))}}),l)),this._bcSubscriber=(e,t)=>{if(t!==this){const t=Fm(this,new Uint8Array(e),!1);La(t)>1&&wm(this.bcChannel,Ia(t),this)}},this._updateHandler=(e,t)=>{if(t!==this){const t=Pa();za(t,0),((e,t)=>{za(e,2),Ha(e,t)})(t,e),Pm(this,Ia(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:n},r)=>{const o=e.concat(t).concat(n),i=Pa();za(i,1),Ha(i,Rm(s,o)),Pm(this,Ia(i))},this._exitHandler=()=>{Nm(this.awareness,[n.clientID],"app closed")},Bc&&"undefined"!=typeof process&&process.on("exit",this._exitHandler),s.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval((()=>{this.wsconnected&&3e4<Cc()-this.wsLastMessageReceived&&this.ws.close()}),3e3),r&&this.connect()}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),Bc&&"undefined"!=typeof process&&process.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;var e,t;this.bcconnected||(e=this.bcChannel,t=this._bcSubscriber,bm(e).subs.add(t),this.bcconnected=!0);const n=Pa();za(n,0),xm(n,this.doc),wm(this.bcChannel,Ia(n),this);const r=Pa();za(r,0),vm(r,this.doc),wm(this.bcChannel,Ia(r),this);const s=Pa();za(s,3),wm(this.bcChannel,Ia(s),this);const o=Pa();za(o,1),Ha(o,Rm(this.awareness,[this.doc.clientID])),wm(this.bcChannel,Ia(o),this)}disconnectBc(){const e=Pa();za(e,1),Ha(e,Rm(this.awareness,[this.doc.clientID],new Map)),Pm(this,Ia(e)),this.bcconnected&&(((e,t)=>{const n=bm(e),r=n.subs.delete(t);r&&0===n.subs.size&&(n.bc.close(),_m.delete(e))})(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(Dm(this),this.connectBc())}}var Im,Mm;Im={exports:{}},Mm=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,n=0,r={},s={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof o?new o(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++n}),e.__id},clone:function e(t,n){var r,o;switch(n=n||{},s.util.type(t)){case"Object":if(o=s.util.objId(t),n[o])return n[o];for(var i in r={},n[o]=r,t)t.hasOwnProperty(i)&&(r[i]=e(t[i],n));return r;case"Array":return o=s.util.objId(t),n[o]?n[o]:(r=[],n[o]=r,t.forEach((function(t,s){r[s]=e(t,n)})),r);default:return t}},getLanguage:function(e){for(;e;){var n=t.exec(e.className);if(n)return n[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,n){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+n)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw new Error}catch(r){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(r.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var n in t)if(t[n].src==e)return t[n]}return null}},isActive:function(e,t,n){for(var r="no-"+t;e;){var s=e.classList;if(s.contains(t))return!0;if(s.contains(r))return!1;e=e.parentElement}return!!n}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(e,t){var n=s.util.clone(s.languages[e]);for(var r in t)n[r]=t[r];return n},insertBefore:function(e,t,n,r){var o=(r=r||s.languages)[e],i={};for(var l in o)if(o.hasOwnProperty(l)){if(l==t)for(var a in n)n.hasOwnProperty(a)&&(i[a]=n[a]);n.hasOwnProperty(l)||(i[l]=o[l])}var c=r[e];return r[e]=i,s.languages.DFS(s.languages,(function(t,n){n===c&&t!=e&&(this[t]=i)})),i},DFS:function e(t,n,r,o){o=o||{};var i=s.util.objId;for(var l in t)if(t.hasOwnProperty(l)){n.call(t,l,t[l],r||l);var a=t[l],c=s.util.type(a);"Object"!==c||o[i(a)]?"Array"!==c||o[i(a)]||(o[i(a)]=!0,e(a,n,l,o)):(o[i(a)]=!0,e(a,n,null,o))}}},plugins:{},highlightAll:function(e,t){s.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var r={callback:n,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};s.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),s.hooks.run("before-all-elements-highlight",r);for(var o,i=0;o=r.elements[i++];)s.highlightElement(o,!0===t,r.callback)},highlightElement:function(t,n,r){var o=s.util.getLanguage(t),i=s.languages[o];s.util.setLanguage(t,o);var l=t.parentElement;l&&"pre"===l.nodeName.toLowerCase()&&s.util.setLanguage(l,o);var a={element:t,language:o,grammar:i,code:t.textContent};function c(e){a.highlightedCode=e,s.hooks.run("before-insert",a),a.element.innerHTML=a.highlightedCode,s.hooks.run("after-highlight",a),s.hooks.run("complete",a),r&&r.call(a.element)}if(s.hooks.run("before-sanity-check",a),(l=a.element.parentElement)&&"pre"===l.nodeName.toLowerCase()&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!a.code)return s.hooks.run("complete",a),void(r&&r.call(a.element));if(s.hooks.run("before-highlight",a),a.grammar)if(n&&e.Worker){var u=new Worker(s.filename);u.onmessage=function(e){c(e.data)},u.postMessage(JSON.stringify({language:a.language,code:a.code,immediateClose:!0}))}else c(s.highlight(a.code,a.grammar,a.language));else c(s.util.encode(a.code))},highlight:function(e,t,n){var r={code:e,grammar:t,language:n};if(s.hooks.run("before-tokenize",r),!r.grammar)throw new Error('The language "'+r.language+'" has no grammar.');return r.tokens=s.tokenize(r.code,r.grammar),s.hooks.run("after-tokenize",r),o.stringify(s.util.encode(r.tokens),r.language)},tokenize:function(e,t){var n=t.rest;if(n){for(var r in n)t[r]=n[r];delete t.rest}var s=new a;return c(s,s.head,e),l(e,s,t,s.head,0),function(e){for(var t=[],n=e.head.next;n!==e.tail;)t.push(n.value),n=n.next;return t}(s)},hooks:{all:{},add:function(e,t){var n=s.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=s.hooks.all[e];if(n&&n.length)for(var r,o=0;r=n[o++];)r(t)}},Token:o};function o(e,t,n,r){this.type=e,this.content=t,this.alias=n,this.length=0|(r||"").length}function i(e,t,n,r){e.lastIndex=t;var s=e.exec(n);if(s&&r&&s[1]){var o=s[1].length;s.index+=o,s[0]=s[0].slice(o)}return s}function l(e,t,n,r,a,d){for(var h in n)if(n.hasOwnProperty(h)&&n[h]){var f=n[h];f=Array.isArray(f)?f:[f];for(var g=0;g<f.length;++g){if(d&&d.cause==h+","+g)return;var p=f[g],m=p.inside,_=!!p.lookbehind,y=!!p.greedy,b=p.alias;if(y&&!p.pattern.global){var w=p.pattern.toString().match(/[imsuy]*$/)[0];p.pattern=RegExp(p.pattern.source,w+"g")}for(var x=p.pattern||p,v=r.next,S=a;v!==t.tail&&!(d&&S>=d.reach);S+=v.value.length,v=v.next){var C=v.value;if(t.length>e.length)return;if(!(C instanceof o)){var k,E=1;if(y){if(!(k=i(x,S,e,_))||k.index>=e.length)break;var T=k.index,N=k.index+k[0].length,R=S;for(R+=v.value.length;T>=R;)R+=(v=v.next).value.length;if(S=R-=v.value.length,v.value instanceof o)continue;for(var A=v;A!==t.tail&&(R<N||"string"==typeof A.value);A=A.next)E++,R+=A.value.length;E--,C=e.slice(S,R),k.index-=S}else if(!(k=i(x,0,C,_)))continue;T=k.index;var O=k[0],F=C.slice(0,T),D=C.slice(T+O.length),P=S+C.length;d&&P>d.reach&&(d.reach=P);var L=v.prev;if(F&&(L=c(t,L,F),S+=F.length),u(t,L,E),v=c(t,L,new o(h,m?s.tokenize(O,m):O,b,O)),D&&c(t,v,D),E>1){var I={cause:h+","+g,reach:P};l(e,t,n,v.prev,S,I),d&&I.reach>d.reach&&(d.reach=I.reach)}}}}}}function a(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function c(e,t,n){var r=t.next,s={value:n,prev:t,next:r};return t.next=s,r.prev=s,e.length++,s}function u(e,t,n){for(var r=t.next,s=0;s<n&&r!==e.tail;s++)r=r.next;t.next=r,r.prev=t,e.length-=s}if(e.Prism=s,o.stringify=function e(t,n){if("string"==typeof t)return t;if(Array.isArray(t)){var r="";return t.forEach((function(t){r+=e(t,n)})),r}var o={type:t.type,content:e(t.content,n),tag:"span",classes:["token",t.type],attributes:{},language:n},i=t.alias;i&&(Array.isArray(i)?Array.prototype.push.apply(o.classes,i):o.classes.push(i)),s.hooks.run("wrap",o);var l="";for(var a in o.attributes)l+=" "+a+'="'+(o.attributes[a]||"").replace(/"/g,"&quot;")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+l+">"+o.content+"</"+o.tag+">"},!e.document)return e.addEventListener?(s.disableWorkerMessageHandler||e.addEventListener("message",(function(t){var n=JSON.parse(t.data),r=n.language,o=n.code,i=n.immediateClose;e.postMessage(s.highlight(o,s.languages[r],r)),i&&e.close()}),!1),s):s;var d=s.util.currentScript();function h(){s.manual||s.highlightAll()}if(d&&(s.filename=d.src,d.hasAttribute("data-manual")&&(s.manual=!0)),!s.manual){var f=document.readyState;"loading"===f||"interactive"===f&&d&&d.defer?document.addEventListener("DOMContentLoaded",h):window.requestAnimationFrame?window.requestAnimationFrame(h):window.setTimeout(h,16)}return s}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{}),Im.exports&&(Im.exports=Mm),void 0!==e&&(e.Prism=Mm),Mm.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},Mm.languages.markup.tag.inside["attr-value"].inside.entity=Mm.languages.markup.entity,Mm.languages.markup.doctype.inside["internal-subset"].inside=Mm.languages.markup,Mm.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(Mm.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Mm.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var r={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};r["language-"+t]={pattern:/[\s\S]+/,inside:Mm.languages[t]};var s={};s[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:r},Mm.languages.insertBefore("markup","cdata",s)}}),Object.defineProperty(Mm.languages.markup.tag,"addAttribute",{value:function(e,t){Mm.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Mm.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),Mm.languages.html=Mm.languages.markup,Mm.languages.mathml=Mm.languages.markup,Mm.languages.svg=Mm.languages.markup,Mm.languages.xml=Mm.languages.extend("markup",{}),Mm.languages.ssml=Mm.languages.xml,Mm.languages.atom=Mm.languages.xml,Mm.languages.rss=Mm.languages.xml,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(Mm),Mm.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},Mm.languages.javascript=Mm.languages.extend("clike",{"class-name":[Mm.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),Mm.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,Mm.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Mm.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Mm.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Mm.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Mm.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Mm.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),Mm.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Mm.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),Mm.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),Mm.languages.markup&&(Mm.languages.markup.tag.addInlined("script","javascript"),Mm.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),Mm.languages.js=Mm.languages.javascript,function(){if(void 0!==Mm&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},t="data-src-status",n="loading",r="loaded",s="pre[data-src]:not(["+t+'="'+r+'"]):not(['+t+'="'+n+'"])';Mm.hooks.add("before-highlightall",(function(e){e.selector+=", "+s})),Mm.hooks.add("before-sanity-check",(function(o){var i=o.element;if(i.matches(s)){o.code="",i.setAttribute(t,n);var l=i.appendChild(document.createElement("CODE"));l.textContent="Loading…";var a=i.getAttribute("data-src"),c=o.language;if("none"===c){var u=(/\.(\w+)$/.exec(a)||[,"none"])[1];c=e[u]||u}Mm.util.setLanguage(l,c),Mm.util.setLanguage(i,c);var d=Mm.plugins.autoloader;d&&d.loadLanguages(c),function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4==r.readyState&&(r.status<400&&r.responseText?t(r.responseText):r.status>=400?n("✖ Error "+r.status+" while fetching file: "+r.statusText):n("✖ Error: File does not exist or is empty"))},r.send(null)}(a,(function(e){i.setAttribute(t,r);var n=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var n=Number(t[1]),r=t[2],s=t[3];return r?s?[n,Number(s)]:[n,void 0]:[n,n]}}(i.getAttribute("data-range"));if(n){var s=e.split(/\r\n?|\n/g),o=n[0],a=null==n[1]?s.length:n[1];o<0&&(o+=s.length),o=Math.max(0,Math.min(o-1,s.length)),a<0&&(a+=s.length),a=Math.max(0,Math.min(a,s.length)),e=s.slice(o,a).join("\n"),i.hasAttribute("data-start")||i.setAttribute("data-start",String(o+1))}l.textContent=e,Mm.highlightElement(l)}),(function(e){i.setAttribute(t,"failed"),l.textContent=e}))}})),Mm.plugins.fileHighlight={highlight:function(e){for(var t,n=(e||document).querySelectorAll(s),r=0;t=n[r++];)Mm.highlightElement(t)}};var o=!1;Mm.fileHighlight=function(){o||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),o=!0),Mm.plugins.fileHighlight.highlight.apply(this,arguments)}}}(),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),Prism.languages.js=Prism.languages.javascript,Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity,Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup,Prism.hooks.add("wrap",(function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))})),Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(e,t){var n={};n["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[t]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var r={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};r["language-"+t]={pattern:/[\s\S]+/,inside:Prism.languages[t]};var s={};s[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,(function(){return e})),"i"),lookbehind:!0,greedy:!0,inside:r},Prism.languages.insertBefore("markup","cdata",s)}}),Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),Prism.languages.html=Prism.languages.markup,Prism.languages.mathml=Prism.languages.markup,Prism.languages.svg=Prism.languages.markup,Prism.languages.xml=Prism.languages.extend("markup",{}),Prism.languages.ssml=Prism.languages.xml,Prism.languages.atom=Prism.languages.xml,Prism.languages.rss=Prism.languages.xml,function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(e){return e=e.replace(/<inner>/g,(function(){return t})),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+e+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,(function(){return r})),o=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+o+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+o+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+o+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach((function(t){["url","bold","italic","strike","code-snippet"].forEach((function(n){t!==n&&(e.languages.markdown[t].inside.content.inside[n]=e.languages.markdown[n])}))})),e.hooks.add("after-tokenize",(function(e){"markdown"!==e.language&&"md"!==e.language||function e(t){if(t&&"string"!=typeof t)for(var n=0,r=t.length;n<r;n++){var s=t[n];if("code"===s.type){var o=s.content[1],i=s.content[3];if(o&&i&&"code-language"===o.type&&"code-block"===i.type&&"string"==typeof o.content){var l=o.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp"),a="language-"+(l=(/[a-z][\w-]*/i.exec(l)||[""])[0].toLowerCase());i.alias?"string"==typeof i.alias?i.alias=[i.alias,a]:i.alias.push(a):i.alias=[a]}}else e(s.content)}}(e.tokens)})),e.hooks.add("wrap",(function(t){if("code-block"===t.type){for(var n="",r=0,s=t.classes.length;r<s;r++){var o=t.classes[r],c=/language-(.+)/.exec(o);if(c){n=c[1];break}}var u,d,h=e.languages[n];if(h)t.content=e.highlight((u=t.content,d=(d=u.replace(i,"")).replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,(function(e,t){var n;if("#"===(t=t.toLowerCase())[0])return n="x"===t[1]?parseInt(t.slice(2),16):Number(t.slice(1)),a(n);var r=l[t];return r||e})),d),h,n);else if(n&&"none"!==n&&e.plugins.autoloader){var f="md-"+(new Date).valueOf()+"-"+Math.floor(1e16*Math.random());t.attributes.id=f,e.plugins.autoloader.loadLanguages(n,(function(){var t=document.getElementById(f);t&&(t.innerHTML=e.highlight(t.textContent,e.languages[n],n))}))}}}));var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),l={amp:"&",lt:"<",gt:">",quot:'"'},a=String.fromCodePoint||String.fromCharCode;e.languages.md=e.languages.markdown}(Prism),Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/}),Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}}),Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}}),Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/}),delete Prism.languages.c.boolean,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var n=e.languages.markup;n&&(n.tag.addInlined("style","css"),n.tag.addAttribute("style","css"))}(Prism),Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/}),delete Prism.languages.objectivec["class-name"],Prism.languages.objc=Prism.languages.objectivec,Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/},Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,(function(){return t}));t=t.replace(/<self>/g,(function(){return/[^\s\S]/.source})),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism),Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+/(?:elseif|if)\b/.source+"(?:[ \t]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/},Prism.languages.swift["string-literal"].forEach((function(e){e.inside.interpolation.inside=Prism.languages.swift})),function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism),function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,n=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,r={pattern:RegExp(/(^|[^\w.])/.source+n+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[r,{pattern:RegExp(/(^|[^\w.])/.source+n+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:r.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+n+/[A-Z]\w*\b/.source),lookbehind:!0,inside:r.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":r,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+n+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:r.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+n+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:r.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,(function(){return t.source}))),lookbehind:!0,inside:{punctuation:/\./}}})}(Prism),function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,n=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,(function(){return t.source}));e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,(function(){return t.source}))),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,(function(){return n}))+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])}(Prism);const Bm=e=>null!=e&&window.Prism.languages.hasOwnProperty(e)?e:void 0;function zm(e,t){for(const n of e.childNodes){if(hn(n)&&n.tagName===t)return!0;zm(n,t)}return!1}const $m="data-highlight-language";let Um=class e extends Hs{static getType(){return"code"}static clone(t){return new e(t.__language,t.__key)}constructor(e,t){super(t),this.__language=Bm(e)}createDOM(e){const t=document.createElement("code");zo(t,e.theme.code),t.setAttribute("spellcheck","false");const n=this.getLanguage();return n&&t.setAttribute($m,n),t}updateDOM(e,t,n){const r=this.__language,s=e.__language;return r?r!==s&&t.setAttribute($m,r):s&&t.removeAttribute($m),!1}exportDOM(e){const t=document.createElement("pre");zo(t,e._config.theme.code),t.setAttribute("spellcheck","false");const n=this.getLanguage();return n&&t.setAttribute($m,n),{element:t}}static importDOM(){return{code:e=>null!=e.textContent&&(/\r?\n/.test(e.textContent)||zm(e,"BR"))?{conversion:jm,priority:1}:null,div:e=>({conversion:Hm,priority:1}),pre:e=>({conversion:jm,priority:0}),table:e=>Xm(e)?{conversion:Jm,priority:3}:null,td:e=>{const t=e,n=t.closest("table");return t.classList.contains("js-file-line")?{conversion:Ym,priority:3}:n&&Xm(n)?{conversion:Vm,priority:3}:null},tr:e=>{const t=e.closest("table");return t&&Xm(t)?{conversion:Vm,priority:3}:null}}}static importJSON(e){const t=Km(e.language);return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),type:"code",version:1}}insertNewAfter(e,t=!0){const n=this.getChildren(),r=n.length;if(r>=2&&"\n"===n[r-1].getTextContent()&&"\n"===n[r-2].getTextContent()&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===r){n[r-1].remove(),n[r-2].remove();const e=to();return this.insertAfter(e,t),e}const{anchor:s,focus:o}=e,i=(s.isBefore(o)?s:o).getNode();if(Ur(i)){let e=o_(i);const t=[];for(;;)if(jr(e))t.push(Wr()),e=e.getNextSibling();else{if(!s_(e))break;{let n=0;const r=e.getTextContent(),s=e.getTextContentSize();for(;n<s&&" "===r[n];)n++;if(0!==n&&t.push(r_(" ".repeat(n))),n!==s)break;e=e.getNextSibling()}}const n=i.splitText(s.offset)[0],r=0===s.offset?0:1,o=n.getIndexWithinParent()+r,l=i.getParentOrThrow(),a=[xr(),...t];l.splice(o,0,a);const c=t[t.length-1];c?c.select():0===s.offset?n.selectPrevious():n.getNextSibling().selectNext(0,0)}if(Wm(i)){const{offset:t}=e.anchor;i.splice(t,0,[xr()]),i.select(t+1,t+1)}return null}canIndent(){return!1}collapseAtStart(){const e=to();return this.getChildren().forEach((t=>e.append(t))),this.replace(e),!0}setLanguage(e){this.getWritable().__language=Bm(e)}getLanguage(){return this.getLatest().__language}};function Km(e){return sn(new Um(e))}function Wm(e){return e instanceof Um}function jm(e){let t;return hn(e)&&(t=e.getAttribute($m)),{node:Km(t)}}function Hm(e){const t=e,n=Zm(t);return n||function(e){let t=e.parentElement;for(;null!==t;){if(Zm(t))return!0;t=t.parentElement}return!1}(t)?{after:t=>{const n=e.parentNode;return null!=n&&e!==n.lastChild&&t.push(xr()),t},node:n?Km():null}:{node:null}}function Jm(){return{node:Km()}}function Vm(){return{node:null}}function Ym(e){const t=e;return{after:e=>(t.parentNode&&t.parentNode.nextSibling&&e.push(xr()),e),node:null}}function Zm(e){return null!==e.style.fontFamily.match("monospace")}function Xm(e){return e.classList.contains("js-file-line-container")}const qm={c:"C",clike:"C-like",cpp:"C++",css:"CSS",html:"HTML",java:"Java",js:"JavaScript",markdown:"Markdown",objc:"Objective-C",plain:"Plain Text",py:"Python",rust:"Rust",sql:"SQL",swift:"Swift",typescript:"TypeScript",xml:"XML"},Gm={cpp:"cpp",java:"java",javascript:"js",md:"markdown",plaintext:"plain",python:"py",text:"plain",ts:"typescript"};function Qm(e){return Gm[e]||e}function e_(e){const t=Qm(e);return qm[t]||t}let t_=class e extends Ar{constructor(e,t,n){super(e,n),this.__highlightType=t}static getType(){return"code-highlight"}static clone(t){return new e(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}canHaveFormat(){return!1}createDOM(e){const t=super.createDOM(e);return zo(t,n_(e.theme,this.__highlightType)),t}updateDOM(e,t,n){const r=super.updateDOM(e,t,n),s=n_(n.theme,e.__highlightType),o=n_(n.theme,this.__highlightType);return s!==o&&(s&&$o(t,s),o&&zo(t,o)),r}static importJSON(e){const t=r_(e.text,e.highlightType);return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType(),type:"code-highlight",version:1}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return Km()}};function n_(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function r_(e,t){return sn(new t_(e,t))}function s_(e){return e instanceof t_}function o_(e){let t=e,n=e;for(;s_(n)||jr(n);)t=n,n=n.getPreviousSibling();return t}function i_(e){let t=e,n=e;for(;s_(n)||jr(n);)t=n,n=n.getNextSibling();return t}const l_={defaultLanguage:"javascript",tokenize(e,t){return window.Prism.tokenize(e,window.Prism.languages[t||""]||window.Prism.languages[this.defaultLanguage])}};function a_(e,t,n){const r=e.getParent();Wm(r)?d_(r,t,n):s_(e)&&e.replace($r(e.__text))}function c_(e,t){const n=t.getElementByKey(e.getKey());if(null===n)return;const r=e.getChildren(),s=r.length;if(s===n.__cachedChildrenLength)return;n.__cachedChildrenLength=s;let o="1",i=1;for(let l=0;l<s;l++)vr(r[l])&&(o+="\n"+ ++i);n.setAttribute("data-gutter",o)}const u_=new Set;function d_(e,t,n){const r=e.getKey();u_.has(r)||(u_.add(r),void 0===e.getLanguage()&&e.setLanguage(n.defaultLanguage),t.update((()=>{!function(e,t){const n=vt(e);if(!Wm(n)||!n.isAttached())return;const r=hs();if(!Gr(r))return void t();const s=r.anchor,o=s.offset,i="element"===s.type&&vr(n.getChildAtIndex(s.offset-1));let l=0;if(!i){const e=s.getNode();l=o+e.getPreviousSiblings().reduce(((e,t)=>e+t.getTextContentSize()),0)}t()&&(i?s.getNode().select(o,o):n.getChildren().some((e=>{const t=Ur(e);if(t||vr(e)){const n=e.getTextContentSize();if(t&&n>=l)return e.select(l,l),!0;l-=n}return!1})))}(r,(()=>{const t=vt(r);if(!Wm(t)||!t.isAttached())return!1;const s=t.getTextContent(),o=h_(n.tokenize(s,t.getLanguage()||n.defaultLanguage)),i=function(e,t){let n=0;for(;n<e.length&&f_(e[n],t[n]);)n++;const r=e.length,s=t.length,o=Math.min(r,s)-n;let i=0;for(;i<o;)if(i++,!f_(e[r-i],t[s-i])){i--;break}const l=r-i;return{from:n,nodesForReplacement:t.slice(n,s-i),to:l}}(t.getChildren(),o),{from:l,to:a,nodesForReplacement:c}=i;return!(l===a&&!c.length||(e.splice(l,a-l,c),0))}))}),{onUpdate:()=>{u_.delete(r)},skipTransforms:!0}))}function h_(e,t){const n=[];for(const r of e)if("string"==typeof r){const e=r.split(/(\n|\t)/),s=e.length;for(let r=0;r<s;r++){const s=e[r];"\n"===s||"\r\n"===s?n.push(xr()):"\t"===s?n.push(Wr()):s.length>0&&n.push(r_(s,t))}}else{const{content:e}=r;"string"==typeof e?n.push(...h_([e],r.type)):Array.isArray(e)&&n.push(...h_(e,r.type))}return n}function f_(e,t){return s_(e)&&s_(t)&&e.__text===t.__text&&e.__highlightType===t.__highlightType||jr(e)&&jr(t)||vr(e)&&vr(t)}function g_(e){if(!Gr(e))return!1;const t=e.anchor.getNode(),n=e.focus.getNode();if(t.is(n)&&Wm(t))return!0;const r=t.getParent();return Wm(r)&&r.is(n.getParent())}function p_(e){const t=e.getNodes(),n=[[]];if(1===t.length&&Wm(t[0]))return n;let r=n[0];for(let s=0;s<t.length;s++){const e=t[s];if(!(s_(e)||jr(e)||vr(e)))throw Error("Expected selection to be inside CodeBlock and consisting of CodeHighlightNode, TabNode and LineBreakNode");vr(e)?0!==s&&r.length>0&&(r=[],n.push(r)):r.push(e)}return n}function m_(e){const t=hs();if(!Gr(t)||!g_(t))return!1;const n=p_(t),r=n.length;if(n.length>1){for(let t=0;t<r;t++){const r=n[t];if(r.length>0){let n=r[0];0===t&&(n=o_(n)),null!==n&&(e===$?n.insertBefore(Wr()):jr(n)&&n.remove())}}return!0}const s=t.getNodes()[0];if(!(Wm(s)||s_(s)||jr(s)||vr(s)))throw Error("Expected selection firstNode to be CodeHighlightNode or CodeTabNode");if(Wm(s))return e===$&&t.insertNodes([Wr()]),!0;const o=o_(s);if(null===o)throw Error("Expected getFirstCodeNodeOfLine to return a valid Code Node");return e===$?vr(o)?o.insertAfter(Wr()):o.insertBefore(Wr()):jr(o)&&o.remove(),!0}function __(e,t){const n=hs();if(!Gr(n))return!1;const{anchor:r,focus:s}=n,o=r.offset,i=s.offset,l=r.getNode(),a=s.getNode(),c=e===O;if(!g_(n)||!s_(l)&&!jr(l)||!s_(a)&&!jr(a))return!1;if(!t.altKey){if(n.isCollapsed()){const e=l.getParentOrThrow();if(c&&0===o&&null===l.getPreviousSibling()){if(null===e.getPreviousSibling())return e.selectPrevious(),t.preventDefault(),!0}else if(!c&&o===l.getTextContentSize()&&null===l.getNextSibling()&&null===e.getNextSibling())return e.selectNext(),t.preventDefault(),!0}return!1}let u,d;if(l.isBefore(a)?(u=o_(l),d=i_(a)):(u=o_(a),d=i_(l)),null==u||null==d)return!1;const h=u.getNodesBetween(d);for(let _=0;_<h.length;_++){const e=h[_];if(!s_(e)&&!jr(e)&&!vr(e))return!1}t.preventDefault(),t.stopPropagation();const f=c?u.getPreviousSibling():d.getNextSibling();if(!vr(f))return!0;const g=c?f.getPreviousSibling():f.getNextSibling();if(null==g)return!0;const p=s_(g)||jr(g)||vr(g)?c?o_(g):i_(g):null;let m=null!=p?p:g;return f.remove(),h.forEach((e=>e.remove())),e===O?(h.forEach((e=>m.insertBefore(e))),m.insertBefore(f)):(m.insertAfter(f),m=f,h.forEach((e=>{m.insertAfter(e),m=e}))),n.setTextNodeRange(l,o,a,i),!0}function y_(e,t){const n=hs();if(!Gr(n))return!1;const{anchor:r,focus:s}=n,o=r.getNode(),i=s.getNode(),l=e===A;if(!s_(o)&&!jr(o)||!s_(i)&&!jr(i))return!1;if(l){const e=function(e,t){let n=null,r=null,s=e,o=t,i=e.getTextContent();for(;;){if(0===o){if(s=s.getPreviousSibling(),null===s)break;if(!(s_(s)||jr(s)||vr(s)))throw Error("Expected a valid Code Node: CodeHighlightNode, TabNode, LineBreakNode");if(vr(s)){n={node:s,offset:1};break}o=Math.max(0,s.getTextContentSize()-1),i=s.getTextContent()}else o--;const e=i[o];s_(s)&&" "!==e&&(r={node:s,offset:o})}if(null!==r)return r;let l=null;if(t<e.getTextContentSize())s_(e)&&(l=e.getTextContent()[t]);else{const t=e.getNextSibling();s_(t)&&(l=t.getTextContent()[0])}if(null!==l&&" "!==l)return n;{const r=function(e,t){let n=e,r=t,s=e.getTextContent(),o=e.getTextContentSize();for(;;){if(!s_(n)||r===o){if(n=n.getNextSibling(),null===n||vr(n))return null;s_(n)&&(r=0,s=n.getTextContent(),o=n.getTextContentSize())}if(s_(n)){if(" "!==s[r])return{node:n,offset:r};r++}}}(e,t);return null!==r?r:n}}(i,s.offset);if(null!==e){const{node:t,offset:r}=e;vr(t)?t.selectNext(0,0):n.setTextNodeRange(t,r,t,r)}else i.getParentOrThrow().selectStart()}else(function(e){const t=i_(e);if(vr(t))throw Error("Unexpected lineBreakNode in getEndOfCodeInLine");return t})(i).select();return t.preventDefault(),t.stopPropagation(),!0}function b_(e,t){if(!e.hasNodes([Um,t_]))throw new Error("CodeHighlightPlugin: CodeNode or CodeHighlightNode not registered on editor");return null==t&&(t=l_),Bo(e.registerMutationListener(Um,(t=>{e.update((()=>{for(const[n,r]of t)if("destroyed"!==r){const t=vt(n);null!==t&&c_(t,e)}}))})),e.registerNodeTransform(Um,(n=>d_(n,e,t))),e.registerNodeTransform(Ar,(n=>a_(n,e,t))),e.registerNodeTransform(t_,(n=>a_(n,e,t))),e.registerCommand(B,(t=>{const n=function(e){const t=hs();if(!Gr(t)||!g_(t))return null;const n=e?U:$,r=e?U:z;if(p_(t).length>1)return n;const s=t.getNodes()[0];if(!(Wm(s)||s_(s)||jr(s)||vr(s)))throw Error("Expected selection firstNode to be CodeHighlightNode or TabNode");if(Wm(s))return n;const o=o_(s),i=i_(s),l=t.anchor,a=t.focus;let c,u;return a.isBefore(l)?(c=a,u=l):(c=l,u=a),null!==o&&null!==i&&c.key===o.getKey()&&0===c.offset&&u.key===i.getKey()&&u.offset===i.getTextContentSize()?n:r}(t.shiftKey);return null!==n&&(t.preventDefault(),e.dispatchCommand(n,void 0),!0)}),so),e.registerCommand(z,(()=>!!g_(hs())&&(ys([Wr()]),!0)),so),e.registerCommand($,(e=>m_($)),so),e.registerCommand(U,(e=>m_(U)),so),e.registerCommand(O,(e=>__(O,e)),so),e.registerCommand(F,(e=>__(F,e)),so),e.registerCommand(N,(e=>y_(N,e)),so),e.registerCommand(A,(e=>y_(A,e)),so))}function w_(e){!function(t){const n=document.createElement("input");n.type="file",n.accept=".lexical",n.addEventListener("change",(t=>{const n=t.target;if(n.files){const t=n.files[0],r=new FileReader;r.readAsText(t,"UTF-8"),r.onload=t=>{if(t.target){(t=>{const n=JSON.parse(t),r=e.parseEditorState(JSON.stringify(n.editorState));e.setEditorState(r),e.dispatchCommand(q,void 0)})(t.target.result)}}}})),n.click()}()}function x_(e,t=Object.freeze({})){const n=new Date;!function(e,t){const n=document.createElement("a"),r=document.body;if(null===r)return;r.appendChild(n),n.style.display="none";const s=JSON.stringify(e),o=new Blob([s],{type:"octet/stream"}),i=window.URL.createObjectURL(o);n.href=i,n.download=t,n.click(),window.URL.revokeObjectURL(i),n.remove()}({editorState:e.getEditorState(),lastSaved:n.getTime(),source:t.source||"Lexical",version:"0.14.5"},`${t.fileName||n.toISOString()}.lexical`)}function v_(e,t){const n={};for(const r of e){const e=t(r);n[e]?n[e].push(r):n[e]=[r]}return n}function S_(e){const t=v_(e,(e=>e.type));return{element:t.element||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const C_=/[!-/:-@[-`{-~\s]/;function k_(e,t,n,r){for(const s of t){const t=s.export(e,(e=>E_(e,n,r)));if(null!=t)return t}return Js(e)?E_(e,n,r):js(e)?e.getTextContent():null}function E_(e,t,n){const r=[],s=e.getChildren();e:for(const o of s){for(const e of n){const s=e.export(o,(e=>E_(e,t,n)),((e,n)=>T_(e,n,t)));if(null!=s){r.push(s);continue e}}vr(o)?r.push("\n"):Ur(o)?r.push(T_(o,o.getTextContent(),t)):Js(o)?r.push(E_(o,t,n)):js(o)&&r.push(o.getTextContent())}return r.join("")}function T_(e,t,n){const r=t.trim();let s=r;const o=new Set;for(const i of n){const t=i.format[0],n=i.tag;R_(e,t)&&!o.has(t)&&(o.add(t),R_(N_(e,!0),t)||(s=n+s),R_(N_(e,!1),t)||(s+=n))}return t.replace(r,(()=>s))}function N_(e,t){let n=t?e.getPreviousSibling():e.getNextSibling();if(!n){const r=e.getParentOrThrow();r.isInline()&&(n=t?r.getPreviousSibling():r.getNextSibling())}for(;n;){if(Js(n)){if(!n.isInline())break;const e=t?n.getLastDescendant():n.getFirstDescendant();if(Ur(e))return e;n=t?n.getPreviousSibling():n.getNextSibling()}if(Ur(n))return n;if(!Js(n))return null}return null}function R_(e,t){return Ur(e)&&e.hasFormat(t)}const A_="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,O_=A_&&"documentMode"in document?document.documentMode:null;A_&&"InputEvent"in window&&!O_&&new window.InputEvent("input");const F_=A_&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),D_=A_&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,P_=A_&&/^(?=.*Chrome).*/i.test(navigator.userAgent),L_=A_&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!P_,I_=/^\s{0,3}$/,M_=/^```(\w{1,10})?\s?$/;function B_(e){if(!no(e))return!1;const t=e.getFirstChild();return null==t||1===e.getChildrenSize()&&Ur(t)&&I_.test(t.getTextContent())}function z_(e,t,n,r,s){const o=e.trim(),i=$r(o),l=to();l.append(i),t.append(l);for(const{regExp:a,replace:c}of n){const t=e.match(a);if(t){i.setTextContent(e.slice(t[0].length)),c(l,[i],t,!0);break}}if(U_(i,r,s),l.isAttached()&&o.length>0){const e=l.getPreviousSibling();if(no(e)||xl(e)||Li(e)){let t=e;if(Li(e)){const n=e.getLastDescendant();t=null==n?null:Ho(n,Ni)}null!=t&&t.getTextContentSize()>0&&(t.splice(t.getChildrenSize(),0,[xr(),...l.getChildren()]),l.remove())}}}function $_(e,t,n){const r=e[t].match(M_);if(r){let s=t;const o=e.length;for(;++s<o;)if(e[s].match(M_)){const o=Km(r[1]),i=$r(e.slice(t+1,s).join("\n"));return o.append(i),n.append(o),[o,s]}}return[null,t]}function U_(e,t,n){const r=e.getTextContent(),s=function(e,t){const n=e.match(t.openTagsRegExp);if(null==n)return null;for(const r of n){const n=r.replace(/^\s/,""),s=t.fullMatchRegExpByTag[n];if(null==s)continue;const o=e.match(s),i=t.transformersByTag[n];if(null!=o&&null!=i){if(!1!==i.intraword)return o;const{index:t=0}=o,n=e[t-1],r=e[t+o[0].length];if((!n||C_.test(n))&&(!r||C_.test(r)))return o}}return null}(r,t);if(!s)return void K_(e,n);let o,i,l;if(s[0]===r)o=e;else{const t=s.index||0,n=t+s[0].length;0===t?[o,i]=e.splitText(n):[l,o,i]=e.splitText(t,n)}o.setTextContent(s[2]);const a=t.transformersByTag[s[1]];if(a)for(const c of a.format)o.hasFormat(c)||o.toggleFormat(c);o.hasFormat("code")||U_(o,t,n),l&&U_(l,t,n),i&&U_(i,t,n)}function K_(e,t){let n=e;e:for(;n;){for(const e of t){const r=n.getTextContent().match(e.importRegExp);if(!r)continue;const s=r.index||0,o=s+r[0].length;let i,l;0===s?[i,n]=n.splitText(o):[,i,l]=n.splitText(s,o),l&&K_(l,t),e.replace(i,r);continue e}break}}function W_(e,t,n){const r=n.length;for(let s=t;s>=r;s--){const t=s-r;if(j_(e,t,n,0,r)&&" "!==e[t+r])return t}return-1}function j_(e,t,n,r,s){for(let o=0;o<s;o++)if(e[t+o]!==n[r+o])return!1;return!0}function H_(e,t=ry){const n=S_(t),r=v_(n.textFormat,(({tag:e})=>e[e.length-1])),s=v_(n.textMatch,(({trigger:e})=>e));for(const o of t){const t=o.type;if("element"===t||"text-match"===t){const t=o.dependencies;for(const n of t)if(!e.hasNode(n))throw Error(`MarkdownShortcuts: missing dependency ${n.getType()} for transformer. Ensure node dependency is included in editor initial config.`)}}return e.registerUpdateListener((({tags:t,dirtyLeaves:o,editorState:i,prevEditorState:l})=>{if(t.has("collaboration")||t.has("historic"))return;if(e.isComposing())return;const a=i.read(hs),c=l.read(hs);if(!Gr(c)||!Gr(a)||!a.isCollapsed())return;const u=a.anchor.key,d=a.anchor.offset,h=i._nodeMap.get(u);!Ur(h)||!o.has(u)||1!==d&&d>c.anchor.offset+1||e.update((()=>{if(h.hasFormat("code"))return;const e=h.getParent();null===e||Wm(e)||((e,t,o)=>{(function(e,t,n,r){if(!rn(e.getParent())||e.getFirstChild()!==t)return!1;const s=t.getTextContent();if(" "!==s[n-1])return!1;for(const{regExp:o,replace:i}of r){const r=s.match(o);if(r&&r[0].length===n){const s=t.getNextSiblings(),[o,l]=t.splitText(n);return o.remove(),i(e,l?[l,...s]:s,r,!1),!0}}return!1})(e,t,o,n.element)||function(e,t,n){let r=e.getTextContent();const s=n[r[t-1]];if(null==s)return!1;t<r.length&&(r=r.slice(0,t));for(const o of s){const t=r.match(o.regExp);if(null===t)continue;const n=t.index||0,s=n+t[0].length;let i;return 0===n?[i]=e.splitText(s):[,i]=e.splitText(n,s),i.selectNext(0,0),o.replace(i,t),!0}return!1}(t,o,s)||function(e,t,n){const r=e.getTextContent(),s=t-1,o=r[s],i=n[o];if(!i)return!1;for(const l of i){const{tag:t}=l,n=t.length,i=s-n+1;if(n>1&&!j_(r,i,t,0,n))continue;if(" "===r[i-1])continue;const a=r[s+1];if(!1===l.intraword&&a&&!C_.test(a))continue;const c=e;let u=c,d=W_(r,i,t),h=u;for(;d<0&&(h=h.getPreviousSibling())&&!vr(h);)if(Ur(h)){const e=h.getTextContent();u=h,d=W_(e,e.length,t)}if(d<0)continue;if(u===c&&d+n===i)continue;const f=u.getTextContent();if(d>0&&f[d-1]===o)continue;const g=f[d-1];if(!1===l.intraword&&g&&!C_.test(g))continue;const p=c.getTextContent(),m=p.slice(0,i)+p.slice(s+1);c.setTextContent(m);const _=u===c?m:f;u.setTextContent(_.slice(0,d)+_.slice(d+n));const y=hs(),b=cs();Rt(b);const w=s-n*(u===c?2:1)+1;b.anchor.set(u.__key,d,"text"),b.focus.set(c.__key,w,"text");for(const e of l.format)b.hasFormat(e)||b.formatText(e);b.anchor.set(b.focus.key,b.focus.offset,b.focus.type);for(const e of l.format)b.hasFormat(e)&&b.toggleFormat(e);return Gr(y)&&(b.format=y.format),!0}}(t,o,r)})(e,h,a.anchor.offset)}))}))}const J_=e=>(t,n,r)=>{const s=e(r);s.append(...n),t.replace(s),s.select(0,0)},V_=e=>(t,n,r)=>{const s=t.getPreviousSibling(),o=t.getNextSibling(),i=Ti("check"===e?"x"===r[3]:void 0);if(Li(o)&&o.getListType()===e){const e=o.getFirstChild();null!==e?e.insertBefore(i):o.append(i),t.remove()}else if(Li(s)&&s.getListType()===e)s.append(i),t.remove();else{const n=Pi(e,"number"===e?Number(r[2]):void 0);n.append(i),t.replace(n)}i.append(...n),i.select(0,0);const l=function(e){const t=e.match(/\t/g),n=e.match(/ /g);let r=0;return t&&(r+=t.length),n&&(r+=Math.floor(n.length/4)),r}(r[1]);l&&i.setIndent(l)},Y_=(e,t,n)=>{const r=[],s=e.getChildren();let o=0;for(const i of s)if(Ni(i)){if(1===i.getChildrenSize()){const e=i.getFirstChild();if(Li(e)){r.push(Y_(e,t,n+1));continue}}const s=" ".repeat(4*n),l=e.getListType(),a="number"===l?`${e.getStart()+o}. `:"check"===l?`- [${i.getChecked()?"x":" "}] `:"- ";r.push(s+a+t(i)),o++}return r.join("\n")},Z_={dependencies:[vl],export:(e,t)=>{if(!Tl(e))return null;const n=Number(e.getTag().slice(1));return"#".repeat(n)+" "+t(e)},regExp:/^(#{1,6})\s/,replace:J_((e=>El("h"+e[1].length))),type:"element"},X_={dependencies:[bl],export:(e,t)=>{if(!xl(e))return null;const n=t(e).split("\n"),r=[];for(const s of n)r.push("> "+s);return r.join("\n")},regExp:/^>\s/,replace:(e,t,n,r)=>{if(r){const n=e.getPreviousSibling();if(xl(n))return n.splice(n.getChildrenSize(),0,[xr(),...t]),n.select(0,0),void e.remove()}const s=wl();s.append(...t),e.replace(s),s.select(0,0)},type:"element"},q_={dependencies:[Um],export:e=>{if(!Wm(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?"\n"+t:"")+"\n```"},regExp:/^```(\w{1,10})?\s/,replace:J_((e=>Km(e?e[1]:void 0))),type:"element"},G_={dependencies:[Ri,Si],export:(e,t)=>Li(e)?Y_(e,t,0):null,regExp:/^(\s*)[-*+]\s/,replace:V_("bullet"),type:"element"},Q_={dependencies:[Ri,Si],export:(e,t)=>Li(e)?Y_(e,t,0):null,regExp:/^(\s*)(?:-\s)?\s?(\[(\s|x)?\])\s/i,replace:V_("check"),type:"element"},ey=[Z_,X_,q_,G_,{dependencies:[Ri,Si],export:(e,t)=>Li(e)?Y_(e,t,0):null,regExp:/^(\s*)(\d{1,})\.\s/,replace:V_("number"),type:"element"}],ty=[{format:["code"],tag:"`",type:"text-format"},{format:["bold","italic"],tag:"***",type:"text-format"},{format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},{format:["bold"],tag:"**",type:"text-format"},{format:["bold"],intraword:!1,tag:"__",type:"text-format"},{format:["highlight"],tag:"==",type:"text-format"},{format:["italic"],tag:"*",type:"text-format"},{format:["italic"],intraword:!1,tag:"_",type:"text-format"},{format:["strikethrough"],tag:"~~",type:"text-format"}],ny=[{dependencies:[ei],export:(e,t,n)=>{if(!ri(e))return null;const r=e.getTitle(),s=r?`[${e.getTextContent()}](${e.getURL()} "${r}")`:`[${e.getTextContent()}](${e.getURL()})`,o=e.getFirstChild();return 1===e.getChildrenSize()&&Ur(o)?n(o,s):s},importRegExp:/(?:\[([^[]+)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[([^[]+)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,n,r,s]=t,o=ni(r,{title:s}),i=$r(n);i.setFormat(e.getFormat()),o.append(i),e.replace(o)},trigger:")",type:"text-match"}],ry=[...ey,...ty,...ny];function sy(e,t=ry,n){return function(e){const t=S_(e),n=function(e){const t={},n={},r=[];for(const s of e){const{tag:e}=s;t[e]=s;const o=e.replace(/(\*|\^|\+)/g,"\\$1");r.push(o),n[e]=F_||D_||L_?new RegExp(`(${o})(?![${o}\\s])(.*?[^${o}\\s])${o}(?!${o})`):new RegExp(`(?<![\\\\${o}])(${o})((\\\\${o})?.*?[^${o}\\s](\\\\${o})?)((?<!\\\\)|(?<=\\\\\\\\))(${o})(?![\\\\${o}])`)}return{fullMatchRegExpByTag:n,openTagsRegExp:new RegExp((F_||D_||L_?"":"(?<![\\\\])")+"("+r.join("|")+")","g"),transformersByTag:t}}(t.textFormat);return(e,r)=>{const s=e.split("\n"),o=s.length,i=r||Tt();i.clear();for(let a=0;a<o;a++){const e=s[a],[r,o]=$_(s,a,i);null==r?z_(e,i,t.element,n,t.textMatch):a=o}const l=i.getChildren();for(const t of l)B_(t)&&i.getChildrenSize()>1&&t.remove();null!==hs()&&i.selectEnd()}}(t)(e,n)}function oy(e=ry,t){return function(e){const t=S_(e),n=t.textFormat.filter((e=>1===e.format.length));return e=>{const r=[],s=(e||Tt()).getChildren();for(const o of s){const e=k_(o,t.element,n,t.textMatch);null!=e&&r.push(e)}return r.join("\n\n")}}(e)(t)}class iy extends Ws{constructor(e,t){super(t),this.__format=e||""}exportJSON(){return{format:this.__format||"",type:"decorator-block",version:1}}createDOM(){return document.createElement("div")}updateDOM(){return!1}setFormat(e){this.getWritable().__format=e}isInline(){return!1}}function ly(e){return e instanceof iy}function ay({children:e,format:t,nodeKey:n,className:r}){const[s]=Wi(),[o,i,l]=Dg(n),a=React.useRef(null),c=React.useCallback((e=>{if(o&&es(hs())){e.preventDefault();const t=vt(n);if(js(t))return t.remove(),!0}return!1}),[o,n]);return React.useEffect((()=>Bo(s.registerCommand(W,(e=>{if(o){const t=hs();if(es(t)){const t=vt(n);ly(t)&&t.setFormat(e)}else if(Gr(t)){const n=t.getNodes();for(const t of n)ly(t)?t.setFormat(e):jo(t).setFormat(e)}return!0}return!1}),so),s.registerCommand(g,(e=>e.target===a.current&&(e.preventDefault(),e.shiftKey||l(),i(!o),!0)),so),s.registerCommand(M,c,so),s.registerCommand(L,c,so))),[l,s,o,n,c,i]),React.createElement("div",{className:[r.base,o?r.focus:null].filter(Boolean).join(" "),ref:a,style:{textAlign:t||void 0}},e)}var cy="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;let uy=class{constructor(e){this.key=e,this.ref={current:null},this.setRefElement=this.setRefElement.bind(this)}setRefElement(e){this.ref={current:e}}};const dy=e=>{const t=document.getElementById("typeahead-menu");if(!t)return;const n=t.getBoundingClientRect();n.top+n.height>window.innerHeight&&t.scrollIntoView({block:"center"}),n.top<0&&t.scrollIntoView({block:"center"}),e.scrollIntoView({block:"nearest"})};function hy(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return n.top>r.top&&n.top<r.bottom}const fy={};function gy({close:e,editor:t,anchorElementRef:n,resolution:r,options:s,menuRenderFn:o,onSelectOption:i,shouldSplitNodeWithQuery:l=!1,commandPriority:a=so}){const[c,u]=React.useState(null),d=r.match&&r.match.matchingString;React.useEffect((()=>{u(0)}),[d]);const h=React.useCallback((n=>{t.update((()=>{const t=null!=r.match&&l?function(e){const t=hs();if(!Gr(t)||!t.isCollapsed())return null;const n=t.anchor;if("text"!==n.type)return null;const r=n.getNode();if(!r.isSimpleText())return null;const s=n.offset,o=r.getTextContent().slice(0,s),i=e.replaceableString.length,l=s-function(e,t,n){let r=n;for(let s=r;s<=t.length;s++)e.substr(-s)===t.substr(0,s)&&(r=s);return r}(o,e.matchingString,i);if(l<0)return null;let a;return 0===l?[a]=r.splitText(s):[,a]=r.splitText(l,s),a}(r.match):null;i(n,t,e,r.match?r.match.matchingString:"")}))}),[t,l,r.match,i,e]),f=React.useCallback((e=>{const n=t.getRootElement();null!==n&&(n.setAttribute("aria-activedescendant","typeahead-item-"+e),u(e))}),[t]);return React.useEffect((()=>()=>{const e=t.getRootElement();null!==e&&e.removeAttribute("aria-activedescendant")}),[t]),cy((()=>{null===s?u(null):null===c&&f(0)}),[s,c,f]),React.useEffect((()=>Bo(t.registerCommand(fy,(({option:e})=>!(!e.ref||null==e.ref.current||(dy(e.ref.current),0))),a))),[t,f,a]),React.useEffect((()=>Bo(t.registerCommand(F,(e=>{const n=e;if(null!==s&&s.length&&null!==c){const e=c!==s.length-1?c+1:0;f(e);const r=s[e];null!=r.ref&&r.ref.current&&t.dispatchCommand(fy,{index:e,option:r}),n.preventDefault(),n.stopImmediatePropagation()}return!0}),a),t.registerCommand(O,(e=>{const t=e;if(null!==s&&s.length&&null!==c){const e=0!==c?c-1:s.length-1;f(e);const n=s[e];null!=n.ref&&n.ref.current&&dy(n.ref.current),t.preventDefault(),t.stopImmediatePropagation()}return!0}),a),t.registerCommand(I,(t=>{const n=t;return n.preventDefault(),n.stopImmediatePropagation(),e(),!0}),a),t.registerCommand(B,(e=>{const t=e;return null!==s&&null!==c&&null!=s[c]&&(t.preventDefault(),t.stopImmediatePropagation(),h(s[c]),!0)}),a),t.registerCommand(D,(e=>null!==s&&null!==c&&null!=s[c]&&(null!==e&&(e.preventDefault(),e.stopImmediatePropagation()),h(s[c]),!0)),a))),[h,e,t,s,c,f,a]),o(n,React.useMemo((()=>({options:s,selectOptionAndCleanUp:h,selectedIndex:c,setHighlightedIndex:u})),[h,c,s]),r.match?r.match.matchingString:"")}function py({options:e,nodeKey:t,onClose:n,onOpen:r,onSelectOption:s,menuRenderFn:o,anchorClassName:i,commandPriority:l=so,parent:a}){const[c]=Wi(),[u,d]=React.useState(null),h=function(e,t,n,r=document.body){const[s]=Wi(),o=React.useRef(document.createElement("div")),i=React.useCallback((()=>{o.current.style.top=o.current.style.bottom;const t=s.getRootElement(),i=o.current,l=i.firstChild;if(null!==t&&null!==e){const{left:s,top:a,width:c,height:u}=e.getRect(),d=o.current.offsetHeight;if(i.style.top=`${a+window.pageYOffset+d+3}px`,i.style.left=`${s+window.pageXOffset}px`,i.style.height=`${u}px`,i.style.width=`${c}px`,null!==l){l.style.top=`${a}`;const e=l.getBoundingClientRect(),n=e.height,r=e.width,o=t.getBoundingClientRect();s+r>o.right&&(i.style.left=`${o.right-r+window.pageXOffset}px`),(a+n>window.innerHeight||a+n>o.bottom)&&a-o.top>n&&(i.style.top=a-n+window.pageYOffset-u+"px")}i.isConnected||(null!=n&&(i.className=n),i.setAttribute("aria-label","Typeahead menu"),i.setAttribute("id","typeahead-menu"),i.setAttribute("role","listbox"),i.style.display="block",i.style.position="absolute",r.append(i)),o.current=i,t.setAttribute("aria-controls","typeahead-menu")}}),[s,e,n,r]);React.useEffect((()=>{const t=s.getRootElement();if(null!==e)return i(),()=>{null!==t&&t.removeAttribute("aria-controls");const e=o.current;null!==e&&e.isConnected&&e.remove()}}),[s,i,e]);const l=React.useCallback((n=>{null!==e&&(n||t(null))}),[e,t]);return function(e,t,n,r){const[s]=Wi();React.useEffect((()=>{if(null!=t&&null!=e){const e=s.getRootElement(),o=null!=e?function(e,t){let n=getComputedStyle(e);const r="absolute"===n.position,s=/(auto|scroll)/;if("fixed"===n.position)return document.body;for(let o=e;o=o.parentElement;)if(n=getComputedStyle(o),(!r||"static"!==n.position)&&s.test(n.overflow+n.overflowY+n.overflowX))return o;return document.body}(e):document.body;let i=!1,l=hy(t,o);const a=function(){i||(window.requestAnimationFrame((function(){n(),i=!1})),i=!0);const e=hy(t,o);e!==l&&(l=e,null!=r&&r(e))},c=new ResizeObserver(n);return window.addEventListener("resize",n),document.addEventListener("scroll",a,{capture:!0,passive:!0}),c.observe(t),()=>{c.unobserve(t),window.removeEventListener("resize",n),document.removeEventListener("scroll",a,!0)}}}),[t,s,r,n,e])}(e,o.current,i,l),o}(u,d,i,a),f=React.useCallback((()=>{d(null),null!=n&&null!==u&&n()}),[n,u]),g=React.useCallback((e=>{d(e),null!=r&&null===u&&r(e)}),[r,u]),p=React.useCallback((()=>{t?c.update((()=>{const e=vt(t),n=c.getElementByKey(t);var r;null!=e&&null!=n&&null==u&&(r=()=>g({getRect:()=>n.getBoundingClientRect()}),React.startTransition?React.startTransition(r):r())})):null==t&&null!=u&&f()}),[f,c,t,g,u]);return React.useEffect((()=>{p()}),[p,t]),React.useEffect((()=>{if(null!=t)return c.registerUpdateListener((({dirtyElements:e})=>{e.get(t)&&p()}))}),[c,p,t]),null===u||null===c?null:React.createElement(gy,{close:f,resolution:u,editor:c,anchorElementRef:h,options:e,menuRenderFn:o,onSelectOption:s,commandPriority:l})}const my=/((https?:\/\/(www\.)?)|(www\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/,_y={};let yy=class extends uy{constructor(e,t){super(e),this.title=e,this.onSelect=t.onSelect.bind(this)}};function by({embedConfigs:e,onOpenEmbedModalForConfig:t,getMenuOptions:n,menuRenderFn:r,menuCommandPriority:s=so}){const[o]=Wi(),[i,l]=React.useState(null),[a,c]=React.useState(null),u=React.useCallback((()=>{l(null),c(null)}),[]),d=React.useCallback((t=>{o.getEditorState().read((async function(){const n=vt(t);if(ri(n))for(let t=0;t<e.length;t++){const r=e[t];null!=await Promise.resolve(r.parseUrl(n.__url))&&(c(r),l(n.getKey()))}}))}),[o,e]);React.useEffect((()=>Bo(...[ei,si].map((e=>o.registerMutationListener(e,((...e)=>((e,{updateTags:t,dirtyLeaves:n})=>{for(const[r,s]of e)"created"===s&&t.has("paste")&&n.size<=3?d(r):r===i&&u()})(...e))))))),[d,o,e,i,u]),React.useEffect((()=>o.registerCommand(_y,(n=>{const r=e.find((({type:e})=>e===n));return!!r&&(t(r),!0)}),ro)),[o,e,t]);const h=React.useCallback((async function(){if(null!=a&&null!=i){const e=o.getEditorState().read((()=>{const e=vt(i);return ri(e)?e:null}));if(ri(e)){const t=await Promise.resolve(a.parseUrl(e.__url));null!=t&&o.update((()=>{hs()||e.selectEnd(),a.insertNode(o,t),e.isAttached()&&e.remove()}))}}}),[a,o,i]),f=React.useMemo((()=>null!=a&&null!=i?n(a,h,u):[]),[a,h,n,i,u]),g=React.useCallback(((e,t,n)=>{o.update((()=>{e.onSelect(t),n()}))}),[o]);return null!=i?React.createElement(py,{nodeKey:i,onClose:u,onSelectOption:g,options:f,menuRenderFn:r,commandPriority:s}):null}var wy=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)};function xy(e,t=(e=>e)){return n=>{const r=e.exec(n);return null===r?null:{index:r.index,length:r[0].length,text:r[0],url:t(r[0])}}}function vy(e,t){for(let n=0;n<t.length;n++){const r=t[n](e);if(r)return r}return null}const Sy=/[.,;\s]/;function Cy(e){return Sy.test(e)}function ky(e){return Cy(e[e.length-1])}function Ey(e){return Cy(e[0])}function Ty(e){let t=e.getPreviousSibling();return Js(t)&&(t=t.getLastDescendant()),null===t||vr(t)||Ur(t)&&ky(t.getTextContent())}function Ny(e){let t=e.getNextSibling();return Js(t)&&(t=t.getFirstDescendant()),null===t||vr(t)||Ur(t)&&Ey(t.getTextContent())}function Ry(e,t,n,r){return!!(e>0?Cy(n[e-1]):Ty(r[0]))&&(t<n.length?Cy(n[t]):Ny(r[r.length-1]))}function Ay(e,t,n){const r=[],s=[],o=[];let i=0,l=0;const a=[...e];for(;a.length>0;){const e=a[0],c=e.getTextContent().length,u=l;l+c<=t?(r.push(e),i+=c):u>=n?o.push(e):s.push(e),l+=c,a.shift()}return[i,r,s,o]}function Oy(e,t,n,r){const s=oi(r.url,r.attributes);if(1===e.length){let o,i=e[0];0===t?[o,i]=i.splitText(n):[,o,i]=i.splitText(t,n);const l=$r(r.text);return l.setFormat(o.getFormat()),l.setDetail(o.getDetail()),s.append(l),o.replace(s),i}if(e.length>1){const r=e[0];let o,i=r.getTextContent().length;0===t?o=r:[,o]=r.splitText(t);const l=[];let a;for(let t=1;t<e.length;t++){const r=e[t],s=r.getTextContent().length,o=i;if(o<n)if(i+s<=n)l.push(r);else{const[e,t]=r.splitText(n-o);l.push(e),a=t}i+=s}const c=hs(),u=c?c.getNodes().find(Ur):void 0,d=$r(o.getTextContent());return d.setFormat(o.getFormat()),d.setDetail(o.getDetail()),s.append(d,...l),u&&u===o&&(Gr(c)?d.select(c.anchor.offset,c.focus.offset):es(c)&&d.select(0,d.getTextContent().length)),o.replace(s),a}}function Fy(e,t,n){const r=e.getChildren(),s=r.length;for(let a=0;a<s;a++){const t=r[a];if(!Ur(t)||!t.isSimpleText())return Dy(e),void n(null,e.getURL())}const o=e.getTextContent(),i=vy(o,t);if(null===i||i.text!==o)return Dy(e),void n(null,e.getURL());if(!Ty(e)||!Ny(e))return Dy(e),void n(null,e.getURL());const l=e.getURL();if(l!==i.url&&(e.setURL(i.url),n(i.url,l)),i.attributes){const t=e.getRel();t!==i.attributes.rel&&(e.setRel(i.attributes.rel||null),n(i.attributes.rel||null,t));const r=e.getTarget();r!==i.attributes.target&&(e.setTarget(i.attributes.target||null),n(i.attributes.target||null,r))}}function Dy(e){const t=e.getChildren();for(let n=t.length-1;n>=0;n--)e.insertAfter(t[n]);return e.remove(),t.map((e=>e.getLatest()))}function Py({matchers:e,onChange:t}){const[n]=Wi();return r=n,s=e,o=t,React.useEffect((()=>{r.hasNodes([si])||wy(77);const e=(e,t)=>{o&&o(e,t)};return Bo(r.registerNodeTransform(Ar,(t=>{const n=t.getParentOrThrow(),r=t.getPreviousSibling();ii(n)?Fy(n,s,e):ri(n)||(!t.isSimpleText()||!Ey(t.getTextContent())&&ii(r)||function(e,t,n){let r=[...e];const s=r.map((e=>e.getTextContent())).join("");let o,i=s,l=0;for(;(o=vy(i,t))&&null!==o;){const e=o.index,t=e+o.length;if(Ry(l+e,l+t,s,r)){const[s,,i,a]=Ay(r,l+e,l+t),c=Oy(i,l+e-s,l+t-s,o);r=c?[c,...a]:a,n(o.url,null),l=0}else l+=t;i=i.substring(t)}}(function(e){const t=[e];let n=e.getNextSibling();for(;null!==n&&Ur(n)&&n.isSimpleText()&&(t.push(n),!/[\s]/.test(n.getTextContent()));)n=n.getNextSibling();return t}(t),s,e),function(e,t,n){const r=e.getPreviousSibling(),s=e.getNextSibling(),o=e.getTextContent();ii(r)&&!Ey(o)&&(r.append(e),Fy(r,t,n),n(null,r.getURL())),ii(s)&&!ky(o)&&(Dy(s),Fy(s,t,n),n(null,s.getURL()))}(t,s,e))})))}),[r,s,o]),null;var r,s,o}var Ly="object"==typeof global&&global&&global.Object===Object&&global,Iy="object"==typeof self&&self&&self.Object===Object&&self,My=Ly||Iy||Function("return this")(),By=My.Symbol,zy=Object.prototype,$y=zy.hasOwnProperty,Uy=zy.toString,Ky=By?By.toStringTag:void 0;var Wy=Object.prototype.toString;var jy="[object Null]",Hy="[object Undefined]",Jy=By?By.toStringTag:void 0;function Vy(e){return null==e?void 0===e?Hy:jy:Jy&&Jy in Object(e)?function(e){var t=$y.call(e,Ky),n=e[Ky];try{e[Ky]=void 0;var r=!0}catch(mw){}var s=Uy.call(e);return r&&(t?e[Ky]=n:delete e[Ky]),s}(e):function(e){return Wy.call(e)}(e)}var Yy="[object Symbol]";var Zy=/\s/;var Xy=/^\s+/;function qy(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Zy.test(e.charAt(t)););return t}(e)+1).replace(Xy,""):e}function Gy(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Qy=NaN,eb=/^[-+]0x[0-9a-f]+$/i,tb=/^0b[01]+$/i,nb=/^0o[0-7]+$/i,rb=parseInt;function sb(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&Vy(e)==Yy}(e))return Qy;if(Gy(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Gy(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=qy(e);var n=tb.test(e);return n||nb.test(e)?rb(e.slice(2),n?2:8):eb.test(e)?Qy:+e}var ob=function(){return My.Date.now()},ib=Math.max,lb=Math.min;function ab(e,t,n){var r,s,o,i,l,a,c=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=s;return r=s=void 0,c=t,i=e.apply(o,n)}function g(e){var n=e-a;return void 0===a||n>=t||n<0||d&&e-c>=o}function p(){var e=ob();if(g(e))return m(e);l=setTimeout(p,function(e){var n=t-(e-a);return d?lb(n,o-(e-c)):n}(e))}function m(e){return l=void 0,h&&r?f(e):(r=s=void 0,i)}function _(){var e=ob(),n=g(e);if(r=arguments,s=this,a=e,n){if(void 0===l)return function(e){return c=e,l=setTimeout(p,t),u?f(e):i}(a);if(d)return clearTimeout(l),l=setTimeout(p,t),f(a)}return void 0===l&&(l=setTimeout(p,t)),i}return t=sb(t)||0,Gy(n)&&(u=!!n.leading,o=(d="maxWait"in n)?ib(sb(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),_.cancel=function(){void 0!==l&&clearTimeout(l),c=0,r=a=s=l=void 0},_.flush=function(){return void 0===l?i:m(ob())},_}let cb=class e extends Hs{static getType(){return"mark"}static clone(t){return new e(Array.from(t.__ids),t.__key)}static importDOM(){return null}static importJSON(e){const t=ub(e.ids);return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{...super.exportJSON(),ids:this.getIDs(),type:"mark",version:1}}constructor(e,t){super(t),this.__ids=e||[]}createDOM(e){const t=document.createElement("mark");return zo(t,e.theme.mark),this.__ids.length>1&&zo(t,e.theme.markOverlap),t}updateDOM(e,t,n){const r=e.__ids,s=this.__ids,o=r.length,i=s.length,l=n.theme.markOverlap;return o!==i&&(1===o?2===i&&zo(t,l):1===i&&$o(t,l)),!1}hasID(e){const t=this.getIDs();for(let n=0;n<t.length;n++)if(e===t[n])return!0;return!1}getIDs(){const e=this.getLatest();return db(e)?e.__ids:[]}addID(e){const t=this.getWritable();if(db(t)){const n=t.__ids;t.__ids=n;for(let t=0;t<n.length;t++)if(e===n[t])return;n.push(e)}}deleteID(e){const t=this.getWritable();if(db(t)){const n=t.__ids;t.__ids=n;for(let t=0;t<n.length;t++)if(e===n[t])return void n.splice(t,1)}}insertNewAfter(e,t=!0){const n=ub(this.__ids);return this.insertAfter(n,t),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,t,n){if(!Gr(t)||"html"===n)return!1;const r=t.anchor,s=t.focus,o=r.getNode(),i=s.getNode(),l=t.isBackward()?r.offset-s.offset:s.offset-r.offset;return this.isParentOf(o)&&this.isParentOf(i)&&this.getTextContent().length===l}excludeFromCopy(e){return"clone"!==e}};function ub(e){return sn(new cb(e))}function db(e){return e instanceof cb}function hb(e){const t=e.getChildren();let n=null;for(let r=0;r<t.length;r++){const s=t[r];null===n?e.insertBefore(s):n.insertAfter(s),n=s}e.remove()}function fb(e,t,n,r){const s=e.getNodes(),o=e.anchor.offset,i=e.focus.offset,l=s.length,a=t?i:o,c=t?o:i;let u,d;for(let h=0;h<l;h++){const e=s[h];if(Js(d)&&d.isParentOf(e))continue;const t=0===h,r=h===l-1;let o=null;if(Ur(e)){const n=e.getTextContentSize(),s=t?a:0,i=r?c:n;if(0===s&&0===i)continue;const l=e.splitText(s,i);o=l.length>1&&(3===l.length||t&&!r||i===n)?l[1]:l[0]}else{if(db(e))continue;Js(e)&&e.isInline()&&(o=e)}if(null!==o){if(o&&o.is(u))continue;const e=o.getParent();null!=e&&e.is(u)||(d=void 0),u=e,void 0===d&&(d=ub([n]),o.insertBefore(d)),d.append(o)}else u=void 0,d=void 0}Js(d)&&(t?d.selectStart():d.selectEnd())}function gb(e,t){let n=e;for(;null!==n;){if(db(n))return n.getIDs();if(Ur(n)&&t===n.getTextContentSize()){const e=n.getNextSibling();if(db(e))return e.getIDs()}n=n.getParent()}return null}function pb({editorRef:e}){const[t]=Wi();return React.useEffect((()=>{"function"==typeof e?e(t):"object"==typeof e&&(e.current=t)}),[t]),null}var mb="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function _b({ignoreHistoryMergeTagChange:e=!0,ignoreSelectionChange:t=!1,onChange:n}){const[r]=Wi();return mb((()=>{if(n)return r.registerUpdateListener((({editorState:s,dirtyElements:o,dirtyLeaves:i,prevEditorState:l,tags:a})=>{t&&0===o.size&&0===i.size||e&&a.has("history-merge")||l.isEmpty()||n(s,r,a)}))}),[r,e,t,n]),null}function yb(){return yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yb.apply(this,arguments)}var bb="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;function wb({ariaActiveDescendant:e,ariaAutoComplete:t,ariaControls:n,ariaDescribedBy:r,ariaExpanded:s,ariaLabel:o,ariaLabelledBy:i,ariaMultiline:l,ariaOwns:a,ariaRequired:c,autoCapitalize:u,className:d,id:h,role:f="textbox",spellCheck:g=!0,style:p,tabIndex:m,"data-testid":_,...y}){const[b]=Wi(),[w,x]=React.useState(!1),v=React.useCallback((e=>{e&&e.ownerDocument&&e.ownerDocument.defaultView&&b.setRootElement(e)}),[b]);return bb((()=>(x(b.isEditable()),b.registerEditableListener((e=>{x(e)})))),[b]),React.createElement("div",yb({},y,{"aria-activedescendant":w?e:void 0,"aria-autocomplete":w?t:"none","aria-controls":w?n:void 0,"aria-describedby":r,"aria-expanded":w&&"combobox"===f?!!s:void 0,"aria-label":o,"aria-labelledby":i,"aria-multiline":l,"aria-owns":w?a:void 0,"aria-readonly":!w||void 0,"aria-required":c,autoCapitalize:u,className:d,contentEditable:w,"data-testid":_,id:h,ref:v,role:f,spellCheck:g,style:p,tabIndex:m}))}var xb="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;let vb=class{constructor(e){this.key=e,this.ref={current:null},this.setRefElement=this.setRefElement.bind(this)}setRefElement(e){this.ref={current:e}}};const Sb=e=>{const t=document.getElementById("typeahead-menu");if(!t)return;const n=t.getBoundingClientRect();n.top+n.height>window.innerHeight&&t.scrollIntoView({block:"center"}),n.top<0&&t.scrollIntoView({block:"center"}),e.scrollIntoView({block:"nearest"})};function Cb(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return n.top>r.top&&n.top<r.bottom}const kb={};function Eb({close:e,editor:t,anchorElementRef:n,resolution:r,options:s,menuRenderFn:o,onSelectOption:i,shouldSplitNodeWithQuery:l=!1,commandPriority:a=so}){const[c,u]=React.useState(null),d=r.match&&r.match.matchingString;React.useEffect((()=>{u(0)}),[d]);const h=React.useCallback((n=>{t.update((()=>{const t=null!=r.match&&l?function(e){const t=hs();if(!Gr(t)||!t.isCollapsed())return null;const n=t.anchor;if("text"!==n.type)return null;const r=n.getNode();if(!r.isSimpleText())return null;const s=n.offset,o=r.getTextContent().slice(0,s),i=e.replaceableString.length,l=s-function(e,t,n){let r=n;for(let s=r;s<=t.length;s++)e.substr(-s)===t.substr(0,s)&&(r=s);return r}(o,e.matchingString,i);if(l<0)return null;let a;return 0===l?[a]=r.splitText(s):[,a]=r.splitText(l,s),a}(r.match):null;i(n,t,e,r.match?r.match.matchingString:"")}))}),[t,l,r.match,i,e]),f=React.useCallback((e=>{const n=t.getRootElement();null!==n&&(n.setAttribute("aria-activedescendant","typeahead-item-"+e),u(e))}),[t]);return React.useEffect((()=>()=>{const e=t.getRootElement();null!==e&&e.removeAttribute("aria-activedescendant")}),[t]),xb((()=>{null===s?u(null):null===c&&f(0)}),[s,c,f]),React.useEffect((()=>Bo(t.registerCommand(kb,(({option:e})=>!(!e.ref||null==e.ref.current||(Sb(e.ref.current),0))),a))),[t,f,a]),React.useEffect((()=>Bo(t.registerCommand(F,(e=>{const n=e;if(null!==s&&s.length&&null!==c){const e=c!==s.length-1?c+1:0;f(e);const r=s[e];null!=r.ref&&r.ref.current&&t.dispatchCommand(kb,{index:e,option:r}),n.preventDefault(),n.stopImmediatePropagation()}return!0}),a),t.registerCommand(O,(e=>{const t=e;if(null!==s&&s.length&&null!==c){const e=0!==c?c-1:s.length-1;f(e);const n=s[e];null!=n.ref&&n.ref.current&&Sb(n.ref.current),t.preventDefault(),t.stopImmediatePropagation()}return!0}),a),t.registerCommand(I,(t=>{const n=t;return n.preventDefault(),n.stopImmediatePropagation(),e(),!0}),a),t.registerCommand(B,(e=>{const t=e;return null!==s&&null!==c&&null!=s[c]&&(t.preventDefault(),t.stopImmediatePropagation(),h(s[c]),!0)}),a),t.registerCommand(D,(e=>null!==s&&null!==c&&null!=s[c]&&(null!==e&&(e.preventDefault(),e.stopImmediatePropagation()),h(s[c]),!0)),a))),[h,e,t,s,c,f,a]),o(n,React.useMemo((()=>({options:s,selectOptionAndCleanUp:h,selectedIndex:c,setHighlightedIndex:u})),[h,c,s]),r.match?r.match.matchingString:"")}function Tb(e,{minLength:t=1,maxLength:n=75}){return React.useCallback((r=>{const s=new RegExp("(^|\\s|\\()(["+e+"]((?:[^"+e+"\\.,\\+\\*\\?\\$\\@\\|#{}\\(\\)\\^\\-\\[\\]\\\\/!%'\"~=<>_:;\\s]){0,"+n+"}))$").exec(r);if(null!==s){const e=s[1],n=s[3];if(n.length>=t)return{leadOffset:s.index+e.length,matchingString:n,replaceableString:s[2]}}return null}),[n,t,e])}function Nb({options:e,onQueryChange:t,onSelectOption:n,onOpen:r,onClose:s,menuRenderFn:o,triggerFn:i,anchorClassName:l,commandPriority:a=so,parent:c}){const[u]=Wi(),[d,h]=React.useState(null),f=function(e,t,n,r=document.body){const[s]=Wi(),o=React.useRef(document.createElement("div")),i=React.useCallback((()=>{o.current.style.top=o.current.style.bottom;const t=s.getRootElement(),i=o.current,l=i.firstChild;if(null!==t&&null!==e){const{left:s,top:a,width:c,height:u}=e.getRect(),d=o.current.offsetHeight;if(i.style.top=`${a+window.pageYOffset+d+3}px`,i.style.left=`${s+window.pageXOffset}px`,i.style.height=`${u}px`,i.style.width=`${c}px`,null!==l){l.style.top=`${a}`;const e=l.getBoundingClientRect(),n=e.height,r=e.width,o=t.getBoundingClientRect();s+r>o.right&&(i.style.left=`${o.right-r+window.pageXOffset}px`),(a+n>window.innerHeight||a+n>o.bottom)&&a-o.top>n&&(i.style.top=a-n+window.pageYOffset-u+"px")}i.isConnected||(null!=n&&(i.className=n),i.setAttribute("aria-label","Typeahead menu"),i.setAttribute("id","typeahead-menu"),i.setAttribute("role","listbox"),i.style.display="block",i.style.position="absolute",r.append(i)),o.current=i,t.setAttribute("aria-controls","typeahead-menu")}}),[s,e,n,r]);React.useEffect((()=>{const t=s.getRootElement();if(null!==e)return i(),()=>{null!==t&&t.removeAttribute("aria-controls");const e=o.current;null!==e&&e.isConnected&&e.remove()}}),[s,i,e]);const l=React.useCallback((n=>{null!==e&&(n||t(null))}),[e,t]);return function(e,t,n,r){const[s]=Wi();React.useEffect((()=>{if(null!=t&&null!=e){const e=s.getRootElement(),o=null!=e?function(e,t){let n=getComputedStyle(e);const r="absolute"===n.position,s=/(auto|scroll)/;if("fixed"===n.position)return document.body;for(let o=e;o=o.parentElement;)if(n=getComputedStyle(o),(!r||"static"!==n.position)&&s.test(n.overflow+n.overflowY+n.overflowX))return o;return document.body}(e):document.body;let i=!1,l=Cb(t,o);const a=function(){i||(window.requestAnimationFrame((function(){n(),i=!1})),i=!0);const e=Cb(t,o);e!==l&&(l=e,null!=r&&r(e))},c=new ResizeObserver(n);return window.addEventListener("resize",n),document.addEventListener("scroll",a,{capture:!0,passive:!0}),c.observe(t),()=>{c.unobserve(t),window.removeEventListener("resize",n),document.removeEventListener("scroll",a,!0)}}}),[t,s,r,n,e])}(e,o.current,i,l),o}(d,h,l,c),g=React.useCallback((()=>{h(null),null!=s&&null!==d&&s()}),[s,d]),p=React.useCallback((e=>{h(e),null!=r&&null===d&&r(e)}),[r,d]);return React.useEffect((()=>{const e=u.registerUpdateListener((()=>{u.getEditorState().read((()=>{const e=u._window||window,n=e.document.createRange(),r=hs(),s=function(e){let t=null;return e.getEditorState().read((()=>{const e=hs();Gr(e)&&(t=function(e){const t=e.anchor;if("text"!==t.type)return null;const n=t.getNode();if(!n.isSimpleText())return null;const r=t.offset;return n.getTextContent().slice(0,r)}(e))})),t}(u);if(!Gr(r)||!r.isCollapsed()||null===s||null===n)return void g();const o=i(s,u);if(t(o?o.matchingString:null),null!==o&&(l=u,0!==o.leadOffset||!l.getEditorState().read((()=>{const e=hs();if(Gr(e)){const t=e.anchor.getNode().getPreviousSibling();return Ur(t)&&t.isTextEntity()}return!1})))){const t=function(e,t,n){const r=n.getSelection();if(null===r||!r.isCollapsed)return!1;const s=r.anchorNode,o=e,i=r.anchorOffset;if(null==s||null==i)return!1;try{t.setStart(s,o),t.setEnd(s,i)}catch(l){return!1}return!0}(o.leadOffset,n,e);if(null!==t)return a=()=>p({getRect:()=>n.getBoundingClientRect(),match:o}),void(React.startTransition?React.startTransition(a):a())}var l,a;g()}))}));return()=>{e()}}),[u,i,t,d,g,p]),null===d||null===u?null:React.createElement(Eb,{close:g,resolution:d,editor:u,anchorElementRef:f,options:e,menuRenderFn:o,shouldSplitNodeWithQuery:!0,onSelectOption:n,commandPriority:a})}const Rb=React.createContext(null),Ab={didCatch:!1,error:null};class Ob extends React.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Ab}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var t,n,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];null===(t=(n=this.props).onReset)||void 0===t||t.call(n,{args:s,reason:"imperative-api"}),this.setState(Ab)}}componentDidCatch(e,t){var n,r;null===(n=(r=this.props).onError)||void 0===n||n.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:r}=this.props;var s,o;n&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some(((e,n)=>!Object.is(e,t[n])))}(e.resetKeys,r)&&(null===(s=(o=this.props).onReset)||void 0===s||s.call(o,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(Ab))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:s,error:o}=this.state;let i=e;if(s){const e={error:o,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)i=t(e);else if(n)i=React.createElement(n,e);else{if(null!==r&&!React.isValidElement(r))throw o;i=r}}return React.createElement(Rb.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},i)}}var Fb="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?React.useLayoutEffect:React.useEffect;class Db{constructor(e){this.key=e,this.ref={current:null},this.setRefElement=this.setRefElement.bind(this)}setRefElement(e){this.ref={current:e}}}const Pb=e=>{const t=document.getElementById("typeahead-menu");if(!t)return;const n=t.getBoundingClientRect();n.top+n.height>window.innerHeight&&t.scrollIntoView({block:"center"}),n.top<0&&t.scrollIntoView({block:"center"}),e.scrollIntoView({block:"nearest"})};function Lb(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return n.top>r.top&&n.top<r.bottom}const Ib={};function Mb({close:e,editor:t,anchorElementRef:n,resolution:r,options:s,menuRenderFn:o,onSelectOption:i,shouldSplitNodeWithQuery:l=!1,commandPriority:a=so}){const[c,u]=React.useState(null),d=r.match&&r.match.matchingString;React.useEffect((()=>{u(0)}),[d]);const h=React.useCallback((n=>{t.update((()=>{const t=null!=r.match&&l?function(e){const t=hs();if(!Gr(t)||!t.isCollapsed())return null;const n=t.anchor;if("text"!==n.type)return null;const r=n.getNode();if(!r.isSimpleText())return null;const s=n.offset,o=r.getTextContent().slice(0,s),i=e.replaceableString.length,l=s-function(e,t,n){let r=n;for(let s=r;s<=t.length;s++)e.substr(-s)===t.substr(0,s)&&(r=s);return r}(o,e.matchingString,i);if(l<0)return null;let a;return 0===l?[a]=r.splitText(s):[,a]=r.splitText(l,s),a}(r.match):null;i(n,t,e,r.match?r.match.matchingString:"")}))}),[t,l,r.match,i,e]),f=React.useCallback((e=>{const n=t.getRootElement();null!==n&&(n.setAttribute("aria-activedescendant","typeahead-item-"+e),u(e))}),[t]);return React.useEffect((()=>()=>{const e=t.getRootElement();null!==e&&e.removeAttribute("aria-activedescendant")}),[t]),Fb((()=>{null===s?u(null):null===c&&f(0)}),[s,c,f]),React.useEffect((()=>Bo(t.registerCommand(Ib,(({option:e})=>!(!e.ref||null==e.ref.current||(Pb(e.ref.current),0))),a))),[t,f,a]),React.useEffect((()=>Bo(t.registerCommand(F,(e=>{const n=e;if(null!==s&&s.length&&null!==c){const e=c!==s.length-1?c+1:0;f(e);const r=s[e];null!=r.ref&&r.ref.current&&t.dispatchCommand(Ib,{index:e,option:r}),n.preventDefault(),n.stopImmediatePropagation()}return!0}),a),t.registerCommand(O,(e=>{const t=e;if(null!==s&&s.length&&null!==c){const e=0!==c?c-1:s.length-1;f(e);const n=s[e];null!=n.ref&&n.ref.current&&Pb(n.ref.current),t.preventDefault(),t.stopImmediatePropagation()}return!0}),a),t.registerCommand(I,(t=>{const n=t;return n.preventDefault(),n.stopImmediatePropagation(),e(),!0}),a),t.registerCommand(B,(e=>{const t=e;return null!==s&&null!==c&&null!=s[c]&&(t.preventDefault(),t.stopImmediatePropagation(),h(s[c]),!0)}),a),t.registerCommand(D,(e=>null!==s&&null!==c&&null!=s[c]&&(null!==e&&(e.preventDefault(),e.stopImmediatePropagation()),h(s[c]),!0)),a))),[h,e,t,s,c,f,a]),o(n,React.useMemo((()=>({options:s,selectOptionAndCleanUp:h,selectedIndex:c,setHighlightedIndex:u})),[h,c,s]),r.match?r.match.matchingString:"")}function Bb({options:e,onWillOpen:t,onClose:n,onOpen:r,onSelectOption:s,menuRenderFn:o,anchorClassName:i,commandPriority:l=so,parent:a}){const[c]=Wi(),[u,d]=React.useState(null),h=React.useRef(null),f=function(e,t,n,r=document.body){const[s]=Wi(),o=React.useRef(document.createElement("div")),i=React.useCallback((()=>{o.current.style.top=o.current.style.bottom;const t=s.getRootElement(),i=o.current,l=i.firstChild;if(null!==t&&null!==e){const{left:s,top:a,width:c,height:u}=e.getRect(),d=o.current.offsetHeight;if(i.style.top=`${a+window.pageYOffset+d+3}px`,i.style.left=`${s+window.pageXOffset}px`,i.style.height=`${u}px`,i.style.width=`${c}px`,null!==l){l.style.top=`${a}`;const e=l.getBoundingClientRect(),n=e.height,r=e.width,o=t.getBoundingClientRect();s+r>o.right&&(i.style.left=`${o.right-r+window.pageXOffset}px`),(a+n>window.innerHeight||a+n>o.bottom)&&a-o.top>n&&(i.style.top=a-n+window.pageYOffset-u+"px")}i.isConnected||(null!=n&&(i.className=n),i.setAttribute("aria-label","Typeahead menu"),i.setAttribute("id","typeahead-menu"),i.setAttribute("role","listbox"),i.style.display="block",i.style.position="absolute",r.append(i)),o.current=i,t.setAttribute("aria-controls","typeahead-menu")}}),[s,e,n,r]);React.useEffect((()=>{const t=s.getRootElement();if(null!==e)return i(),()=>{null!==t&&t.removeAttribute("aria-controls");const e=o.current;null!==e&&e.isConnected&&e.remove()}}),[s,i,e]);const l=React.useCallback((n=>{null!==e&&(n||t(null))}),[e,t]);return function(e,t,n,r){const[s]=Wi();React.useEffect((()=>{if(null!=t&&null!=e){const e=s.getRootElement(),o=null!=e?function(e,t){let n=getComputedStyle(e);const r="absolute"===n.position,s=/(auto|scroll)/;if("fixed"===n.position)return document.body;for(let o=e;o=o.parentElement;)if(n=getComputedStyle(o),(!r||"static"!==n.position)&&s.test(n.overflow+n.overflowY+n.overflowX))return o;return document.body}(e):document.body;let i=!1,l=Lb(t,o);const a=function(){i||(window.requestAnimationFrame((function(){n(),i=!1})),i=!0);const e=Lb(t,o);e!==l&&(l=e,null!=r&&r(e))},c=new ResizeObserver(n);return window.addEventListener("resize",n),document.addEventListener("scroll",a,{capture:!0,passive:!0}),c.observe(t),()=>{c.unobserve(t),window.removeEventListener("resize",n),document.removeEventListener("scroll",a,!0)}}}),[t,s,r,n,e])}(e,o.current,i,l),o}(u,d,i,a),g=React.useCallback((()=>{d(null),null!=n&&null!==u&&n()}),[n,u]),p=React.useCallback((e=>{d(e),null!=r&&null===u&&r(e)}),[r,u]),m=React.useCallback((e=>{e.preventDefault(),null!=t&&t(e);const n=Go(e.target);p({getRect:()=>new DOMRect(e.clientX/n,e.clientY/n,1,1)})}),[p,t]),_=React.useCallback((e=>{null===u||null==h.current||null==e.target||h.current.contains(e.target)||g()}),[g,u]);return React.useEffect((()=>{const e=c.getRootElement();if(e)return e.addEventListener("contextmenu",m),()=>e.removeEventListener("contextmenu",m)}),[c,m]),React.useEffect((()=>(document.addEventListener("click",_),()=>document.removeEventListener("click",_))),[c,_]),null===u||null===c?null:React.createElement(Mb,{close:g,resolution:u,editor:c,anchorElementRef:f,options:e,menuRenderFn:(e,t)=>o(e,t,{setMenuRef:e=>{h.current=e}}),onSelectOption:s,commandPriority:l})}function zb({validateUrl:e}){const[t]=Wi();return React.useEffect((()=>{if(!t.hasNodes([ei]))throw new Error("LinkPlugin: LinkNode not registered on editor");return Bo(t.registerCommand(li,(t=>{if(null===t)return ai(t),!0;if("string"==typeof t)return!(void 0!==e&&!e(t)||(ai(t),0));{const{url:e,target:n,rel:r,title:s}=t;return ai(e,{rel:r,target:n,title:s}),!0}}),so),void 0!==e?t.registerCommand(b,(n=>{const r=hs();if(!Gr(r)||r.isCollapsed()||!Xo(n,ClipboardEvent))return!1;const s=n;if(null===s.clipboardData)return!1;const o=s.clipboardData.getData("text");return!!e(o)&&!r.getNodes().some((e=>Js(e)))&&(t.dispatchCommand(li,o),n.preventDefault(),!0)}),so):()=>{})}),[t,e]),null}const $b=[{dependencies:[Ig],export:e=>zg(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,n,r)=>{const s=Bg();r||null!=e.getNextSibling()?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...ry];function Ub({transformers:e=$b}){const[t]=Wi();return React.useEffect((()=>H_(t,e)),[t,e]),null}function Kb(e){return[e.getKey(),e.getTextContent(),e.getTag()]}function Wb(e,t,n){if(null===t)return n;const r=Kb(t);let s=[];if(null===e)s=[r,...n];else for(let o=0;o<n.length;o++){const i=n[o][0];s.push(n[o]),i===e.getKey()&&i!==t.getKey()&&s.push(r)}return s}function jb(e,t){const n=[];for(const r of t)r[0]!==e&&n.push(r);return n}function Hb(e,t){const n=[];for(const r of t)r[0]===e.getKey()?n.push(Kb(e)):n.push(r);return n}function Jb(e,t,n){const r=[],s=Kb(t);e||r.push(s);for(const o of n)o[0]!==t.getKey()&&(r.push(o),e&&o[0]===e.getKey()&&r.push(s));return r}function Vb({children:e}){const[t,n]=React.useState([]),[r]=Wi();return React.useEffect((()=>{let e=[];r.getEditorState().read((()=>{const t=Tt().getChildren();for(const n of t)Tl(n)&&e.push([n.getKey(),n.getTextContent(),n.getTag()]);n(e)}));const t=r.registerMutationListener(vl,(t=>{r.getEditorState().read((()=>{for(const[n,r]of t)if("created"===r){const t=vt(n);if(null!==t){let n=t.getPreviousSibling();for(;null!==n&&!Tl(n);)n=n.getPreviousSibling();e=Wb(n,t,e)}}else if("destroyed"===r)e=jb(n,e);else if("updated"===r){const t=vt(n);if(null!==t){let n=t.getPreviousSibling();for(;null!==n&&!Tl(n);)n=n.getPreviousSibling();e=Jb(n,t,e)}}n(e)}))})),s=r.registerMutationListener(Ar,(t=>{r.getEditorState().read((()=>{for(const[r,s]of t)if("updated"===s){const t=vt(r);if(null!==t){const r=t.getParentOrThrow();Tl(r)&&(e=Hb(r,e),n(e))}}}))}));return()=>{t(),s()}}),[r]),e(t,r)}const Yb=Object.freeze({"\t":"\\t","\n":"\\n"}),Zb=new RegExp(Object.keys(Yb).join("|"),"g"),Xb=Object.freeze({ancestorHasNextSibling:"|",ancestorIsLastChild:" ",hasNextSibling:"├",isLastChild:"└",selectedChar:"^",selectedLine:">"}),qb=[e=>e.hasFormat("bold")&&"Bold",e=>e.hasFormat("code")&&"Code",e=>e.hasFormat("italic")&&"Italic",e=>e.hasFormat("strikethrough")&&"Strikethrough",e=>e.hasFormat("subscript")&&"Subscript",e=>e.hasFormat("superscript")&&"Superscript",e=>e.hasFormat("underline")&&"Underline"],Gb=[e=>e.hasTextFormat("bold")&&"Bold",e=>e.hasTextFormat("code")&&"Code",e=>e.hasTextFormat("italic")&&"Italic",e=>e.hasTextFormat("strikethrough")&&"Strikethrough",e=>e.hasTextFormat("subscript")&&"Subscript",e=>e.hasTextFormat("superscript")&&"Superscript",e=>e.hasTextFormat("underline")&&"Underline"],Qb=[e=>e.isDirectionless()&&"Directionless",e=>e.isUnmergeable()&&"Unmergeable"],ew=[e=>e.isToken()&&"Token",e=>e.isSegmented()&&"Segmented"];function tw(e,t,n){const r=e.getEditorState(),s=e._config,o=e._compositionKey,i=e._editable;if(n){let t="";return r.read((()=>{t=function(e){const t=document.createElement("div");return t.innerHTML=e.trim(),uw(t,0).innerHTML}(Yi(e))})),t}let l=" root\n";const a=r.read((()=>{const e=hs();return nw(Tt(),((t,n)=>{const r=`(${t.getKey()})`,s=t.getType()||"",o=t.isSelected(),i=db(t)?` id: [ ${t.getIDs().join(", ")} ] `:"";l+=`${o?Xb.selectedLine:" "} ${n.join(" ")} ${r} ${s} ${i} ${function(e){if(Ur(e)){const n=e.getTextContent(),r=0===n.length?"(empty)":`"${rw(n)}"`,s=[iw(t=e),sw(t),ow(t)].filter(Boolean).join(", ");return[r,0!==s.length?`{ ${s} }`:null].filter(Boolean).join(" ").trim()}var t;if(ri(e)){const t=e.getURL(),n=0===t.length?"(empty)":`"${rw(t)}"`,r=function(e){return[lw(e),aw(e),cw(e)].filter(Boolean).join(", ")}(e);return[n,0!==r.length?`{ ${r} }`:null].filter(Boolean).join(" ").trim()}if(no(e)){const t=function(e){let t=Gb.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();return""!==t&&(t="format: "+t),t}(e);return""!==t?`{ ${t} }`:""}return""}(t)}\n`,l+=function({indent:e,isSelected:t,node:n,nodeKeyDisplay:r,selection:s,typeDisplay:o}){if(!Ur(n)||!Gr(s)||!t||Js(n))return"";const i=s.anchor,l=s.focus;if(""===n.getTextContent()||i.getNode()===s.focus.getNode()&&i.offset===l.offset)return"";const[a,c]=function(e,t){const n=t.getStartEndPoints();if(es(t)||null===n)return[-1,-1];const[r,s]=n,o=e.getTextContent(),i=o.length;let l=-1,a=-1;if("text"===r.type&&"text"===s.type){const t=r.getNode(),n=s.getNode();t===n&&e===t&&r.offset!==s.offset?[l,a]=r.offset<s.offset?[r.offset,s.offset]:[s.offset,r.offset]:[l,a]=e===t?t.isBefore(n)?[r.offset,i]:[0,r.offset]:e===n?n.isBefore(t)?[s.offset,i]:[0,s.offset]:[0,i]}const c=(o.slice(0,l).match(Zb)||[]).length;return[l+c,a+c+(o.slice(l,a).match(Zb)||[]).length]}(n,s);if(a===c)return"";const u=e[e.length-1]===Xb.hasNextSibling?Xb.ancestorHasNextSibling:Xb.ancestorIsLastChild,d=[...e.slice(0,e.length-1),u],h=Array(a+1).fill(" "),f=Array(c-a).fill(Xb.selectedChar),g=o.length+3,p=Array(r.length+g).fill(" ");return[Xb.selectedLine,d.join(" "),[...p,...h,...f].join("")].join(" ")+"\n"}({indent:n,isSelected:o,node:t,nodeKeyDisplay:r,selection:e,typeDisplay:s})})),null===e?": null":Gr(e)?function(e){let t="";const n=iw(e);t+=`: range ${""!==n?`{ ${n} }`:""} ${""!==e.style?`{ style: ${e.style} } `:""}`;const r=e.anchor,s=e.focus,o=r.offset,i=s.offset;return t+=`\n  ├ anchor { key: ${r.key}, offset: ${null===o?"null":o}, type: ${r.type} }`,t+=`\n  └ focus { key: ${s.key}, offset: ${null===i?"null":i}, type: ${s.type} }`,t}(e):$p(e)?`: table\n  └ { table: ${(t=e).tableKey}, anchorCell: ${t.anchor.key}, focusCell: ${t.focus.key} }`:function(e){return es(e)?`: node\n  └ [${Array.from(e._nodes).join(", ")}]`:""}(e);var t}));if(l+="\n selection"+a,l+="\n\n commands:",t.length)for(const{type:c,payload:u}of t)l+=`\n  └ { type: ${c}, payload: ${u instanceof Event?u.constructor.name:u} }`;else l+="\n  └ None dispatched.";return l+="\n\n editor:",l+=`\n  └ namespace ${s.namespace}`,null!==o&&(l+=`\n  └ compositionKey ${o}`),l+=`\n  └ editable ${String(i)}`,l}function nw(e,t,n=[]){const r=e.getChildren(),s=r.length;r.forEach(((e,r)=>{t(e,n.concat(r===s-1?Xb.isLastChild:Xb.hasNextSibling)),Js(e)&&nw(e,t,n.concat(r===s-1?Xb.ancestorIsLastChild:Xb.ancestorHasNextSibling))}))}function rw(e){return Object.entries(Yb).reduce(((e,[t,n])=>e.replace(new RegExp(t,"g"),String(n))),e)}function sw(e){let t=Qb.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();return""!==t&&(t="detail: "+t),t}function ow(e){let t=ew.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();return""!==t&&(t="mode: "+t),t}function iw(e){let t=qb.map((t=>t(e))).filter(Boolean).join(", ").toLocaleLowerCase();return""!==t&&(t="format: "+t),t}function lw(e){let t=e.getTarget();return null!=t&&(t="target: "+t),t}function aw(e){let t=e.getRel();return null!=t&&(t="rel: "+t),t}function cw(e){let t=e.getTitle();return null!=t&&(t="title: "+t),t}function uw(e,t){const n=new Array(1+t++).join("  "),r=new Array(t-1).join("  ");let s;for(let o=0;o<e.children.length;o++)s=document.createTextNode("\n"+n),e.insertBefore(s,e.children[o]),uw(e.children[o],t),e.lastElementChild===e.children[o]&&(s=document.createTextNode("\n"+r),e.appendChild(s));return e}const dw=React.forwardRef((function({treeTypeButtonClassName:e,timeTravelButtonClassName:t,timeTravelPanelSliderClassName:n,timeTravelPanelButtonClassName:r,viewClassName:s,timeTravelPanelClassName:o,editorState:i,setEditorState:l,setEditorReadOnly:a,generateContent:c},u){const[d,h]=React.useState([]),[f,g]=React.useState(""),[p,m]=React.useState(!1),[_,y]=React.useState(!1),b=React.useRef(0),w=React.useRef(null),[x,v]=React.useState(!1),[S,C]=React.useState(!1),[k,E]=React.useState(!1),T=React.useRef(),N=React.useRef(0),R=React.useCallback((e=>{const t=++N.current;c(e).then((e=>{t===N.current&&g(e)})).catch((e=>{t===N.current&&g(`Error rendering tree: ${e.message}\n\nStack:\n${e.stack}`)}))}),[c]);React.useEffect((()=>{!k&&i._nodeMap.size>1e3&&(C(!0),!k)||T.current!==i&&(T.current=i,R(_),p||h((e=>[...e,[Date.now(),i]])))}),[i,R,_,k,p]);const A=d.length;return React.useEffect((()=>{if(x){let e;const t=()=>{const n=b.current;if(n===A-1)return void v(!1);const r=d[n][0],s=d[n+1][0];e=setTimeout((()=>{b.current++;const e=b.current,n=w.current;null!==n&&(n.value=String(e)),l(d[e][1]),t()}),s-r)};return t(),()=>{clearTimeout(e)}}}),[d,x,A,l]),React.createElement("div",{className:s},!k&&S?React.createElement("div",{style:{padding:20}},React.createElement("span",{style:{marginRight:20}},"Detected large EditorState, this can impact debugging performance."),React.createElement("button",{onClick:()=>{E(!0)},style:{background:"transparent",border:"1px solid white",color:"white",cursor:"pointer",padding:5}},"Show full tree")):null,k?null:React.createElement("button",{onClick:()=>(R(!_),void y(!_)),className:e,type:"button"},_?"Tree":"Export DOM"),!p&&(k||!S)&&A>2&&React.createElement("button",{onClick:()=>{a(!0),b.current=A-1,m(!0)},className:t,type:"button"},"Time Travel"),(k||!S)&&React.createElement("pre",{ref:u},f),p&&(k||!S)&&React.createElement("div",{className:o},React.createElement("button",{className:r,onClick:()=>{b.current===A-1&&(b.current=1),v(!x)},type:"button"},x?"Pause":"Play"),React.createElement("input",{className:n,ref:w,onChange:e=>{const t=Number(e.target.value),n=d[t];n&&(b.current=t,l(n[1]))},type:"range",min:"1",max:A-1}),React.createElement("button",{className:r,onClick:()=>{a(!1);const e=d.length-1,t=d[e];l(t[1]);const n=w.current;null!==n&&(n.value=String(e)),m(!1),v(!1)},type:"button"},"Exit")))}));function hw(e){const[t,n]=React.useState([]);return React.useEffect((()=>function(e,t){const n=new Set;for(const[r]of e._commands)n.add(e.registerCommand(r,(e=>(t((t=>{const n=[...t];return n.push({payload:e,type:r.type?r.type:"UNKNOWN"}),n.length>10&&n.shift(),n})),!1)),lo));return()=>n.forEach((e=>e()))}(e,n)),[e]),React.useMemo((()=>t),[t])}function fw({treeTypeButtonClassName:e,timeTravelButtonClassName:t,timeTravelPanelSliderClassName:n,timeTravelPanelButtonClassName:r,viewClassName:s,timeTravelPanelClassName:o,editor:i}){const l=React.createRef(),[a,c]=React.useState(i.getEditorState()),u=hw(i);return React.useEffect((()=>Bo(i.registerUpdateListener((({editorState:e})=>{c(e)})),i.registerEditableListener((()=>{c(i.getEditorState())})))),[i]),React.useEffect((()=>{const e=l.current;if(null!==e)return e.__lexicalEditor=i,()=>{e.__lexicalEditor=null}}),[i,l]),React.createElement(dw,{treeTypeButtonClassName:e,timeTravelButtonClassName:t,timeTravelPanelSliderClassName:n,timeTravelPanelButtonClassName:r,viewClassName:s,timeTravelPanelClassName:o,setEditorReadOnly:e=>{const t=i.getRootElement();null!=t&&(t.contentEditable=e?"false":"true")},editorState:a,setEditorState:e=>i.setEditorState(e),generateContent:async function(e){return tw(i,u,e)},ref:l})}function gw(e){const t=e.transform();return null!==t?new Set([t]):new Set}function pw({initialEditor:e,children:t,initialNodes:n,initialTheme:r,skipCollabChecks:s}){const o=React.useRef(!1),i=React.useContext(Ui);null==i&&function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(9);const[l,{getTheme:a}]=i,c=React.useMemo((()=>{const t=r||a()||void 0,s=Ki(i,t);if(void 0!==t&&(e._config.theme=t),e._parentEditor=l,n)for(let r of n){let t=null,n=null;if("function"!=typeof r){const e=r;r=e.replace,t=e.with,n=e.withKlass||null}const s=e._nodes.get(r.getType());e._nodes.set(r.getType(),{exportDOM:s?s.exportDOM:void 0,klass:r,replace:t,replaceWithKlass:n,transforms:gw(r)})}else{const t=e._nodes=new Map(l._nodes);for(const[n,r]of t)e._nodes.set(n,{exportDOM:r.exportDOM,klass:r.klass,replace:r.replace,replaceWithKlass:r.replaceWithKlass,transforms:gw(r.klass)})}return e._config.namespace=l._config.namespace,e._editable=l._editable,[e,s]}),[]),{isCollabActive:u,yjsDocMap:d}=sa(),h=s||o.current||d.has(e.getKey());return React.useEffect((()=>{h&&(o.current=!0)}),[h]),React.useEffect((()=>l.registerEditableListener((t=>{e.setEditable(t)}))),[e,l]),React.createElement(Ui.Provider,{value:c},!u||h?t:null)}export{dp as $,iy as A,ay as B,L as C,Cu as D,Ob as E,Q_ as F,ey as G,ty as H,ny as I,Ig as J,zg as K,Bg as L,Ag as M,M as N,j as O,$r as P,_p as Q,hp as R,D as S,pm as T,wp as U,hm as V,Lm as W,Ws as X,pp as Y,oy as Z,ug as _,I as a,K as a$,no as a0,Ur as a1,gm as a2,bp as a3,gp as a4,sy as a5,ro as a6,k as a7,C as a8,og as a9,Ho as aA,R as aB,O as aC,F as aD,p as aE,lh as aF,ch as aG,ih as aH,wb as aI,db as aJ,hb as aK,fb as aL,gb as aM,cb as aN,Jo as aO,po as aP,mo as aQ,ub as aR,Vi as aS,_b as aT,Ql as aU,pb as aV,Ll as aW,Il as aX,ys as aY,rn as aZ,Zo as a_,Tt as aa,Wm as ab,Km as ac,w_ as ad,x_ as ae,ig as af,X as ag,B as ah,T as ai,xo as aj,Yo as ak,by as al,yy as am,my as an,Py as ao,xy as ap,ab as aq,Ct as ar,Um as as,Qm as at,e_ as au,b_ as av,Hs as aw,Js as ax,to as ay,_ as az,Bo as b,Wo as b$,H as b0,cs as b1,zo as b2,mp as b3,Tb as b4,Nb as b5,Eo as b6,Mi as b7,Ii as b8,Bi as b9,$ as bA,Li as bB,ui as bC,Ni as bD,Ub as bE,Ys as bF,Vo as bG,vo as bH,ee as bI,jg as bJ,Sp as bK,$p as bL,kp as bM,Vp as bN,Rp as bO,Ap as bP,Op as bQ,Fp as bR,Ep as bS,Tp as bT,Mp as bU,Lp as bV,Yp as bW,Vb as bX,ko as bY,qm as bZ,No as b_,Pg as ba,_y as bb,W as bc,vb as bd,El as be,wl as bf,V as bg,Y as bh,b as bi,Bb as bj,Db as bk,ri as bl,li as bm,yl as bn,Ko as bo,Uo as bp,Nl as bq,Ar as br,lo as bs,ii as bt,vr as bu,ni as bv,s_ as bw,S as bx,_g as by,zb as bz,so as c,Tl as c0,Gm as c1,Oo as c2,G as c3,Q as c4,ne as c5,oo as c6,jo as c7,xl as c8,ly as c9,U as ca,Ri as cb,fw as cc,Ug as cd,Jl as ce,mm as cf,ea as cg,$g as ch,cp as ci,Hl as cj,vl as ck,Si as cl,bl as cm,pg as cn,t_ as co,si as cp,ei as cq,Fl as cr,Pi as cs,Ti as ct,Go as d,h as e,vt as f,pw as g,io as h,Og as i,u as j,gg as k,sa as l,Rt as m,es as n,Wi as o,hs as p,Ol as q,g as r,bg as s,Gr as t,Dg as u,ip as v,d as w,np as x,sn as y,co as z};
